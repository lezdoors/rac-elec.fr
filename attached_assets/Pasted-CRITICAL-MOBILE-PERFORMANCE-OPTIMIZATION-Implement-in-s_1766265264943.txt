CRITICAL MOBILE PERFORMANCE OPTIMIZATION - Implement in sequence

OBJECTIVE: Fix mobile PageSpeed issues causing high CPC and low mobile conversions on Google Ads.

CONTEXT:
- Site: demande-raccordement.fr (Replit deployment)
- Primary traffic: Mobile users from Google Ads
- Current mobile PageSpeed: 40-60 (poor)
- Target mobile PageSpeed: 85+ (good)
- Hero illustration already removed
- Need aggressive mobile-first optimization

═══════════════════════════════════════════════════════════

PHASE 1: CRITICAL QUICK WINS (30 minutes - IMPLEMENT FIRST)

1. INLINE CRITICAL CSS:
   Extract and inline the following styles in <head> BEFORE any external stylesheets:
   
   <style>
   /* Critical above-fold mobile CSS */
   * { margin: 0; padding: 0; box-sizing: border-box; }
   
   body { 
     font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
     line-height: 1.6;
     color: #1F2937;
   }
   
   header { 
     height: 64px; 
     background: white; 
     display: flex;
     align-items: center;
     justify-content: space-between;
     padding: 0 20px;
     box-shadow: 0 1px 3px rgba(0,0,0,0.1);
   }
   
   .hero { 
     padding: 40px 20px; 
     text-align: center;
     background: linear-gradient(180deg, #FFFFFF 0%, #F9FAFB 100%);
   }
   
   .hero h1 { 
     font-size: 32px; 
     font-weight: 700;
     margin-bottom: 16px; 
     color: #1E3A8A;
   }
   
   .hero p {
     font-size: 16px;
     color: #4A5568;
     margin-bottom: 24px;
   }
   
   .cta-button { 
     display: block;
     background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
     color: white;
     padding: 16px 32px;
     border-radius: 8px;
     text-decoration: none;
     font-weight: 600;
     font-size: 18px;
     margin: 20px auto;
     max-width: 320px;
     box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
   }
   
   .trust-badges {
     display: flex;
     flex-direction: column;
     gap: 12px;
     padding: 20px;
     background: #F9FAFB;
   }
   
   .trust-badge {
     display: flex;
     align-items: center;
     gap: 8px;
     font-size: 14px;
     color: #4A5568;
   }
   
   /* Only above-fold styles - nothing else */
   </style>

2. DEFER ALL JAVASCRIPT:
   Find every <script> tag and add defer attribute:
   - <script defer src="app.js"></script>
   - <script defer src="bundle.js"></script>
   - Move ALL scripts to bottom of </body> (just before closing tag)
   
   Exception: Keep inline critical scripts without defer

3. DELAY GOOGLE TAG MANAGER:
   Find GTM script and wrap it:
   
   <script>
   // Delay GTM loading by 3 seconds or until scroll
   function loadGTM() {
     // Insert GTM code here
   }
   
   // Load after 3 seconds OR on first scroll
   setTimeout(loadGTM, 3000);
   window.addEventListener('scroll', function() {
     loadGTM();
   }, { once: true });
   </script>

4. OPTIMIZE ALL IMAGES:
   For EVERY <img> tag in the codebase:
   a) Add explicit width and height attributes
   b) Add loading="lazy" (except first visible image in hero)
   
   Before: <img src="icon.png" alt="Service">
   After: <img src="icon.png" alt="Service" width="64" height="64" loading="lazy">
   
   First hero image only: Keep loading="eager" or no loading attribute

5. USE SYSTEM FONTS ON MOBILE:
   Replace Google Fonts with system fonts on mobile:
   
   Add to CSS:
   @media (max-width: 767px) {
     body, h1, h2, h3, h4, h5, h6 {
       font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
     }
   }
   
   Or remove Google Fonts <link> entirely and use system fonts everywhere

═══════════════════════════════════════════════════════════

PHASE 2: IMAGE & RESOURCE OPTIMIZATION (2 hours - DO AFTER PHASE 1)

1. CONVERT IMAGES TO WEBP:
   For each image file in the project:
   a) Create WebP versions at 3 sizes:
      - Small (mobile): 400px wide, 75% quality
      - Medium (tablet): 800px wide, 80% quality
      - Large (desktop): 1200px wide, 85% quality
   
   b) Update image tags to use responsive images:
   
   <picture>
     <source 
       type="image/webp"
       srcset="
         /images/service-icon-400.webp 400w,
         /images/service-icon-800.webp 800w,
         /images/service-icon-1200.webp 1200w
       "
       sizes="(max-width: 768px) 100vw, 50vw"
     />
     <img 
       src="/images/service-icon-800.jpg" 
       alt="Service"
       width="400"
       height="300"
       loading="lazy"
     />
   </picture>

2. CONVERT ICONS TO SVG:
   Replace all PNG/JPG icons with inline SVG or SVG files:
   - Service type icons: Inline SVG (<svg>...</svg>)
   - Small icons: Use icon library (Lucide React) instead of images
   - Remove icon image files entirely

3. ASYNC CSS LOADING:
   Load non-critical CSS asynchronously:
   
   <link 
     rel="preload" 
     href="/styles/main.css" 
     as="style" 
     onload="this.onload=null;this.rel='stylesheet'"
   />
   <noscript><link rel="stylesheet" href="/styles/main.css"></noscript>

4. ADD RESOURCE HINTS:
   Add to <head> BEFORE other resources:
   
   <!-- Preconnect to external domains -->
   <link rel="preconnect" href="https://fonts.googleapis.com">
   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   
   <!-- DNS prefetch for APIs -->
   <link rel="dns-prefetch" href="//api.stripe.com">
   
   <!-- Preload critical assets -->
   <link rel="preload" href="/logo.svg" as="image">

5. ENSURE PRODUCTION BUILD:
   Verify these settings in Replit:
   - Environment variable: NODE_ENV=production
   - Build command generates minified bundles
   - Source maps disabled (or external only)
   - React DevTools disabled in production
   - Console.log statements removed

═══════════════════════════════════════════════════════════

PHASE 3: REPLIT-SPECIFIC OPTIMIZATIONS (1 hour - DO AFTER PHASE 2)

1. ENABLE COMPRESSION:
   Configure Replit to serve compressed assets:
   - Enable Gzip or Brotli compression in server config
   - Verify with: Response headers should include "Content-Encoding: gzip"

2. SET CACHE HEADERS:
   Configure cache headers for static assets:
   
   Static assets (images, CSS, JS):
   Cache-Control: public, max-age=31536000, immutable
   
   HTML files:
   Cache-Control: public, max-age=3600, must-revalidate

3. MINIFY OUTPUT:
   Ensure all assets are minified:
   - HTML: Minified (remove whitespace, comments)
   - CSS: Minified and concatenated
   - JavaScript: Minified and tree-shaken
   - Remove unused code

4. OPTIMIZE REACT RENDERING:
   Add performance optimizations to React components:
   
   a) Wrap components in React.memo():
   export default React.memo(ComponentName);
   
   b) Use useMemo() for expensive calculations:
   const expensiveValue = useMemo(() => calculateValue(data), [data]);
   
   c) Use useCallback() for event handlers:
   const handleClick = useCallback(() => { ... }, [dependencies]);

5. REMOVE MOBILE HOVER EFFECTS:
   Add to CSS:
   
   @media (max-width: 767px) {
     /* Disable hover effects on mobile */
     * {
       -webkit-tap-highlight-color: transparent;
     }
     
     .card:hover,
     .button:hover {
       transform: none !important;
     }
   }

═══════════════════════════════════════════════════════════

TESTING & VERIFICATION:

After EACH phase, test with:

1. PageSpeed Insights Mobile:
   https://pagespeed.web.dev/
   - Enter: demande-raccordement.fr
   - Select: Mobile
   - Target scores:
     * Performance: 85+
     * FCP (First Contentful Paint): <1.8s
     * LCP (Largest Contentful Paint): <2.5s
     * TBT (Total Blocking Time): <200ms
     * CLS (Cumulative Layout Shift): <0.1

2. Chrome DevTools:
   - Open DevTools → Network tab
   - Throttle: Slow 3G
   - Test page load time
   - Verify images load with lazy loading
   - Check all scripts have defer attribute

3. Real Mobile Device:
   - Test on actual iPhone or Android
   - Check form submission works
   - Verify all images load properly
   - Test all CTAs are clickable

═══════════════════════════════════════════════════════════

EXPECTED RESULTS:

After Phase 1 (30 min):
- Mobile PageSpeed: 55-70 (+15-30 points)
- Visible improvement in render speed

After Phase 2 (2 hours):
- Mobile PageSpeed: 75-85 (+20-40 points total)
- Images load faster, less bandwidth used

After Phase 3 (1 hour):
- Mobile PageSpeed: 85-95 (target achieved)
- Google Ads Quality Score improves
- CPC decreases by 15-25%
- Mobile conversion rate increases by 30-50%

═══════════════════════════════════════════════════════════

CRITICAL REMINDERS:

✅ Implement phases IN ORDER (don't skip Phase 1)
✅ Test after each phase before proceeding
✅ Keep backup of current code before starting
✅ Focus on mobile-first (mobile users are 60-70% of traffic)
✅ Every optimization should improve mobile PageSpeed score

❌ Don't optimize desktop at expense of mobile
❌ Don't add new features during performance fixes
❌ Don't skip testing between phases

START WITH PHASE 1 NOW. Report back with mobile PageSpeed score after Phase 1 completion.