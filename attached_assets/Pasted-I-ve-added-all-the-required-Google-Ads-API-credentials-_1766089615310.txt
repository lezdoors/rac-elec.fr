I've added all the required Google Ads API credentials to Replit Secrets. Now implement the server-side conversion tracking.
Credentials confirmed in Replit Secrets:

GOOGLE_ADS_DEVELOPER_TOKEN ✅
GOOGLE_ADS_CLIENT_ID ✅
GOOGLE_ADS_CLIENT_SECRET ✅
GOOGLE_ADS_REFRESH_TOKEN ✅
GOOGLE_ADS_CUSTOMER_ID ✅
GOOGLE_ADS_LOGIN_CUSTOMER_ID ✅

Implementation Tasks:
1. Install Required Package
bashnpm install google-ads-api
2. Create Google Ads Conversion Service
Create file: server/services/googleAdsConversion.ts
Requirements:

Initialize Google Ads API client with credentials from environment variables
Use GOOGLE_ADS_LOGIN_CUSTOMER_ID as the login customer ID (Manager account)
Use GOOGLE_ADS_CUSTOMER_ID as the target customer ID (ad account)
Create function sendGoogleAdsConversion() that accepts:

gclid (string)
reference (order ID - string)
email (string)
phone (string)
firstName (string)
lastName (string)
city (string)
postalCode (string)



Function should:

Hash all personal data using SHA-256:

Email: trim, lowercase, then hash
Phone: convert to E.164 format (+33XXXXXXXXX), then hash
First name: trim, lowercase, then hash
Last name: trim, lowercase, then hash


Send conversion to Google Ads API with this structure:

typescript{
  conversion_action: "customers/1462811513/conversionActions/16683623620", // Full resource name format
  gclid: gclid,
  conversion_date_time: new Date().toISOString(),
  conversion_value: 129.80,
  currency_code: "EUR",
  order_id: reference,
  user_identifiers: [{
    hashed_email: hashedEmail,
    hashed_phone_number: hashedPhone,
    address_info: {
      hashed_first_name: hashedFirstName,
      hashed_last_name: hashedLastName,
      city: city,
      postal_code: postalCode,
      country_code: "FR"
    }
  }]
}

Include comprehensive error handling and logging
Return success/failure status

3. Update Stripe Webhook Handler
In server/routes.ts, find the Stripe webhook handler where payment is marked as "paid".
After the database is updated with payment_status = "paid", add:
typescript// Send conversion to Google Ads if gclid exists
if (serviceRequest?.gclid) {
  try {
    const conversionSent = await sendGoogleAdsConversion({
      gclid: serviceRequest.gclid,
      reference: serviceRequest.reference,
      email: serviceRequest.email,
      phone: serviceRequest.phone,
      firstName: serviceRequest.firstName,
      lastName: serviceRequest.lastName,
      city: serviceRequest.city,
      postalCode: serviceRequest.postalCode
    });
    
    if (conversionSent) {
      console.log(`✅ Google Ads conversion sent successfully for ${serviceRequest.reference}`);
    } else {
      console.log(`⚠️ Google Ads conversion failed for ${serviceRequest.reference}`);
    }
  } catch (error) {
    console.error(`❌ Error sending Google Ads conversion for ${serviceRequest.reference}:`, error);
    // Don't throw - webhook should succeed even if conversion tracking fails
  }
}
4. Phone Number Formatting Helper
Create a helper function to convert French phone numbers to E.164 format:

Input: "0612345678" or "06 12 34 56 78"
Remove all spaces and non-digits
If starts with "0", replace with "+33"
Output: "+33612345678"

5. Testing & Validation
After implementation:

Show me the complete code for both files
Confirm the npm package is installed
Add detailed logging at each step:

"Initializing Google Ads conversion..."
"Hashing user data..."
"Sending conversion to Google Ads API..."
"Conversion sent successfully" or "Conversion failed: [error]"



6. Important Notes

Use the google-ads-api npm package (NOT REST API)
Customer ID format: Use numbers only (1462811513), not "AW-" prefix
Conversion action format: Full resource name customers/{customer_id}/conversionActions/{conversion_id}
Don't throw errors that would break the webhook - always catch and log
Keep existing client-side tracking as backup (don't remove dataLayer.push)

Build this now with production-ready code, proper error handling, and detailed logging.