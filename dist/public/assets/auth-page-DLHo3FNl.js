import{c as p,u as j,a as g,b as f,r as o,d as v,e as N,j as e,F as b,f as l,g as c,h as d,i as m,I as u,k as x,B as w,l as y,z as i,t as C,m as F}from"./index-cjnB3GMu.js";import{C as S,a as k,b as I,c as L,d as T,e as E}from"./card-CFU3-XIf.js";import{B as M}from"./bolt-A1Jd4c9D.js";import{L as P}from"./lock-By-6tq2A.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=p("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),q=i.object({username:i.string().min(1,"Le nom d'utilisateur est requis"),password:i.string().min(1,"Le mot de passe est requis")});function z(){j();const{toast:n}=g();f("/admin"),o.useState(!1),o.useEffect(()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser")},[]);const t=v({resolver:C(q),defaultValues:{username:"",password:""}}),r=N({mutationFn:async s=>await(await F("POST","/api/login",s)).json(),onSuccess:s=>{if(console.log("Réponse du serveur après connexion:",s),!s.success||!s.user||!s.user.role){console.error("Données d'authentification invalides:",s),n({title:"Erreur d'authentification",description:"Format de réponse invalide du serveur.",variant:"destructive"});return}const a=`admin-session-${Date.now()}`;localStorage.setItem("adminToken",a),localStorage.setItem("adminUser",JSON.stringify(s.user)),console.log("Token généré:",a),console.log("Utilisateur stocké:",s.user),n({title:"Connexion réussie",description:"Vous êtes maintenant connecté à l'interface d'administration.",variant:"default"}),window.location.href="/admin/dashboard"},onError:s=>{n({title:"Échec de la connexion",description:s instanceof Error?s.message:"Nom d'utilisateur ou mot de passe incorrect.",variant:"destructive"})}});function h(s){r.mutate(s)}return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-8 p-4",children:[e.jsxs(S,{className:"shadow-lg",children:[e.jsxs(k,{className:"space-y-1",children:[e.jsx(I,{className:"text-2xl font-bold",children:"Administration"}),e.jsx(L,{children:"Connectez-vous pour accéder au tableau de bord d'administration"})]}),e.jsx(T,{children:e.jsx(b,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(h),className:"space-y-4",children:[e.jsx(l,{control:t.control,name:"username",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Nom d'utilisateur"}),e.jsx(m,{children:e.jsx(u,{placeholder:"admin",...s})}),e.jsx(x,{})]})}),e.jsx(l,{control:t.control,name:"password",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Mot de passe"}),e.jsx(m,{children:e.jsx(u,{type:"password",placeholder:"********",...s})}),e.jsx(x,{})]})}),e.jsx(w,{type:"submit",className:"w-full",disabled:r.isPending,children:r.isPending?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4 animate-spin"}),"Connexion..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Se connecter"]})})]})})}),e.jsx(E,{className:"flex justify-center border-t pt-4",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Accès administrateur réservé au personnel autorisé"})})]}),e.jsxs("div",{className:"bg-gradient-to-tr from-blue-600 to-indigo-600 rounded-lg shadow-lg flex flex-col p-8 text-white",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(M,{className:"h-8 w-8"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Services Enedis"})]}),e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Interface d'administration"}),e.jsx("p",{className:"text-white/80 mb-6",children:"Cette interface est réservée aux administrateurs et permet de gérer les demandes de raccordement, suivre leur avancement, et communiquer avec les clients."}),e.jsx("div",{className:"mt-auto",children:e.jsxs("div",{className:"bg-white/10 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(P,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-1",children:"Accès sécurisé"}),e.jsx("p",{className:"text-sm text-white/70",children:"Toutes les informations et données client sont protégées et chiffrées conformément au RGPD."})]})]})})]})]})})}export{z as default};
