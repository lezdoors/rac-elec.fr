import{c as Pe,r as p,b1 as ts,j as e,B as Y,an as me,ao as le,ap as rs,al as ns,Y as P,v as Q,as as is,a as as,a4 as E,m as G,x as ee,aH as ls}from"./index-BK98VQ5F.js";import{u as B}from"./useQuery-CeUf9-P4.js";import{u as os}from"./use-auth-DDA4cOrX.js";import{t as Ne,d as cs,L as Ee,N as Ie,O as ds,A as ms,P as xs,k as us,B as hs}from"./admin-layout-D-1BJ3rJ.js";import{B as L}from"./badge-CFTHm_pp.js";import{C as ye}from"./circle-check-WYEGna6O.js";import{A as oe}from"./activity-B7jYyUgx.js";import{R as ce}from"./refresh-cw-BJGxwb-t.js";import{c as Ae,R as js,I as ps}from"./use-mobile-CaPxtXK8.js";import{u as fs}from"./index-CigaS-v9.js";import{C as x,d as u,a as f,b as N,c as I,e as be}from"./card-CdJ_2Jsj.js";import{T as gs,a as vs,b as se,c as te}from"./tabs-c4YLjcKa.js";import{S as we,a as Ce,d as Te,b as De,c as V}from"./select-z7-ybKU8.js";import{P as H}from"./progress-BUISAfhE.js";import{T as re,a as ne,b as S,c as g,d as ie,e as v}from"./table-CEQ4NEE9.js";import{F as Ns}from"./file-text-Cf4cAjZj.js";import{C as ys}from"./credit-card-sbxkXRy6.js";import{E as Me}from"./euro-_KnbgV3H.js";import{H as bs}from"./history-5neJCGMK.js";import{D as ke}from"./download-X-AQknA8.js";import{i as ws}from"./isBefore-DcMIdcPs.js";import"./log-out-Cxe76wKU.js";import"./settings-CokUIdI1.js";import"./index-DRwQ35eW.js";import"./index-YVpoeFfG.js";import"./separator-CGE3VMYe.js";import"./external-link-BPiGZE9F.js";import"./index-BnVOeou3.js";import"./chevron-down-6zcunRD4.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Pe("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=Pe("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);function O(r,s){const n=Ne(r),i=Ne(s),a=qe(n,i),d=Math.abs(cs(n,i));n.setDate(n.getDate()-a*d);const c=+(qe(n,i)===-a),m=a*(d-c);return m===0?0:m}function qe(r,s){const n=r.getFullYear()-s.getFullYear()||r.getMonth()-s.getMonth()||r.getDate()-s.getDate()||r.getHours()-s.getHours()||r.getMinutes()-s.getMinutes()||r.getSeconds()-s.getSeconds()||r.getMilliseconds()-s.getMilliseconds();return n<0?-1:n>0?1:n}function _(r,s){const i=qs(r);let a;if(i.date){const j=Rs(i.date,2);a=Ps(j.restDateString,j.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const d=a.getTime();let c=0,m;if(i.time&&(c=Es(i.time),isNaN(c)))return new Date(NaN);if(i.timezone){if(m=Is(i.timezone),isNaN(m))return new Date(NaN)}else{const j=new Date(d+c),y=new Date(0);return y.setFullYear(j.getUTCFullYear(),j.getUTCMonth(),j.getUTCDate()),y.setHours(j.getUTCHours(),j.getUTCMinutes(),j.getUTCSeconds(),j.getUTCMilliseconds()),y}return new Date(d+c+m)}const W={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ds=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ms=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ks=/^([+-])(\d{2})(?::?(\d{2}))?$/;function qs(r){const s={},n=r.split(W.dateTimeDelimiter);let i;if(n.length>2)return s;if(/:/.test(n[0])?i=n[0]:(s.date=n[0],i=n[1],W.timeZoneDelimiter.test(s.date)&&(s.date=r.split(W.timeZoneDelimiter)[0],i=r.substr(s.date.length,r.length))),i){const a=W.timezone.exec(i);a?(s.time=i.replace(a[1],""),s.timezone=a[1]):s.time=i}return s}function Rs(r,s){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),i=r.match(n);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,d=i[2]?parseInt(i[2]):null;return{year:d===null?a:d*100,restDateString:r.slice((i[1]||i[2]).length)}}function Ps(r,s){if(s===null)return new Date(NaN);const n=r.match(Ds);if(!n)return new Date(NaN);const i=!!n[4],a=$(n[1]),d=$(n[2])-1,c=$(n[3]),m=$(n[4]),j=$(n[5])-1;if(i)return Ss(s,m,j)?As(s,m,j):new Date(NaN);{const y=new Date(0);return!Fs(s,d,c)||!Gs(s,a)?new Date(NaN):(y.setUTCFullYear(s,d,Math.max(a,c)),y)}}function $(r){return r?parseInt(r):1}function Es(r){const s=r.match(Ms);if(!s)return NaN;const n=ae(s[1]),i=ae(s[2]),a=ae(s[3]);return Us(n,i,a)?n*Ee+i*Ie+a*1e3:NaN}function ae(r){return r&&parseFloat(r.replace(",","."))||0}function Is(r){if(r==="Z")return 0;const s=r.match(ks);if(!s)return 0;const n=s[1]==="+"?-1:1,i=parseInt(s[2]),a=s[3]&&parseInt(s[3])||0;return zs(i,a)?n*(i*Ee+a*Ie):NaN}function As(r,s,n){const i=new Date(0);i.setUTCFullYear(r,0,4);const a=i.getUTCDay()||7,d=(s-1)*7+n+1-a;return i.setUTCDate(i.getUTCDate()+d),i}const Ls=[31,null,31,30,31,30,31,31,30,31,30,31];function Le(r){return r%400===0||r%4===0&&r%100!==0}function Fs(r,s,n){return s>=0&&s<=11&&n>=1&&n<=(Ls[s]||(Le(r)?29:28))}function Gs(r,s){return s>=1&&s<=(Le(r)?366:365)}function Ss(r,s,n){return s>=1&&s<=53&&n>=0&&n<=6}function Us(r,s,n){return r===24?s===0&&n===0:n>=0&&n<60&&s>=0&&s<60&&r>=0&&r<25}function zs(r,s){return s>=0&&s<=59}const Vs=()=>{const{isConnected:r,reconnect:s}=ds(),[n,i]=p.useState("connected"),[a,d]=p.useState(!1),[c,m]=p.useState(!1);p.useEffect(()=>{const y=()=>{const w=window.innerWidth<768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);m(w)};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]),p.useEffect(()=>{r?(i("connected"),d(!1)):i("disconnected")},[r]),p.useEffect(()=>{const w=setTimeout(()=>{(n==="connecting"||c&&n==="disconnected")&&(console.log("Forçage du statut connecté pour améliorer l'UX sur mobile"),i("connected"))},c?5e3:1e4);return()=>clearTimeout(w)},[n,c]);const j=p.useCallback(()=>{d(!0),i("connecting");try{s&&(s(),ts({title:"Reconnexion",description:"Tentative de reconnexion en cours..."}))}catch(y){console.error("Erreur lors de la tentative de reconnexion:",y)}setTimeout(()=>{d(!1)},3e3)},[s]);return c?e.jsxs(L,{variant:"outline",className:`flex items-center space-x-1 text-xs px-2 py-1 ${n==="connected"?"text-green-600 border-green-200 bg-green-50":"text-blue-600 border-blue-200 bg-blue-50"}`,children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsx("span",{children:"Temps réel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"outline",className:`flex items-center space-x-1 text-xs px-2 py-1 ${n==="connected"?"text-green-600 border-green-200 bg-green-50":n==="connecting"?"text-blue-600 border-blue-200 bg-blue-50":"text-red-600 border-red-200 bg-red-50"}`,children:n==="connected"?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsx("span",{children:"Mises à jour temps réel actives"})]}):n==="connecting"?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-3 w-3 animate-pulse"}),e.jsx("span",{children:"Connexion en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"h-3 w-3"}),e.jsx("span",{children:"Connexion perdue"})]})}),n==="disconnected"&&!a&&e.jsxs(Y,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:j,disabled:a,children:[e.jsx(ce,{className:`h-3 w-3 mr-1 ${a?"animate-spin":""}`}),"Reconnecter"]})]})};var _s="Toggle",xe=p.forwardRef((r,s)=>{const{pressed:n,defaultPressed:i=!1,onPressedChange:a,...d}=r,[c=!1,m]=me({prop:n,onChange:a,defaultProp:i});return e.jsx(le.button,{type:"button","aria-pressed":c,"data-state":c?"on":"off","data-disabled":r.disabled?"":void 0,...d,ref:s,onClick:rs(r.onClick,()=>{r.disabled||m(!c)})})});xe.displayName=_s;var Fe=xe,U="ToggleGroup",[Ge,Tt]=ns(U,[Ae]),Se=Ae(),ue=P.forwardRef((r,s)=>{const{type:n,...i}=r;if(n==="single"){const a=i;return e.jsx($s,{...a,ref:s})}if(n==="multiple"){const a=i;return e.jsx(Bs,{...a,ref:s})}throw new Error(`Missing prop \`type\` expected on \`${U}\``)});ue.displayName=U;var[Ue,ze]=Ge(U),$s=P.forwardRef((r,s)=>{const{value:n,defaultValue:i,onValueChange:a=()=>{},...d}=r,[c,m]=me({prop:n,defaultProp:i,onChange:a});return e.jsx(Ue,{scope:r.__scopeToggleGroup,type:"single",value:c?[c]:[],onItemActivate:m,onItemDeactivate:P.useCallback(()=>m(""),[m]),children:e.jsx(Ve,{...d,ref:s})})}),Bs=P.forwardRef((r,s)=>{const{value:n,defaultValue:i,onValueChange:a=()=>{},...d}=r,[c=[],m]=me({prop:n,defaultProp:i,onChange:a}),j=P.useCallback(w=>m((A=[])=>[...A,w]),[m]),y=P.useCallback(w=>m((A=[])=>A.filter(F=>F!==w)),[m]);return e.jsx(Ue,{scope:r.__scopeToggleGroup,type:"multiple",value:c,onItemActivate:j,onItemDeactivate:y,children:e.jsx(Ve,{...d,ref:s})})});ue.displayName=U;var[Hs,Os]=Ge(U),Ve=P.forwardRef((r,s)=>{const{__scopeToggleGroup:n,disabled:i=!1,rovingFocus:a=!0,orientation:d,dir:c,loop:m=!0,...j}=r,y=Se(n),w=fs(c),A={role:"group",dir:w,...j};return e.jsx(Hs,{scope:n,rovingFocus:a,disabled:i,children:a?e.jsx(js,{asChild:!0,...y,orientation:d,dir:w,loop:m,children:e.jsx(le.div,{...A,ref:s})}):e.jsx(le.div,{...A,ref:s})})}),K="ToggleGroupItem",_e=P.forwardRef((r,s)=>{const n=ze(K,r.__scopeToggleGroup),i=Os(K,r.__scopeToggleGroup),a=Se(r.__scopeToggleGroup),d=n.value.includes(r.value),c=i.disabled||r.disabled,m={...r,pressed:d,disabled:c},j=P.useRef(null);return i.rovingFocus?e.jsx(ps,{asChild:!0,...a,focusable:!c,active:d,ref:j,children:e.jsx(Re,{...m,ref:s})}):e.jsx(Re,{...m,ref:s})});_e.displayName=K;var Re=P.forwardRef((r,s)=>{const{__scopeToggleGroup:n,value:i,...a}=r,d=ze(K,n),c={role:"radio","aria-checked":r.pressed,"aria-pressed":void 0},m=d.type==="single"?c:void 0;return e.jsx(xe,{...m,...a,ref:s,onPressedChange:j=>{j?d.onItemActivate(i):d.onItemDeactivate(i)}})}),$e=ue,Be=_e;const He=is("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),Ws=p.forwardRef(({className:r,variant:s,size:n,...i},a)=>e.jsx(Fe,{ref:a,className:Q(He({variant:s,size:n,className:r})),...i}));Ws.displayName=Fe.displayName;const Oe=p.createContext({size:"default",variant:"default"}),We=p.forwardRef(({className:r,variant:s,size:n,children:i,...a},d)=>e.jsx($e,{ref:d,className:Q("flex items-center justify-center gap-1",r),...a,children:e.jsx(Oe.Provider,{value:{variant:s,size:n},children:i})}));We.displayName=$e.displayName;const de=p.forwardRef(({className:r,children:s,variant:n,size:i,...a},d)=>{const c=p.useContext(Oe);return e.jsx(Be,{ref:d,className:Q(He({variant:c.variant||n,size:c.size||i}),r),...a,children:s})});de.displayName=Be.displayName;function R({className:r,...s}){return e.jsx("div",{className:Q("animate-pulse rounded-md bg-muted",r),...s})}const Dt=()=>{const{toast:r}=as(),{user:s}=os(),[n,i]=p.useState(!1),[a,d]=p.useState("current"),[c,m]=p.useState(null),[j,y]=p.useState("current"),[w,A]=p.useState(!1),F=p.useRef(null),[he,Z]=p.useState("personal"),[J,Ye]=p.useState(!1),[Ke,Qe]=p.useState(!1),[D,je]=p.useState([]),[Ys,Ze]=p.useState(null);p.useEffect(()=>{if(s){const t=s.role==="admin",o=s.role==="manager";Qe(t),Ye(o),i(t||o),Ze(s),o&&s.id?(m(s.id),Z("team"),E.fetchQuery({queryKey:[`/api/users/team/${s.id}`],queryFn:()=>G("GET",`/api/users/team/${s.id}`).then(h=>h.json()).then(h=>(h.success&&h.users&&je(h.users),h))}).catch(h=>{console.error("Erreur lors de la récupération des membres de l'équipe",h)})):!t&&!o&&s.id&&(m(s.id),Z("personal"))}},[s,E]),p.useEffect(()=>{const t=()=>{const o=new Date,h=o.getDate(),T=new Date(o.getFullYear(),o.getMonth()+1,0).getDate();let b;h<15?b=new Date(o.getFullYear(),o.getMonth(),15,0,0,0):h<T?b=new Date(o.getFullYear(),o.getMonth()+1,0,0,0,0):b=new Date(o.getFullYear(),o.getMonth()+1,15,0,0,0);const q=b.getTime()-o.getTime();q<864e5&&A(!0),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{E.invalidateQueries({queryKey:["/api/user-stats/current"]}),E.invalidateQueries({queryKey:["/api/user-stats/overview"]}),E.invalidateQueries({queryKey:["/api/user-stats/history"]}),r({title:"Statistiques réinitialisées",description:"Les statistiques ont été automatiquement réinitialisées pour la nouvelle période."}),t()},q)};return t(),()=>{F.current&&clearTimeout(F.current)}},[r]);const{data:l,isLoading:Je}=B({queryKey:["/api/user-stats/current",c],queryFn:async()=>await(await G("GET",c?`/api/user-stats/current/${c}`:"/api/user-stats/current")).json(),enabled:!!s,refetchInterval:3e4}),{data:M,isLoading:Xe}=B({queryKey:["/api/user-stats/overview"],queryFn:async()=>await(await G("GET","/api/user-stats/overview")).json(),enabled:!!s&&n&&a==="overview"}),{data:z,isLoading:es}=B({queryKey:["/api/user-stats/history",c],queryFn:async()=>await(await G("GET",c?`/api/user-stats/history/${c}`:"/api/user-stats/history")).json(),enabled:!!s&&a==="history"}),{data:pe,isLoading:Ks}=B({queryKey:["/api/users"],queryFn:async()=>await(await G("GET","/api/users")).json(),enabled:!!s&&n}),C=t=>((typeof t=="string"?parseFloat(t):t)/100).toLocaleString("fr-FR",{style:"currency",currency:"EUR"}),k=t=>{try{return us(_(t),"d MMMM yyyy",{locale:hs})}catch{return t}},X=l&&l.leadsReceived>0?l.leadsConverted/l.leadsReceived*100:0,ss=()=>{if(!(l!=null&&l.periodEnd))return 0;const t=new Date,o=_(l.periodEnd);return ws(o,t)?0:O(o,t)},fe=()=>{if(!(l!=null&&l.periodStart)||!(l!=null&&l.periodEnd))return 0;const t=_(l.periodStart),o=_(l.periodEnd),h=new Date,T=O(o,t),b=O(h,t);return Math.max(0,Math.min(100,Math.floor(b/T*100)))};return e.jsx(ms,{children:e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Statistiques de performance"}),!n&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Visualisez et suivez vos statistiques personnelles et les périodes précédentes"}),J&&e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(L,{className:"bg-blue-100 text-blue-700 hover:bg-blue-100 mr-2",children:Ke?"Admin":"Manager"}),D.length>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[D.length," ",D.length>1?"membres":"membre"," dans votre équipe"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Vs,{}),l&&e.jsxs(L,{variant:"outline",className:"gap-1 py-1.5 px-2 font-normal",children:[e.jsx(ee,{className:"h-3.5 w-3.5 mr-1"}),"Période: ",k(l.periodStart)," - ",k(l.periodEnd)]}),n&&e.jsxs(Y,{variant:"outline",onClick:()=>{r({title:"Réinitialisation forcée",description:"Les statistiques seront réinitialisées pour tous les utilisateurs."}),E.fetchQuery({queryKey:["/api/user-stats/reset"],queryFn:()=>G("POST","/api/user-stats/reset").then(t=>t.json())}).then(t=>{t.success?(r({title:"Statistiques réinitialisées",description:"Les données ont été archivées et remises à zéro."}),E.invalidateQueries({queryKey:["/api/user-stats/current"]}),E.invalidateQueries({queryKey:["/api/user-stats/overview"]})):r({title:"Erreur",description:t.message||"Une erreur est survenue lors de la réinitialisation.",variant:"destructive"})}).catch(t=>{r({title:"Erreur",description:"Une erreur est survenue lors de la réinitialisation.",variant:"destructive"})})},size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(x,{className:"bg-green-50 border-green-100",children:e.jsxs(u,{className:"p-4 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"mb-2 mt-2 rounded-full bg-green-100 p-2 w-10 h-10 flex items-center justify-center",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-green-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}),e.jsx("div",{className:"text-3xl font-bold text-green-700",children:(M==null?void 0:M.totalPayments)||(l==null?void 0:l.paymentsProcessed)||0}),e.jsx("p",{className:"text-sm text-green-600",children:"Paiements réussis"})]})}),e.jsx(x,{className:"bg-amber-50 border-amber-100",children:e.jsxs(u,{className:"p-4 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"mb-2 mt-2 rounded-full bg-amber-100 p-2 w-10 h-10 flex items-center justify-center",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-amber-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]})}),e.jsx("div",{className:"text-3xl font-bold text-amber-700",children:"0"}),e.jsx("p",{className:"text-sm text-amber-600",children:"En cours"})]})}),e.jsx(x,{className:"bg-red-50 border-red-100",children:e.jsxs(u,{className:"p-4 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"mb-2 mt-2 rounded-full bg-red-100 p-2 w-10 h-10 flex items-center justify-center",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-red-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m15 9-6 6"}),e.jsx("path",{d:"m9 9 6 6"})]})}),e.jsx("div",{className:"text-3xl font-bold text-red-700",children:"0"}),e.jsx("p",{className:"text-sm text-red-600",children:"Échoués/Abandonnés"})]})})]}),e.jsxs(gs,{defaultValue:"current",value:a,onValueChange:d,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(vs,{children:[e.jsx(se,{value:"current",children:"Période actuelle"}),e.jsx(se,{value:"history",children:"Historique"}),n&&e.jsx(se,{value:"overview",children:"Vue globale"})]}),J&&a==="current"&&e.jsxs(We,{type:"single",value:he,onValueChange:t=>{t&&(Z(t),t==="team"&&D.length===0&&s&&s.id&&E.fetchQuery({queryKey:[`/api/users/team/${s.id}`],queryFn:()=>G("GET",`/api/users/team/${s.id}`).then(o=>o.json()).then(o=>(o.success&&o.users&&je(o.users),o))}).catch(o=>{console.error("Erreur lors de la récupération des membres de l'équipe",o),r({title:"Erreur",description:"Impossible de charger les données de l'équipe",variant:"destructive"})}))},className:"flex",children:[e.jsxs(de,{value:"personal",size:"sm",className:"text-xs",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Mes statistiques"]}),e.jsxs(de,{value:"team",size:"sm",className:"text-xs",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"Équipe"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[l&&e.jsxs(L,{variant:"outline",className:"gap-1 py-1 px-2 font-normal",children:[e.jsx(ee,{className:"h-3.5 w-3.5 mr-1"}),k(l.periodStart)," - ",k(l.periodEnd)]}),n&&e.jsxs(we,{value:c?c.toString():"all",onValueChange:t=>m(t==="all"?null:parseInt(t)),children:[e.jsx(Ce,{className:"w-[220px]",children:e.jsx(Te,{placeholder:"Sélectionner un utilisateur"})}),e.jsxs(De,{children:[e.jsx(V,{value:"all",children:"Tous les utilisateurs"}),pe&&pe.map(t=>e.jsxs(V,{value:t.id.toString(),children:[t.fullName||t.username," (",t.role,")"]},t.id))]})]}),w&&e.jsxs(L,{variant:"secondary",className:"gap-1 py-1 animate-pulse",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"Réinitialisation prévue bientôt"]})]})]}),e.jsx(te,{value:"current",className:"space-y-6",children:Je?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Array(6).fill(0).map((t,o)=>e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(R,{className:"h-4 w-24"})}),e.jsxs(u,{children:[e.jsx(R,{className:"h-10 w-28"}),e.jsx(R,{className:"h-4 w-32 mt-2"})]})]},o))}):l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Période en cours"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:k(l.periodStart)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["jusqu'au ",k(l.periodEnd)]})]}),e.jsx(ee,{className:"h-8 w-8 text-muted-foreground"})]})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Leads reçus"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("p",{className:"text-2xl font-bold",children:l.leadsReceived})}),e.jsx(Ns,{className:"h-8 w-8 text-blue-500"})]})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Leads convertis"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l.leadsConverted}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[X.toFixed(1),"% de conversion"]})]}),e.jsx(oe,{className:"h-8 w-8 text-green-500"})]})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Paiements traités"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("p",{className:"text-2xl font-bold",children:l.paymentsProcessed})}),e.jsx(ys,{className:"h-8 w-8 text-purple-500"})]})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Montant total"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("p",{className:"text-2xl font-bold text-green-600",children:C(l.paymentsAmount)})}),e.jsx(Me,{className:"h-8 w-8 text-green-500"})]})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Commissions"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:C(l.commissionsEarned)})}),e.jsx(Me,{className:"h-8 w-8 text-blue-500"})]})})]})]}),e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(N,{children:"Informations sur la période"}),e.jsx(I,{children:"Les statistiques sont remises à zéro le 1er et le 16 de chaque mois à minuit"})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-sm space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Période actuelle:"})," du ",k(l.periodStart)," au ",k(l.periodEnd)]}),e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Prochaine réinitialisation:"})," ",k(l.periodEnd)," à minuit",e.jsxs(L,{variant:"outline",className:"ml-2 bg-blue-50",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-3 w-3 mr-1",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]})," ",ss()," jours restants"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Progression de la période"}),e.jsxs("span",{children:[fe(),"%"]})]}),e.jsx(H,{value:fe(),className:"h-2"})]}),w&&e.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md text-amber-700",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:e.jsx("path",{d:"M12 3v3m6-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10v11m16-11v11"})}),e.jsx("p",{className:"font-medium",children:"Réinitialisation prévue aujourd'hui"})]}),e.jsx("p",{className:"text-xs mt-1",children:"Les statistiques seront automatiquement remises à zéro à minuit et l'historique sera conservé."})]}),e.jsx("p",{className:"text-muted-foreground italic",children:"Toutes les statistiques sont remises à zéro automatiquement tous les 15 jours. L'historique des périodes précédentes reste consultable par les administrateurs."})]})})]}),J&&he==="team"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mt-6 mb-4",children:[e.jsx(ls,{className:"h-5 w-5 text-blue-500"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Performances de l'équipe"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(x,{children:[e.jsxs(f,{className:"pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Taux de conversion moyen"}),e.jsx(I,{children:"Performance collective"})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:"text-3xl font-bold",children:l&&D.length>0?`${X.toFixed(1)}%`:"0%"}),e.jsx("div",{className:"text-xs text-muted-foreground pb-1",children:"leads convertis/reçus"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(H,{value:X,className:"h-2"})})]})]}),e.jsxs(x,{children:[e.jsxs(f,{className:"pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Volume total d'activité"}),e.jsx(I,{children:"Demandes traitées par l'équipe"})]}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:l?l.leadsReceived:0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"leads reçus"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:l?l.leadsConverted:0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"leads convertis"})]})]})})]}),e.jsxs(x,{children:[e.jsxs(f,{className:"pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Revenue de l'équipe"}),e.jsx(I,{children:"Paiements et commissions"})]}),e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:l?C(l.paymentsAmount):"0 €"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"montant total"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:l?C(l.commissionsEarned):"0 €"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"commissions"})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(N,{className:"text-sm font-medium",children:"Performance comparative"}),e.jsx(I,{children:"Comparaison des taux de conversion"})]}),e.jsx(u,{className:"h-72",children:e.jsx("div",{className:"h-full w-full flex items-center justify-center",children:e.jsxs("div",{className:"space-y-8 w-full",children:[D.slice(0,5).map((t,o)=>{var T,b,q;const h=((T=t.stats)==null?void 0:T.leadsReceived)>0?((b=t.stats)==null?void 0:b.leadsConverted)/((q=t.stats)==null?void 0:q.leadsReceived)*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:t.fullName||t.username}),e.jsxs("span",{children:[h.toFixed(1),"%"]})]}),e.jsx(H,{value:h,className:`h-2 ${h>75?"[--progress-foreground:theme(colors.green.500)]":h>50?"[--progress-foreground:theme(colors.blue.500)]":h>25?"[--progress-foreground:theme(colors.amber.500)]":"[--progress-foreground:theme(colors.red.500)]"}`})]},o)}),D.length===0&&e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Aucune donnée d'équipe disponible"})]})})})]}),e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(N,{className:"text-sm font-medium",children:"Répartition des paiements"}),e.jsx(I,{children:"Distribution par membre d'équipe"})]}),e.jsx(u,{className:"h-72",children:e.jsx("div",{className:"h-full w-full flex items-center justify-center",children:e.jsxs("div",{className:"space-y-8 w-full",children:[D.slice(0,5).map((t,o)=>{var q;const h=parseFloat(((q=t.stats)==null?void 0:q.paymentsAmount)||"0"),T=parseFloat((l==null?void 0:l.paymentsAmount)||"0"),b=T>0?h/T*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:t.fullName||t.username}),e.jsx("span",{children:C(h)})]}),e.jsx(H,{value:b,className:"h-2 [--progress-foreground:theme(colors.green.500)]"})]},o)}),D.length===0&&e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Aucune donnée d'équipe disponible"})]})})})]})]}),e.jsxs(x,{className:"mt-4",children:[e.jsxs(f,{children:[e.jsx(N,{children:"Détail par membre"}),e.jsx(I,{children:"Performances individuelles des membres de l'équipe"})]}),e.jsx(u,{children:D.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Aucun membre dans l'équipe"}):e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(S,{children:[e.jsx(g,{children:"Utilisateur"}),e.jsx(g,{className:"text-right",children:"Leads"}),e.jsx(g,{className:"text-right",children:"Convertis"}),e.jsx(g,{className:"text-right",children:"Taux"}),e.jsx(g,{className:"text-right",children:"Montant"}),e.jsx(g,{className:"text-right",children:"Commissions"})]})}),e.jsx(ie,{children:D.map(t=>{var o,h,T,b,q,ge,ve;return e.jsxs(S,{children:[e.jsxs(v,{children:[e.jsx("div",{className:"font-medium",children:t.fullName||t.username}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.role})]}),e.jsx(v,{className:"text-right",children:((o=t.stats)==null?void 0:o.leadsReceived)||0}),e.jsx(v,{className:"text-right",children:((h=t.stats)==null?void 0:h.leadsConverted)||0}),e.jsxs(v,{className:"text-right",children:[((T=t.stats)==null?void 0:T.leadsReceived)>0?(((b=t.stats)==null?void 0:b.leadsConverted)/((q=t.stats)==null?void 0:q.leadsReceived)*100).toFixed(1):0,"%"]}),e.jsx(v,{className:"text-right",children:C(((ge=t.stats)==null?void 0:ge.paymentsAmount)||0)}),e.jsx(v,{className:"text-right",children:C(((ve=t.stats)==null?void 0:ve.commissionsEarned)||0)})]},t.id)})})]})})]})]})]}):e.jsx(x,{children:e.jsx(u,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(oe,{className:"h-10 w-10 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucune statistique disponible"}),e.jsx("p",{className:"text-muted-foreground",children:"Les statistiques seront générées automatiquement au fur et à mesure de l'activité."})]})})})}),e.jsx(te,{value:"history",className:"space-y-6",children:es?e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{className:"h-8 w-72"}),e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(R,{className:"h-6 w-48"}),e.jsx(R,{className:"h-4 w-64"})]}),e.jsx(u,{children:e.jsx(R,{className:"h-64 w-full"})})]})]}):!z||!z.history||z.history.length===0?e.jsx(x,{children:e.jsx(u,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-10 w-10 text-muted-foreground mb-4",children:[e.jsx("path",{d:"M3 12a9 9 0 1 0 18 0 9 9 0 0 0-18 0z"}),e.jsx("path",{d:"M12 7v5l2 3"})]}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucun historique disponible"}),e.jsx("p",{className:"text-muted-foreground",children:"L'historique des statistiques sera disponible après la première réinitialisation."})]})})}):e.jsx(e.Fragment,{children:e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"Historique des périodes"]}),e.jsx(I,{children:"Consultez les statistiques des périodes précédentes"})]}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap gap-4 items-center",children:e.jsxs(we,{value:j,onValueChange:y,children:[e.jsx(Ce,{className:"w-[180px]",children:e.jsx(Te,{placeholder:"Période"})}),e.jsxs(De,{children:[e.jsx(V,{value:"current",children:"Période actuelle"}),e.jsx(V,{value:"last",children:"Dernière période"}),e.jsx(V,{value:"all",children:"Toutes les périodes"})]})]})}),e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(S,{children:[e.jsx(g,{children:"Période"}),e.jsx(g,{className:"text-right",children:"Leads"}),e.jsx(g,{className:"text-right",children:"Conversions"}),e.jsx(g,{className:"text-right",children:"Tx. Conv."}),e.jsx(g,{className:"text-right",children:"Paiements"}),e.jsx(g,{className:"text-right",children:"Montant"}),e.jsx(g,{className:"text-right",children:"Commissions"})]})}),e.jsx(ie,{children:z.history.filter(t=>j==="last"?z.history.indexOf(t)===0:!0).map((t,o)=>{const h=t.leadsReceived>0?t.leadsConverted/t.leadsReceived*100:0;return e.jsxs(S,{children:[e.jsx(v,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[k(t.periodStart)," - ",k(t.periodEnd)]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["il y a ",O(new Date,_(t.periodEnd))," jours"]})]})}),e.jsx(v,{className:"text-right",children:t.leadsReceived}),e.jsx(v,{className:"text-right",children:t.leadsConverted}),e.jsxs(v,{className:"text-right",children:[h.toFixed(1),"%"]}),e.jsx(v,{className:"text-right",children:t.paymentsProcessed}),e.jsx(v,{className:"text-right",children:C(t.paymentsAmount)}),e.jsx(v,{className:"text-right",children:C(t.commissionsEarned)})]},o)})})]}),e.jsxs("div",{className:"bg-gray-50 border border-dashed border-gray-200 rounded-md p-6 flex flex-col items-center justify-center text-center space-y-2",children:[e.jsx(xs,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("h3",{className:"text-sm font-medium",children:"Graphique comparatif"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"L'affichage graphique des données historiques sera disponible prochainement."})]})]})}),e.jsx(be,{className:"justify-end",children:e.jsxs(Y,{variant:"outline",size:"sm",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Exporter l'historique"]})})]})})}),n&&e.jsx(te,{value:"overview",className:"space-y-6",children:Xe?e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{className:"h-8 w-72"}),e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(R,{className:"h-6 w-48"}),e.jsx(R,{className:"h-4 w-64"})]}),e.jsx(u,{children:e.jsx(R,{className:"h-64 w-full"})})]})]}):M?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Total leads"})}),e.jsx(u,{children:e.jsx("p",{className:"text-2xl font-bold",children:M.totalLeads||0})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Total conversions"})}),e.jsx(u,{children:e.jsx("p",{className:"text-2xl font-bold",children:M.totalConversions||0})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Total paiements"})}),e.jsx(u,{children:e.jsx("p",{className:"text-2xl font-bold",children:M.totalPayments||0})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Montant total"})}),e.jsx(u,{children:e.jsx("p",{className:"text-2xl font-bold text-green-600",children:C(M.totalAmount||0)})})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Commissions totales"})}),e.jsx(u,{children:e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:C(M.totalCommissions||0)})})]})]}),e.jsxs(x,{children:[e.jsxs(f,{children:[e.jsx(N,{children:"Détail par utilisateur"}),e.jsx(I,{children:"Performance de chaque utilisateur pour la période en cours"})]}),e.jsx(u,{children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(S,{children:[e.jsx(g,{children:"Utilisateur"}),e.jsx(g,{children:"Rôle"}),e.jsx(g,{className:"text-right",children:"Leads"}),e.jsx(g,{className:"text-right",children:"Conversions"}),e.jsx(g,{className:"text-right",children:"Tx. Conv."}),e.jsx(g,{className:"text-right",children:"Paiements"}),e.jsx(g,{className:"text-right",children:"Montant"}),e.jsx(g,{className:"text-right",children:"Commissions"})]})}),e.jsx(ie,{children:M.byUser&&Object.values(M.byUser).map(t=>{const o=t.leadsReceived>0?t.leadsConverted/t.leadsReceived*100:0;return e.jsxs(S,{children:[e.jsx(v,{className:"font-medium",children:t.fullName||t.username}),e.jsx(v,{children:e.jsx(L,{variant:t.role==="admin"?"destructive":t.role==="manager"?"default":"secondary",children:t.role==="admin"?"Admin":t.role==="manager"?"Manager":"Utilisateur"})}),e.jsx(v,{className:"text-right",children:t.leadsReceived}),e.jsx(v,{className:"text-right",children:t.leadsConverted}),e.jsxs(v,{className:"text-right",children:[o.toFixed(1),"%"]}),e.jsx(v,{className:"text-right",children:t.paymentsProcessed}),e.jsx(v,{className:"text-right",children:C(t.paymentsAmount)}),e.jsx(v,{className:"text-right",children:C(t.commissionsEarned)})]},t.userId)})})]})}),e.jsx(be,{className:"justify-end",children:e.jsxs(Y,{variant:"outline",size:"sm",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Exporter CSV"]})})]})]}):e.jsx(x,{children:e.jsx(u,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Cs,{className:"h-10 w-10 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucune donnée disponible"}),e.jsx("p",{className:"text-muted-foreground",children:"Les statistiques globales seront disponibles dès que les utilisateurs auront de l'activité."})]})})})})]})]})})};export{Dt as default};
