import{c as F,r as i,aS as ot,aT as ue,j as a,J as z,R as Ne,B as H,al as Pt,y as Pr,M as Je,aB as Ot,a as It,aH as q,aP as Lt,aD as Ie,aF as G,aE as te,aI as N,aQ as ee,aR as Er,aU as Nr,aV as Le,aO as Qe,aG as Wt,aW as $t,aX as Ft,aY as Ht,aZ as qt,a_ as jr,a$ as kr,b0 as Yt,aN as _r,b1 as Rr,b2 as Dr,b3 as Ar,b4 as Or,b5 as Ir,b6 as Lr,b7 as Wr,b8 as Ut,C as $r,n as at,u as zt,l as Fr,x as Hr,b9 as qr}from"./index-CpDjrPge.js";import{a as We,u as Gt,S as Yr}from"./use-auth-Cwl-QG43.js";import{u as Bt,B as ve,c as Vt,I as Ur,R as zr}from"./use-mobile-BMh-vbEF.js";import{L as Gr}from"./log-out-CQjzW_NC.js";import{F as Br}from"./file-text-CPAW-xf3.js";import{C as Vr}from"./credit-card-dLoa9KgF.js";import{S as Xr}from"./settings-DcDHKTJ-.js";import{S as Xt}from"./separator-D63b-bg3.js";import{E as Kt}from"./external-link-CKWtTz9q.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=F("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=F("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=F("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=F("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=F("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=F("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=F("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=F("FileBox",[["path",{d:"M14.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"16lz6z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 13.1a2 2 0 0 0-1 1.76v3.24a2 2 0 0 0 .97 1.78L6 21.7a2 2 0 0 0 2.03.01L11 19.9a2 2 0 0 0 1-1.76V14.9a2 2 0 0 0-.97-1.78L8 11.3a2 2 0 0 0-2.03-.01Z",key:"99pj1s"}],["path",{d:"M7 17v5",key:"1yj1jh"}],["path",{d:"M11.7 14.2 7 17l-4.7-2.8",key:"1yk8tc"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=F("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=F("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=F("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=F("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=F("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=F("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function co(){const[e,n]=i.useState([]),[t,r]=i.useState(0),[o,s]=i.useState(!0),[c,u]=i.useState(null),l=i.useRef(null),f=i.useRef(!1),{data:d,isLoading:h,refetch:g}=We({queryKey:["/api/notifications/unread"],queryFn:ot({on401:"returnNull"}),staleTime:3*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchInterval:5*60*1e3}),b=i.useCallback(async w=>{var m;try{const p=localStorage.getItem("adminToken");if(!p)return;(await fetch(`/api/notifications/${w}/read`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},credentials:"include"})).ok&&(n(x=>x.map(C=>C.id===w?{...C,isRead:!0}:C)),r(x=>Math.max(0,x-1)),((m=l.current)==null?void 0:m.readyState)===WebSocket.OPEN&&l.current.send(JSON.stringify({type:"NOTIFICATION_READ",notificationId:w})))}catch(p){console.error("Erreur lors du marquage d'une notification comme lue:",p)}},[]),y=i.useCallback(async()=>{var w;try{const m=localStorage.getItem("adminToken");if(!m)return;(await fetch("/api/notifications/read-all",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},credentials:"include"})).ok&&(n(v=>v.map(x=>({...x,isRead:!0}))),r(0),((w=l.current)==null?void 0:w.readyState)===WebSocket.OPEN&&l.current.send(JSON.stringify({type:"ALL_NOTIFICATIONS_READ"})))}catch(m){console.error("Erreur lors du marquage de toutes les notifications comme lues:",m)}},[]),T=i.useCallback(()=>{try{const w=window.location.protocol==="https:"?"wss:":"ws:",m=window.location.host,p=localStorage.getItem("adminToken");if(!p){console.log("Pas de token pour la connexion WebSocket, abandon");return}const v=`${w}//${m}/ws?token=${p}`;l.current&&l.current.readyState!==WebSocket.CLOSED&&l.current.close(),l.current=new WebSocket(v),l.current.onopen=()=>{console.log("Connexion WebSocket établie"),window.__WS_ACTIVE=!0},l.current.onmessage=x=>{var C;try{const E=JSON.parse(x.data);if(E.type==="NOTIFICATION"){const R=E.notification;n(A=>[R,...A]),R.isRead||r(A=>A+1)}else if(E.type==="NOTIFICATION_UPDATE"){const R=E.notification;n(A=>A.map(k=>k.id===R.id?R:k)),E.unreadCountChanged&&r(E.unreadCount)}else E.type==="NOTIFICATION_COUNT"?r(E.count):E.type==="PING"&&((C=l.current)==null?void 0:C.readyState)===WebSocket.OPEN&&l.current.send(JSON.stringify({type:"PONG"}))}catch(E){console.error("Erreur lors du traitement d'un message WebSocket:",E)}},l.current.onclose=()=>{console.log("Connexion WebSocket fermée"),window.__WS_ACTIVE=!1,setTimeout(()=>{T()},5e3)},l.current.onerror=x=>{console.error("Erreur WebSocket:",x),window.__WS_ACTIVE=!1,u("Erreur de connexion au serveur de notifications")}}catch(w){console.error("Erreur lors de l'établissement de la connexion WebSocket:",w),window.__WS_ACTIVE=!1}},[]);return i.useEffect(()=>{if(d&&!f.current){if(d.notifications&&Array.isArray(d.notifications)){n(d.notifications);const w=d.notifications.filter(m=>!m.isRead);r(w.length)}s(!1),f.current=!0}},[d]),i.useEffect(()=>(T(),()=>{l.current&&(l.current.close(),window.__WS_ACTIVE=!1)}),[T]),i.useEffect(()=>{const w=setInterval(()=>{!window.__WS_ACTIVE&&document.visibilityState==="visible"&&g()},18e4);return()=>clearInterval(w)},[g]),{notifications:e,unreadCount:t,loading:o,error:c,markAsRead:b,markAllAsRead:y,refetch:g}}function lo(){const[e,n]=i.useState(()=>{try{const u=sessionStorage.getItem("contacts_unread_count");return u?parseInt(u,10):0}catch{return 0}}),t=i.useCallback(u=>{try{sessionStorage.setItem("contacts_unread_count",u.toString()),sessionStorage.setItem("contacts_last_check",new Date().getTime().toString())}catch{}},[]),r=i.useCallback(()=>{try{const u=sessionStorage.getItem("contacts_last_check");if(!u)return!0;const l=new Date().getTime(),f=parseInt(u,10);return l-f>12e4}catch{return!0}},[]),{data:o,isLoading:s,error:c}=We({queryKey:["/api/contacts/unread-count"],queryFn:ot({on401:"returnNull"}),refetchInterval:5*60*1e3,staleTime:3*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,enabled:r()});return i.useEffect(()=>{o&&typeof o=="object"&&"count"in o&&typeof o.count=="number"&&(n(o.count),t(o.count))},[o,t]),i.useEffect(()=>{if(!window.__WS_ACTIVE){const l=setInterval(()=>{r()&&document.visibilityState==="visible"&&fetch(`/api/contacts/unread-count?_t=${new Date().getTime()}`,{credentials:"include",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Cache-Control":"no-cache"}}).then(f=>f.json()).then(f=>{f&&typeof f.count=="number"&&(n(f.count),t(f.count))}).catch(f=>{console.error("Erreur lors du rafraîchissement du compteur de contacts:",{})})},3e5);return()=>clearInterval(l)}},[r,t]),{unreadCount:e,isLoading:s,error:c}}function uo({className:e,activePath:n}){var T,w,m,p;const[t,r]=i.useState(!1),{user:o}=Gt();(T=o==null?void 0:o.role)!=null&&T.toLowerCase();const s=((w=o==null?void 0:o.role)==null?void 0:w.toLowerCase())===ue.ADMIN.toLowerCase(),c=((m=o==null?void 0:o.role)==null?void 0:m.toLowerCase())===ue.MANAGER.toLowerCase(),u=((p=o==null?void 0:o.role)==null?void 0:p.toLowerCase())===ue.AGENT.toLowerCase();console.log("SideNav - Données utilisateur:",{id:o==null?void 0:o.id,username:o==null?void 0:o.username,role:o==null?void 0:o.role,isAdmin:s,isManager:c,isAgent:u,permissions:o==null?void 0:o.permissions});const{unreadCount:l}=co(),{unreadCount:f}=lo();Bt();const d=v=>{const x=`permission_${o==null?void 0:o.id}_${v}`,C=sessionStorage.getItem(x);if(C)return C==="true";if(!o||!o.id||!o.role)return!1;const E=o.role.toLowerCase(),R=E===ue.ADMIN.toLowerCase(),A=E===ue.AGENT.toLowerCase(),k=E===ue.MANAGER.toLowerCase();let _=!1;if(R)_=!0;else if(Array.isArray(o.permissions)&&o.permissions.length>0){const I=o.permissions.find(V=>V.page===v);I?_=I.canView===!0:A?_=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts"].includes(v):k&&(_=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts","notifications","paiements"].includes(v))}else A?_=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts"].includes(v):k&&(_=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts","notifications","paiements"].includes(v));try{sessionStorage.setItem(x,_.toString())}catch{}return _},h=()=>[{label:"Tableau de bord",path:"/admin/dashboard",page:"dashboard",icon:no,badge:null},{label:"Demandes",path:"/admin/demandes",page:"demandes",icon:Br,badge:null},{label:"Paiements",path:"/admin/paiements",page:"paiements",icon:Vr,badge:null},{label:"Terminal de paiement",path:"/admin/terminal-paiement",page:"paiements",icon:ao,badge:null},{label:"Débogage paiements",path:"/payment-debug",page:"paiements",icon:Kr,badge:null},{label:"Statistiques",path:"/admin/user-statistics",page:"dashboard",icon:Qr,badge:null}].filter(x=>d(x.page)),g=()=>[{label:"Clients",path:"/admin/clients",page:"clients",icon:Pt,badge:null},{label:"Leads",path:"/admin/leads",page:"leads",icon:io,badge:null},{label:"Rendez-vous",path:"/admin/rendez-vous",page:"rendez-vous",icon:Pr,badge:null},{label:"Contacts",path:"/admin/contacts",page:"contacts",icon:Je,badge:f||null},{label:"Mail",path:"/admin/mail",page:"emails",icon:Je,badge:null}].filter(x=>d(x.page)),b=()=>[{label:"Utilisateurs",path:"/admin/users",page:"users",icon:Pt,badge:null},{label:"Paramètres",path:"/admin/settings",page:"settings",icon:Xr,badge:null},{label:"Animations",path:"/admin/animations",page:"animations",icon:Yr,badge:null},{label:"Config SMTP",path:"/admin/smtp",page:"emails",icon:ro,badge:null},{label:"Google Snippets",path:"/admin/google-snippets",page:"settings",icon:eo,badge:null},{label:"Performance",path:"/admin/performance-monitor",page:"settings",icon:Jr,badge:null},{label:"Test Notifications",path:"/admin/notification-tests",page:"settings",icon:Ze,badge:null},{label:"Notifications",path:"/admin/notifications",page:"notifications",icon:Ze,badge:l||null}].filter(x=>d(x.page));let y=[{title:"Général",items:h()},{title:"Gestion",items:g()}];return s&&y.push({title:"Administration",items:b()}),a.jsx("div",{className:z("pb-12 h-full overflow-hidden flex flex-col",e),children:a.jsxs("div",{className:"space-y-4 py-4 flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:[a.jsx("div",{className:"px-4 py-2",children:a.jsx("div",{className:"flex items-center justify-between space-x-2",children:a.jsxs("h2",{className:"text-lg font-semibold tracking-tight",children:[a.jsx("span",{className:"text-[#33b060]",children:"Services"})," ",a.jsx("span",{className:"text-[#2e3d96]",children:"Enedis"})]})})}),y.filter(v=>v.items.length>0).map((v,x)=>a.jsxs("div",{className:"px-3 py-2",children:[a.jsx("h2",{className:"mb-2 px-4 text-lg font-semibold tracking-tight",children:v.title}),a.jsx("div",{className:"space-y-1",children:v.items.map((C,E)=>a.jsx(Ne,{href:C.path,children:a.jsxs(H,{variant:n===C.path?"secondary":"ghost",className:"w-full justify-start",children:[a.jsx(C.icon,{className:"mr-2 h-4 w-4"}),C.label,C.badge&&C.badge>0&&a.jsx(ve,{className:"ml-auto",variant:n===C.path?"default":"secondary",children:C.badge})]})},E))})]},x)),a.jsx("div",{className:"px-3 py-2",children:a.jsx("div",{className:"space-y-1",children:a.jsx(Ne,{href:"/logout",children:a.jsxs(H,{variant:"ghost",className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50",children:[a.jsx(Gr,{className:"mr-2 h-4 w-4"}),"Déconnexion"]})})})})]})})}const Qt=i.createContext(null);function mo({children:e}){const[n,t]=i.useState(!1),r=i.useRef(null),o=i.useRef(new Map),s=i.useRef(null),c=i.useRef(null),u=i.useRef(0),l=Ot(),{toast:f}=It(),d=5,h=3e3,g=i.useRef(!1),b=i.useCallback(()=>{if(g.current){console.log("WebSocket Provider: Connexion déjà en cours, ignorer cette tentative");return}g.current=!0;try{if(r.current&&r.current.readyState!==WebSocket.CLOSED&&r.current.close(),window.location.hostname.includes("replit")||window.location.hostname.includes("repl.co")){console.log("WebSocket Provider: Fonctionnalité désactivée pour Replit"),console.log("WebSocket: Fonctionnalité désactivée pour le site public"),console.log("WebSocket: Fonctionnalité désactivée"),console.log("WebSocket: Simulation d'abonnement aux données de type 'notifications'"),setTimeout(()=>{g.current=!1,t(!0)},500);return}else{const p=window.location.protocol==="https:"?"wss:":"ws:",v=window.location.host,x=`${p}//${v}/ws`,C=localStorage.getItem("auth_token"),E=Date.now();let R=`${x}?timestamp=${E}&client=webapp`;C&&(R+=`&token=${encodeURIComponent(C)}`),R+="&mode=optimized",console.log("WebSocket Provider: Connexion à",R),r.current=new WebSocket(R)}const m=setTimeout(()=>{r.current&&r.current.readyState!==WebSocket.OPEN&&(console.log("WebSocket Provider: Timeout de connexion, fermeture forcée"),r.current.close())},5e3);r.current.onopen=()=>{clearTimeout(m),g.current=!1,console.log("WebSocket Provider: Connexion centralisée établie"),t(!0),u.current=0,o.current.forEach((p,v)=>{p.length>0&&r.current&&r.current.readyState===WebSocket.OPEN&&(console.log(`WebSocket Provider: Abonnement au type ${v} via le système centralisé`),r.current.send(JSON.stringify({type:"subscribe",dataType:v})))}),c.current&&clearInterval(c.current),c.current=setInterval(()=>{r.current&&r.current.readyState===WebSocket.OPEN&&r.current.send(JSON.stringify({type:"ping",timestamp:new Date().toISOString()}))},3e4)},r.current.onmessage=p=>{try{const v=JSON.parse(p.data);if(v.type==="pong"){console.log("WebSocket Provider: Pong reçu");return}if(v.type==="notifications"){const x=o.current.get("notifications")||[];x.length>0&&x.forEach(C=>{C.queryKeysToInvalidate.forEach(E=>{l.invalidateQueries({queryKey:[E]})}),C.onNewData&&C.onNewData(v)})}else if(v.type==="NOTIFICATION_UPDATE"||v.type==="ALL_NOTIFICATIONS_READ"){console.log(`WebSocket Provider: Message ${v.type} reçu`);const x=o.current.get("notifications")||[];x.length>0&&x.forEach(C=>{C.queryKeysToInvalidate.forEach(E=>{l.invalidateQueries({queryKey:[E]})}),C.onNewData&&C.onNewData(v)})}else if(v.type.startsWith("new_")||v.type.startsWith("update_")){const x=v.type.split("_")[0],E=v.type.substring(x.length+1),R=o.current.get(E)||[];if(R.length===0)return;const A=E==="demandes"?"demande":E==="paiements"?"paiement":E.slice(0,-1),k=v[A];R.forEach(_=>{_.queryKeysToInvalidate.forEach(I=>{l.invalidateQueries({queryKey:[I]})}),_.onNewData&&_.onNewData(k)})}}catch(v){console.error("WebSocket Provider: Erreur lors du traitement du message",v)}},r.current.onclose=p=>{if(console.log(`WebSocket Provider: Connexion fermée (code: ${p.code})`),t(!1),c.current&&(clearInterval(c.current),c.current=null),s.current&&(clearTimeout(s.current),s.current=null),Array.from(o.current.values()).some(x=>x.length>0)&&u.current<d){const x=Math.min(h*Math.pow(1.5,u.current)+Math.random()*1e3,6e4);console.log(`WebSocket Provider: Tentative de reconnexion dans ${x/1e3}s (${u.current+1}/${d})`),u.current++,s.current=setTimeout(()=>{b()},x)}else u.current>=d&&(console.log("WebSocket Provider: Nombre maximum de tentatives de reconnexion atteint"),f({title:"Problème de connexion en temps réel",description:"Nous rencontrons des difficultés à maintenir une connexion en temps réel. Rechargez la page pour réessayer.",variant:"destructive"}))},r.current.onerror=p=>{console.error("WebSocket Provider: Erreur de connexion",p)}}catch(w){console.error("WebSocket Provider: Erreur lors de la création de la connexion",w),t(!1)}},[l,f]),y=i.useCallback(w=>{const{dataType:m}=w,p=o.current.get(m)||[];return p.push(w),o.current.set(m,p),p.length===1&&r.current&&r.current.readyState===WebSocket.OPEN&&r.current.send(JSON.stringify({type:"subscribe",dataType:m})),(!r.current||r.current.readyState===WebSocket.CLOSED||r.current.readyState===WebSocket.CLOSING)&&b(),()=>{const x=(o.current.get(m)||[]).filter(C=>C!==w);x.length===0?(o.current.delete(m),r.current&&r.current.readyState===WebSocket.OPEN&&r.current.send(JSON.stringify({type:"unsubscribe",dataType:m})),!Array.from(o.current.values()).some(E=>E.length>0)&&r.current&&r.current.close()):o.current.set(m,x)}},[b]);i.useEffect(()=>()=>{s.current&&clearTimeout(s.current),c.current&&clearInterval(c.current),r.current&&r.current.close()},[]);const T=i.useCallback(()=>(console.log("WebSocket Provider: Reconnexion manuelle initiée"),u.current=0,s.current&&(clearTimeout(s.current),s.current=null),b(),!0),[b]);return a.jsx(Qt.Provider,{value:{isConnected:n,subscribe:y,reconnect:T},children:e})}function st(){const e=i.useContext(Qt);if(!e)throw new Error("useWebSocketContext doit être utilisé à l'intérieur d'un WebSocketProvider");return e}function re({dataType:e,queryKeysToInvalidate:n,onNewData:t}){const{isConnected:r,subscribe:o,reconnect:s}=st();return i.useEffect(()=>o({dataType:e,queryKeysToInvalidate:n,onNewData:t}),[e,o,...n]),{isConnected:r,reconnect:s}}function Zt(){const{isConnected:e}=st(),[n,t]=i.useState({emails:0,notifications:0}),[r,o]=i.useState([]),[s,c]=i.useState([]),{isConnected:u}=re({dataType:"notifications",queryKeysToInvalidate:["/api/notifications/unread","/api/notifications"],onNewData:m=>{m&&m.notification&&(o(p=>[m.notification,...p]),c(p=>[m.notification,...p]),t(p=>({...p,notifications:p.notifications+1})))}}),{isConnected:l}=re({dataType:"emails",queryKeysToInvalidate:["/api/email-unread-count"],onNewData:m=>{m&&typeof m.count=="number"&&t(p=>({...p,emails:m.count}))}}),{isConnected:f}=re({dataType:"leads",queryKeysToInvalidate:["/api/leads"]}),{isConnected:d}=re({dataType:"demandes",queryKeysToInvalidate:["/api/service-requests"]}),{isConnected:h}=re({dataType:"paiements",queryKeysToInvalidate:["/api/payments"]}),{isConnected:g}=re({dataType:"dashboard",queryKeysToInvalidate:["/api/dashboard"]}),{isConnected:b}=re({dataType:"performance",queryKeysToInvalidate:["/api/performance-metrics"]}),{isConnected:y}=re({dataType:"contacts",queryKeysToInvalidate:["/api/contacts"]}),T=()=>{o([]),t(m=>({...m,notifications:0}))};i.useEffect(()=>{fetch("/api/email-unread-count",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(m=>{if(!m.ok)throw m.status===401?new Error("not_authenticated"):new Error(`Erreur HTTP ${m.status}`);const p=m.headers.get("content-type");if(p&&p.includes("application/json"))return m.json();throw new Error("response_not_json")}).then(m=>{m&&typeof m.count=="number"&&t(p=>({...p,emails:m.count}))}).catch(m=>{if(m.message==="not_authenticated"||m.message==="response_not_json"){console.warn(`Emails: ${m.message}`);return}console.warn("Erreur lors du rafraîchissement du compteur d'emails:",m.message||"Erreur inconnue")}),fetch("/api/notifications/unread",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(m=>{if(!m.ok)throw m.status===401?new Error("not_authenticated"):new Error(`Erreur HTTP ${m.status}`);const p=m.headers.get("content-type");if(p&&p.includes("application/json"))return m.json();throw new Error("response_not_json")}).then(m=>{m&&Array.isArray(m)&&t(p=>({...p,notifications:m.length}))}).catch(m=>{if(m.message==="not_authenticated"||m.message==="response_not_json"){console.warn(`Notifications: ${m.message}`);return}console.warn("Erreur lors du rafraîchissement du compteur de notifications:",m.message||"Erreur inconnue")})},[]);const w=m=>{console.log(`Marquage de la notification ${m} comme lue - début de l'opération`),o(p=>p.filter(v=>v.id!==m)),c(p=>p.map(v=>v.id===m?{...v,read:!0}:v)),t(p=>({...p,notifications:Math.max(0,p.notifications-1)})),console.log(`Envoi de la requête API pour marquer la notification ${m} comme lue`),fetch(`/api/notifications/${m}/mark-read`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin"}).then(p=>{console.log(`Réponse de l'API pour marquer la notification ${m} comme lue: status=${p.status}`),!p.ok&&p.status!==401?console.warn(`Erreur HTTP ${p.status} lors du marquage de notification comme lue`):p.ok&&console.log(`Notification ${m} marquée comme lue avec succès`)}).catch(p=>{console.error("Erreur lors du marquage de la notification:",p.message||"Erreur inconnue")})};return i.useEffect(()=>{fetch("/api/notifications/unread",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(m=>{if(!m.ok)throw m.status===401?new Error("not_authenticated"):new Error(`Erreur HTTP ${m.status}`);const p=m.headers.get("content-type");if(p&&p.includes("application/json"))return m.json();throw new Error("response_not_json")}).then(m=>{if(m&&Array.isArray(m)){const p=m.map(v=>({...v,read:!1}));c(p)}}).catch(m=>{if(m.message==="not_authenticated"||m.message==="response_not_json"){console.warn(`Chargement notifications: ${m.message}`),c([]);return}console.warn("Erreur lors du chargement des notifications:",m.message||"Erreur inconnue"),c([])})},[]),{leads:{isConnected:f},demandes:{isConnected:d},paiements:{isConnected:h},emails:{isConnected:l},dashboard:{isConnected:g},performance:{isConnected:b},notifications:{isConnected:u,allNotifications:s,newNotifications:r,resetNewNotifications:T,markAsRead:w},contacts:{isConnected:y},unreadCounts:n}}function X(e){const n=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&n==="[object Date]"?new e.constructor(+e):typeof e=="number"||n==="[object Number]"||typeof e=="string"||n==="[object String]"?new Date(e):new Date(NaN)}function se(e,n){return e instanceof Date?new e.constructor(n):new Date(n)}const en=6048e5,fo=864e5,Zi=6e4,ec=36e5,tc=43200,nc=1440;let ho={};function $e(){return ho}function ye(e,n){var u,l,f,d;const t=$e(),r=(n==null?void 0:n.weekStartsOn)??((l=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((d=(f=t.locale)==null?void 0:f.options)==null?void 0:d.weekStartsOn)??0,o=X(e),s=o.getDay(),c=(s<r?7:0)+s-r;return o.setDate(o.getDate()-c),o.setHours(0,0,0,0),o}function je(e){return ye(e,{weekStartsOn:1})}function tn(e){const n=X(e),t=n.getFullYear(),r=se(e,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const o=je(r),s=se(e,0);s.setFullYear(t,0,4),s.setHours(0,0,0,0);const c=je(s);return n.getTime()>=o.getTime()?t+1:n.getTime()>=c.getTime()?t:t-1}function Et(e){const n=X(e);return n.setHours(0,0,0,0),n}function Nt(e){const n=X(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function po(e,n){const t=Et(e),r=Et(n),o=+t-Nt(t),s=+r-Nt(r);return Math.round((o-s)/fo)}function go(e){const n=tn(e),t=se(e,0);return t.setFullYear(n,0,4),t.setHours(0,0,0,0),je(t)}function wo(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function bo(e){if(!wo(e)&&typeof e!="number")return!1;const n=X(e);return!isNaN(Number(n))}function vo(e){const n=X(e),t=se(e,0);return t.setFullYear(n.getFullYear(),0,1),t.setHours(0,0,0,0),t}const yo={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xo=(e,n,t)=>{let r;const o=yo[e];return typeof o=="string"?r=o:n===1?r=o.one:r=o.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function me(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const So={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Co={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Mo={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},To={date:me({formats:So,defaultWidth:"full"}),time:me({formats:Co,defaultWidth:"full"}),dateTime:me({formats:Mo,defaultWidth:"full"})},Po={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Eo=(e,n,t,r)=>Po[e];function K(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let o;if(r==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,u=t!=null&&t.width?String(t.width):c;o=e.formattingValues[u]||e.formattingValues[c]}else{const c=e.defaultWidth,u=t!=null&&t.width?String(t.width):e.defaultWidth;o=e.values[u]||e.values[c]}const s=e.argumentCallback?e.argumentCallback(n):n;return o[s]}}const No={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jo={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ko={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_o={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ro={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Do={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Ao=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Oo={ordinalNumber:Ao,era:K({values:No,defaultWidth:"wide"}),quarter:K({values:jo,defaultWidth:"wide",argumentCallback:e=>e-1}),month:K({values:ko,defaultWidth:"wide"}),day:K({values:_o,defaultWidth:"wide"}),dayPeriod:K({values:Ro,defaultWidth:"wide",formattingValues:Do,defaultFormattingWidth:"wide"})};function J(e){return(n,t={})=>{const r=t.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=n.match(o);if(!s)return null;const c=s[0],u=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(u)?Lo(u,h=>h.test(c)):Io(u,h=>h.test(c));let f;f=e.valueCallback?e.valueCallback(l):l,f=t.valueCallback?t.valueCallback(f):f;const d=n.slice(c.length);return{value:f,rest:d}}}function Io(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function Lo(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function nn(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const o=r[0],s=n.match(e.parsePattern);if(!s)return null;let c=e.valueCallback?e.valueCallback(s[0]):s[0];c=t.valueCallback?t.valueCallback(c):c;const u=n.slice(o.length);return{value:c,rest:u}}}const Wo=/^(\d+)(th|st|nd|rd)?/i,$o=/\d+/i,Fo={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ho={any:[/^b/i,/^(a|c)/i]},qo={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Yo={any:[/1/i,/2/i,/3/i,/4/i]},Uo={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zo={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Go={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Bo={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Vo={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Xo={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ko={ordinalNumber:nn({matchPattern:Wo,parsePattern:$o,valueCallback:e=>parseInt(e,10)}),era:J({matchPatterns:Fo,defaultMatchWidth:"wide",parsePatterns:Ho,defaultParseWidth:"any"}),quarter:J({matchPatterns:qo,defaultMatchWidth:"wide",parsePatterns:Yo,defaultParseWidth:"any",valueCallback:e=>e+1}),month:J({matchPatterns:Uo,defaultMatchWidth:"wide",parsePatterns:zo,defaultParseWidth:"any"}),day:J({matchPatterns:Go,defaultMatchWidth:"wide",parsePatterns:Bo,defaultParseWidth:"any"}),dayPeriod:J({matchPatterns:Vo,defaultMatchWidth:"any",parsePatterns:Xo,defaultParseWidth:"any"})},Jo={code:"en-US",formatDistance:xo,formatLong:To,formatRelative:Eo,localize:Oo,match:Ko,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Qo(e){const n=X(e);return po(n,vo(n))+1}function Zo(e){const n=X(e),t=+je(n)-+go(n);return Math.round(t/en)+1}function rn(e,n){var d,h,g,b;const t=X(e),r=t.getFullYear(),o=$e(),s=(n==null?void 0:n.firstWeekContainsDate)??((h=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??o.firstWeekContainsDate??((b=(g=o.locale)==null?void 0:g.options)==null?void 0:b.firstWeekContainsDate)??1,c=se(e,0);c.setFullYear(r+1,0,s),c.setHours(0,0,0,0);const u=ye(c,n),l=se(e,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);const f=ye(l,n);return t.getTime()>=u.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function ea(e,n){var u,l,f,d;const t=$e(),r=(n==null?void 0:n.firstWeekContainsDate)??((l=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((d=(f=t.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??1,o=rn(e,n),s=se(e,0);return s.setFullYear(o,0,r),s.setHours(0,0,0,0),ye(s,n)}function ta(e,n){const t=X(e),r=+ye(t,n)-+ea(t,n);return Math.round(r/en)+1}function D(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const oe={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return D(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):D(t+1,2)},d(e,n){return D(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return D(e.getHours()%12||12,n.length)},H(e,n){return D(e.getHours(),n.length)},m(e,n){return D(e.getMinutes(),n.length)},s(e,n){return D(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),o=Math.trunc(r*Math.pow(10,t-3));return D(o,n.length)}},de={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},jt={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),o=r>0?r:1-r;return t.ordinalNumber(o,{unit:"year"})}return oe.y(e,n)},Y:function(e,n,t,r){const o=rn(e,r),s=o>0?o:1-o;if(n==="YY"){const c=s%100;return D(c,2)}return n==="Yo"?t.ordinalNumber(s,{unit:"year"}):D(s,n.length)},R:function(e,n){const t=tn(e);return D(t,n.length)},u:function(e,n){const t=e.getFullYear();return D(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return D(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return D(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return oe.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return D(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const o=ta(e,r);return n==="wo"?t.ordinalNumber(o,{unit:"week"}):D(o,n.length)},I:function(e,n,t){const r=Zo(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):D(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):oe.d(e,n)},D:function(e,n,t){const r=Qo(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):D(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const o=e.getDay(),s=(o-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(s);case"ee":return D(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(o,{width:"short",context:"formatting"});case"eeee":default:return t.day(o,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const o=e.getDay(),s=(o-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(s);case"cc":return D(s,n.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(o,{width:"narrow",context:"standalone"});case"cccccc":return t.day(o,{width:"short",context:"standalone"});case"cccc":default:return t.day(o,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),o=r===0?7:r;switch(n){case"i":return String(o);case"ii":return D(o,n.length);case"io":return t.ordinalNumber(o,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const o=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let o;switch(r===12?o=de.noon:r===0?o=de.midnight:o=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let o;switch(r>=17?o=de.evening:r>=12?o=de.afternoon:r>=4?o=de.morning:o=de.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return oe.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):oe.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):D(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):D(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):oe.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):oe.s(e,n)},S:function(e,n){return oe.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return _t(r);case"XXXX":case"XX":return ae(r);case"XXXXX":case"XXX":default:return ae(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return _t(r);case"xxxx":case"xx":return ae(r);case"xxxxx":case"xxx":default:return ae(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+kt(r,":");case"OOOO":default:return"GMT"+ae(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+kt(r,":");case"zzzz":default:return"GMT"+ae(r,":")}},t:function(e,n,t){const r=Math.trunc(e.getTime()/1e3);return D(r,n.length)},T:function(e,n,t){const r=e.getTime();return D(r,n.length)}};function kt(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),o=Math.trunc(r/60),s=r%60;return s===0?t+String(o):t+String(o)+n+D(s,2)}function _t(e,n){return e%60===0?(e>0?"-":"+")+D(Math.abs(e)/60,2):ae(e,n)}function ae(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),o=D(Math.trunc(r/60),2),s=D(r%60,2);return t+o+n+s}const Rt=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},on=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},na=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],o=t[2];if(!o)return Rt(e,n);let s;switch(r){case"P":s=n.dateTime({width:"short"});break;case"PP":s=n.dateTime({width:"medium"});break;case"PPP":s=n.dateTime({width:"long"});break;case"PPPP":default:s=n.dateTime({width:"full"});break}return s.replace("{{date}}",Rt(r,n)).replace("{{time}}",on(o,n))},ra={p:on,P:na},oa=/^D+$/,aa=/^Y+$/,sa=["D","DD","YY","YYYY"];function ia(e){return oa.test(e)}function ca(e){return aa.test(e)}function la(e,n,t){const r=ua(e,n,t);if(console.warn(r),sa.includes(e))throw new RangeError(r)}function ua(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const da=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ma=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,fa=/^'([^]*?)'?$/,ha=/''/g,pa=/[a-zA-Z]/;function ke(e,n,t){var d,h,g,b,y,T,w,m;const r=$e(),o=(t==null?void 0:t.locale)??r.locale??Jo,s=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((b=(g=r.locale)==null?void 0:g.options)==null?void 0:b.firstWeekContainsDate)??1,c=(t==null?void 0:t.weekStartsOn)??((T=(y=t==null?void 0:t.locale)==null?void 0:y.options)==null?void 0:T.weekStartsOn)??r.weekStartsOn??((m=(w=r.locale)==null?void 0:w.options)==null?void 0:m.weekStartsOn)??0,u=X(e);if(!bo(u))throw new RangeError("Invalid time value");let l=n.match(ma).map(p=>{const v=p[0];if(v==="p"||v==="P"){const x=ra[v];return x(p,o.formatLong)}return p}).join("").match(da).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const v=p[0];if(v==="'")return{isToken:!1,value:ga(p)};if(jt[v])return{isToken:!0,value:p};if(v.match(pa))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:p}});o.localize.preprocessor&&(l=o.localize.preprocessor(u,l));const f={firstWeekContainsDate:s,weekStartsOn:c,locale:o};return l.map(p=>{if(!p.isToken)return p.value;const v=p.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&ca(v)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&ia(v))&&la(v,n,String(e));const x=jt[v[0]];return x(u,v,o.localize,f)}).join("")}function ga(e){const n=e.match(fa);return n?n[1].replace(ha,"'"):e}const wa={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},ba=(e,n,t)=>{let r;const o=wa[e];return typeof o=="string"?r=o:n===1?r=o.one:r=o.other.replace("{{count}}",String(n)),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"dans "+r:"il y a "+r:r},va={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},ya={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},xa={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Sa={date:me({formats:va,defaultWidth:"full"}),time:me({formats:ya,defaultWidth:"full"}),dateTime:me({formats:xa,defaultWidth:"full"})},Ca={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},Ma=(e,n,t,r)=>Ca[e],Ta={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},Pa={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},Ea={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},Na={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},ja={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},ka=(e,n)=>{const t=Number(e),r=n==null?void 0:n.unit;if(t===0)return"0";const o=["year","week","hour","minute","second"];let s;return t===1?s=r&&o.includes(r)?"ère":"er":s="ème",t+s},_a=["MMM","MMMM"],Ra={preprocessor:(e,n)=>e.getDate()===1||!n.some(r=>r.isToken&&_a.includes(r.value))?n:n.map(r=>r.isToken&&r.value==="do"?{isToken:!0,value:"d"}:r),ordinalNumber:ka,era:K({values:Ta,defaultWidth:"wide"}),quarter:K({values:Pa,defaultWidth:"wide",argumentCallback:e=>e-1}),month:K({values:Ea,defaultWidth:"wide"}),day:K({values:Na,defaultWidth:"wide"}),dayPeriod:K({values:ja,defaultWidth:"wide"})},Da=/^(\d+)(ième|ère|ème|er|e)?/i,Aa=/\d+/i,Oa={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},Ia={any:[/^av/i,/^ap/i]},La={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},Wa={any:[/1/i,/2/i,/3/i,/4/i]},$a={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},Fa={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ha={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},qa={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},Ya={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},Ua={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},za={ordinalNumber:nn({matchPattern:Da,parsePattern:Aa,valueCallback:e=>parseInt(e)}),era:J({matchPatterns:Oa,defaultMatchWidth:"wide",parsePatterns:Ia,defaultParseWidth:"any"}),quarter:J({matchPatterns:La,defaultMatchWidth:"wide",parsePatterns:Wa,defaultParseWidth:"any",valueCallback:e=>e+1}),month:J({matchPatterns:$a,defaultMatchWidth:"wide",parsePatterns:Fa,defaultParseWidth:"any"}),day:J({matchPatterns:Ha,defaultMatchWidth:"wide",parsePatterns:qa,defaultParseWidth:"any"}),dayPeriod:J({matchPatterns:Ya,defaultMatchWidth:"any",parsePatterns:Ua,defaultParseWidth:"any"})},_e={code:"fr",formatDistance:ba,formatLong:Sa,formatRelative:Ma,localize:Ra,match:za,options:{weekStartsOn:1,firstWeekContainsDate:4}};function Ga(e,n){return i.useReducer((t,r)=>n[t][r]??t,e)}var it="ScrollArea",[an]=Ie(it),[Ba,B]=an(it),sn=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,type:r="hover",dir:o,scrollHideDelay:s=600,...c}=e,[u,l]=i.useState(null),[f,d]=i.useState(null),[h,g]=i.useState(null),[b,y]=i.useState(null),[T,w]=i.useState(null),[m,p]=i.useState(0),[v,x]=i.useState(0),[C,E]=i.useState(!1),[R,A]=i.useState(!1),k=q(n,I=>l(I)),_=Lt(o);return a.jsx(Ba,{scope:t,type:r,dir:_,scrollHideDelay:s,scrollArea:u,viewport:f,onViewportChange:d,content:h,onContentChange:g,scrollbarX:b,onScrollbarXChange:y,scrollbarXEnabled:C,onScrollbarXEnabledChange:E,scrollbarY:T,onScrollbarYChange:w,scrollbarYEnabled:R,onScrollbarYEnabledChange:A,onCornerWidthChange:p,onCornerHeightChange:x,children:a.jsx(G.div,{dir:_,...c,ref:k,style:{position:"relative","--radix-scroll-area-corner-width":m+"px","--radix-scroll-area-corner-height":v+"px",...e.style}})})});sn.displayName=it;var cn="ScrollAreaViewport",ln=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,children:r,nonce:o,...s}=e,c=B(cn,t),u=i.useRef(null),l=q(n,u,c.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),a.jsx(G.div,{"data-radix-scroll-area-viewport":"",...s,ref:l,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...e.style},children:a.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});ln.displayName=cn;var Q="ScrollAreaScrollbar",ct=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=B(Q,e.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:c}=o,u=e.orientation==="horizontal";return i.useEffect(()=>(u?s(!0):c(!0),()=>{u?s(!1):c(!1)}),[u,s,c]),o.type==="hover"?a.jsx(Va,{...r,ref:n,forceMount:t}):o.type==="scroll"?a.jsx(Xa,{...r,ref:n,forceMount:t}):o.type==="auto"?a.jsx(un,{...r,ref:n,forceMount:t}):o.type==="always"?a.jsx(lt,{...r,ref:n}):null});ct.displayName=Q;var Va=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=B(Q,e.__scopeScrollArea),[s,c]=i.useState(!1);return i.useEffect(()=>{const u=o.scrollArea;let l=0;if(u){const f=()=>{window.clearTimeout(l),c(!0)},d=()=>{l=window.setTimeout(()=>c(!1),o.scrollHideDelay)};return u.addEventListener("pointerenter",f),u.addEventListener("pointerleave",d),()=>{window.clearTimeout(l),u.removeEventListener("pointerenter",f),u.removeEventListener("pointerleave",d)}}},[o.scrollArea,o.scrollHideDelay]),a.jsx(te,{present:t||s,children:a.jsx(un,{"data-state":s?"visible":"hidden",...r,ref:n})})}),Xa=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=B(Q,e.__scopeScrollArea),s=e.orientation==="horizontal",c=He(()=>l("SCROLL_END"),100),[u,l]=Ga("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(u==="idle"){const f=window.setTimeout(()=>l("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(f)}},[u,o.scrollHideDelay,l]),i.useEffect(()=>{const f=o.viewport,d=s?"scrollLeft":"scrollTop";if(f){let h=f[d];const g=()=>{const b=f[d];h!==b&&(l("SCROLL"),c()),h=b};return f.addEventListener("scroll",g),()=>f.removeEventListener("scroll",g)}},[o.viewport,s,l,c]),a.jsx(te,{present:t||u!=="hidden",children:a.jsx(lt,{"data-state":u==="hidden"?"hidden":"visible",...r,ref:n,onPointerEnter:N(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:N(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),un=i.forwardRef((e,n)=>{const t=B(Q,e.__scopeScrollArea),{forceMount:r,...o}=e,[s,c]=i.useState(!1),u=e.orientation==="horizontal",l=He(()=>{if(t.viewport){const f=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;c(u?f:d)}},10);return fe(t.viewport,l),fe(t.content,l),a.jsx(te,{present:r||s,children:a.jsx(lt,{"data-state":s?"visible":"hidden",...o,ref:n})})}),lt=i.forwardRef((e,n)=>{const{orientation:t="vertical",...r}=e,o=B(Q,e.__scopeScrollArea),s=i.useRef(null),c=i.useRef(0),[u,l]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=pn(u.viewport,u.content),d={...r,sizes:u,onSizesChange:l,hasThumb:f>0&&f<1,onThumbChange:g=>s.current=g,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:g=>c.current=g};function h(g,b){return ts(g,c.current,u,b)}return t==="horizontal"?a.jsx(Ka,{...d,ref:n,onThumbPositionChange:()=>{if(o.viewport&&s.current){const g=o.viewport.scrollLeft,b=Dt(g,u,o.dir);s.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:g=>{o.viewport&&(o.viewport.scrollLeft=g)},onDragScroll:g=>{o.viewport&&(o.viewport.scrollLeft=h(g,o.dir))}}):t==="vertical"?a.jsx(Ja,{...d,ref:n,onThumbPositionChange:()=>{if(o.viewport&&s.current){const g=o.viewport.scrollTop,b=Dt(g,u);s.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:g=>{o.viewport&&(o.viewport.scrollTop=g)},onDragScroll:g=>{o.viewport&&(o.viewport.scrollTop=h(g))}}):null}),Ka=i.forwardRef((e,n)=>{const{sizes:t,onSizesChange:r,...o}=e,s=B(Q,e.__scopeScrollArea),[c,u]=i.useState(),l=i.useRef(null),f=q(n,l,s.onScrollbarXChange);return i.useEffect(()=>{l.current&&u(getComputedStyle(l.current))},[l]),a.jsx(mn,{"data-orientation":"horizontal",...o,ref:f,sizes:t,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Fe(t)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(s.viewport){const g=s.viewport.scrollLeft+d.deltaX;e.onWheelScroll(g),wn(g,h)&&d.preventDefault()}},onResize:()=>{l.current&&s.viewport&&c&&r({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:De(c.paddingLeft),paddingEnd:De(c.paddingRight)}})}})}),Ja=i.forwardRef((e,n)=>{const{sizes:t,onSizesChange:r,...o}=e,s=B(Q,e.__scopeScrollArea),[c,u]=i.useState(),l=i.useRef(null),f=q(n,l,s.onScrollbarYChange);return i.useEffect(()=>{l.current&&u(getComputedStyle(l.current))},[l]),a.jsx(mn,{"data-orientation":"vertical",...o,ref:f,sizes:t,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Fe(t)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(s.viewport){const g=s.viewport.scrollTop+d.deltaY;e.onWheelScroll(g),wn(g,h)&&d.preventDefault()}},onResize:()=>{l.current&&s.viewport&&c&&r({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:De(c.paddingTop),paddingEnd:De(c.paddingBottom)}})}})}),[Qa,dn]=an(Q),mn=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,sizes:r,hasThumb:o,onThumbChange:s,onThumbPointerUp:c,onThumbPointerDown:u,onThumbPositionChange:l,onDragScroll:f,onWheelScroll:d,onResize:h,...g}=e,b=B(Q,t),[y,T]=i.useState(null),w=q(n,k=>T(k)),m=i.useRef(null),p=i.useRef(""),v=b.viewport,x=r.content-r.viewport,C=ee(d),E=ee(l),R=He(h,10);function A(k){if(m.current){const _=k.clientX-m.current.left,I=k.clientY-m.current.top;f({x:_,y:I})}}return i.useEffect(()=>{const k=_=>{const I=_.target;(y==null?void 0:y.contains(I))&&C(_,x)};return document.addEventListener("wheel",k,{passive:!1}),()=>document.removeEventListener("wheel",k,{passive:!1})},[v,y,x,C]),i.useEffect(E,[r,E]),fe(y,R),fe(b.content,R),a.jsx(Qa,{scope:t,scrollbar:y,hasThumb:o,onThumbChange:ee(s),onThumbPointerUp:ee(c),onThumbPositionChange:E,onThumbPointerDown:ee(u),children:a.jsx(G.div,{...g,ref:w,style:{position:"absolute",...g.style},onPointerDown:N(e.onPointerDown,k=>{k.button===0&&(k.target.setPointerCapture(k.pointerId),m.current=y.getBoundingClientRect(),p.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),A(k))}),onPointerMove:N(e.onPointerMove,A),onPointerUp:N(e.onPointerUp,k=>{const _=k.target;_.hasPointerCapture(k.pointerId)&&_.releasePointerCapture(k.pointerId),document.body.style.webkitUserSelect=p.current,b.viewport&&(b.viewport.style.scrollBehavior=""),m.current=null})})})}),Re="ScrollAreaThumb",fn=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=dn(Re,e.__scopeScrollArea);return a.jsx(te,{present:t||o.hasThumb,children:a.jsx(Za,{ref:n,...r})})}),Za=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,style:r,...o}=e,s=B(Re,t),c=dn(Re,t),{onThumbPositionChange:u}=c,l=q(n,h=>c.onThumbChange(h)),f=i.useRef(void 0),d=He(()=>{f.current&&(f.current(),f.current=void 0)},100);return i.useEffect(()=>{const h=s.viewport;if(h){const g=()=>{if(d(),!f.current){const b=ns(h,u);f.current=b,u()}};return u(),h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[s.viewport,d,u]),a.jsx(G.div,{"data-state":c.hasThumb?"visible":"hidden",...o,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:N(e.onPointerDownCapture,h=>{const b=h.target.getBoundingClientRect(),y=h.clientX-b.left,T=h.clientY-b.top;c.onThumbPointerDown({x:y,y:T})}),onPointerUp:N(e.onPointerUp,c.onThumbPointerUp)})});fn.displayName=Re;var ut="ScrollAreaCorner",hn=i.forwardRef((e,n)=>{const t=B(ut,e.__scopeScrollArea),r=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&r?a.jsx(es,{...e,ref:n}):null});hn.displayName=ut;var es=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,...r}=e,o=B(ut,t),[s,c]=i.useState(0),[u,l]=i.useState(0),f=!!(s&&u);return fe(o.scrollbarX,()=>{var h;const d=((h=o.scrollbarX)==null?void 0:h.offsetHeight)||0;o.onCornerHeightChange(d),l(d)}),fe(o.scrollbarY,()=>{var h;const d=((h=o.scrollbarY)==null?void 0:h.offsetWidth)||0;o.onCornerWidthChange(d),c(d)}),f?a.jsx(G.div,{...r,ref:n,style:{width:s,height:u,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function De(e){return e?parseInt(e,10):0}function pn(e,n){const t=e/n;return isNaN(t)?0:t}function Fe(e){const n=pn(e.viewport,e.content),t=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-t)*n;return Math.max(r,18)}function ts(e,n,t,r="ltr"){const o=Fe(t),s=o/2,c=n||s,u=o-c,l=t.scrollbar.paddingStart+c,f=t.scrollbar.size-t.scrollbar.paddingEnd-u,d=t.content-t.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return gn([l,f],h)(e)}function Dt(e,n,t="ltr"){const r=Fe(n),o=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,s=n.scrollbar.size-o,c=n.content-n.viewport,u=s-r,l=t==="ltr"?[0,c]:[c*-1,0],f=Nr(e,l);return gn([0,c],[0,u])(f)}function gn(e,n){return t=>{if(e[0]===e[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(e[1]-e[0]);return n[0]+r*(t-e[0])}}function wn(e,n){return e>0&&e<n}var ns=(e,n=()=>{})=>{let t={left:e.scrollLeft,top:e.scrollTop},r=0;return function o(){const s={left:e.scrollLeft,top:e.scrollTop},c=t.left!==s.left,u=t.top!==s.top;(c||u)&&n(),t=s,r=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(r)};function He(e,n){const t=ee(e),r=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(r.current),[]),i.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(t,n)},[t,n])}function fe(e,n){const t=ee(n);Er(()=>{let r=0;if(e){const o=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return o.observe(e),()=>{window.cancelAnimationFrame(r),o.unobserve(e)}}},[e,t])}var bn=sn,rs=ln,os=hn;const dt=i.forwardRef(({className:e,children:n,...t},r)=>a.jsxs(bn,{ref:r,className:z("relative overflow-hidden",e),...t,children:[a.jsx(rs,{className:"h-full w-full rounded-[inherit]",children:n}),a.jsx(vn,{}),a.jsx(os,{})]}));dt.displayName=bn.displayName;const vn=i.forwardRef(({className:e,orientation:n="vertical",...t},r)=>a.jsx(ct,{ref:r,orientation:n,className:z("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...t,children:a.jsx(fn,{className:"relative flex-1 rounded-full bg-border"})}));vn.displayName=ct.displayName;var[qe]=Ie("Tooltip",[Le]),Ye=Le(),yn="TooltipProvider",as=700,et="tooltip.open",[ss,mt]=qe(yn),xn=e=>{const{__scopeTooltip:n,delayDuration:t=as,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:s}=e,c=i.useRef(!0),u=i.useRef(!1),l=i.useRef(0);return i.useEffect(()=>{const f=l.current;return()=>window.clearTimeout(f)},[]),a.jsx(ss,{scope:n,isOpenDelayedRef:c,delayDuration:t,onOpen:i.useCallback(()=>{window.clearTimeout(l.current),c.current=!1},[]),onClose:i.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>c.current=!0,r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:i.useCallback(f=>{u.current=f},[]),disableHoverableContent:o,children:s})};xn.displayName=yn;var xe="Tooltip",[is,Ue]=qe(xe),Sn=e=>{const{__scopeTooltip:n,children:t,open:r,defaultOpen:o,onOpenChange:s,disableHoverableContent:c,delayDuration:u}=e,l=mt(xe,e.__scopeTooltip),f=Ye(n),[d,h]=i.useState(null),g=Qe(),b=i.useRef(0),y=c??l.disableHoverableContent,T=u??l.delayDuration,w=i.useRef(!1),[m,p]=Wt({prop:r,defaultProp:o??!1,onChange:R=>{R?(l.onOpen(),document.dispatchEvent(new CustomEvent(et))):l.onClose(),s==null||s(R)},caller:xe}),v=i.useMemo(()=>m?w.current?"delayed-open":"instant-open":"closed",[m]),x=i.useCallback(()=>{window.clearTimeout(b.current),b.current=0,w.current=!1,p(!0)},[p]),C=i.useCallback(()=>{window.clearTimeout(b.current),b.current=0,p(!1)},[p]),E=i.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>{w.current=!0,p(!0),b.current=0},T)},[T,p]);return i.useEffect(()=>()=>{b.current&&(window.clearTimeout(b.current),b.current=0)},[]),a.jsx($t,{...f,children:a.jsx(is,{scope:n,contentId:g,open:m,stateAttribute:v,trigger:d,onTriggerChange:h,onTriggerEnter:i.useCallback(()=>{l.isOpenDelayedRef.current?E():x()},[l.isOpenDelayedRef,E,x]),onTriggerLeave:i.useCallback(()=>{y?C():(window.clearTimeout(b.current),b.current=0)},[C,y]),onOpen:x,onClose:C,disableHoverableContent:y,children:t})})};Sn.displayName=xe;var tt="TooltipTrigger",Cn=i.forwardRef((e,n)=>{const{__scopeTooltip:t,...r}=e,o=Ue(tt,t),s=mt(tt,t),c=Ye(t),u=i.useRef(null),l=q(n,u,o.onTriggerChange),f=i.useRef(!1),d=i.useRef(!1),h=i.useCallback(()=>f.current=!1,[]);return i.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),a.jsx(Ft,{asChild:!0,...c,children:a.jsx(G.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:l,onPointerMove:N(e.onPointerMove,g=>{g.pointerType!=="touch"&&!d.current&&!s.isPointerInTransitRef.current&&(o.onTriggerEnter(),d.current=!0)}),onPointerLeave:N(e.onPointerLeave,()=>{o.onTriggerLeave(),d.current=!1}),onPointerDown:N(e.onPointerDown,()=>{o.open&&o.onClose(),f.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:N(e.onFocus,()=>{f.current||o.onOpen()}),onBlur:N(e.onBlur,o.onClose),onClick:N(e.onClick,o.onClose)})})});Cn.displayName=tt;var cs="TooltipPortal",[rc,ls]=qe(cs,{forceMount:void 0}),he="TooltipContent",Mn=i.forwardRef((e,n)=>{const t=ls(he,e.__scopeTooltip),{forceMount:r=t.forceMount,side:o="top",...s}=e,c=Ue(he,e.__scopeTooltip);return a.jsx(te,{present:r||c.open,children:c.disableHoverableContent?a.jsx(Tn,{side:o,...s,ref:n}):a.jsx(us,{side:o,...s,ref:n})})}),us=i.forwardRef((e,n)=>{const t=Ue(he,e.__scopeTooltip),r=mt(he,e.__scopeTooltip),o=i.useRef(null),s=q(n,o),[c,u]=i.useState(null),{trigger:l,onClose:f}=t,d=o.current,{onPointerInTransitChange:h}=r,g=i.useCallback(()=>{u(null),h(!1)},[h]),b=i.useCallback((y,T)=>{const w=y.currentTarget,m={x:y.clientX,y:y.clientY},p=ps(m,w.getBoundingClientRect()),v=gs(m,p),x=ws(T.getBoundingClientRect()),C=vs([...v,...x]);u(C),h(!0)},[h]);return i.useEffect(()=>()=>g(),[g]),i.useEffect(()=>{if(l&&d){const y=w=>b(w,d),T=w=>b(w,l);return l.addEventListener("pointerleave",y),d.addEventListener("pointerleave",T),()=>{l.removeEventListener("pointerleave",y),d.removeEventListener("pointerleave",T)}}},[l,d,b,g]),i.useEffect(()=>{if(c){const y=T=>{const w=T.target,m={x:T.clientX,y:T.clientY},p=(l==null?void 0:l.contains(w))||(d==null?void 0:d.contains(w)),v=!bs(m,c);p?g():v&&(g(),f())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,d,c,f,g]),a.jsx(Tn,{...e,ref:s})}),[ds,ms]=qe(xe,{isInside:!1}),fs=jr("TooltipContent"),Tn=i.forwardRef((e,n)=>{const{__scopeTooltip:t,children:r,"aria-label":o,onEscapeKeyDown:s,onPointerDownOutside:c,...u}=e,l=Ue(he,t),f=Ye(t),{onClose:d}=l;return i.useEffect(()=>(document.addEventListener(et,d),()=>document.removeEventListener(et,d)),[d]),i.useEffect(()=>{if(l.trigger){const h=g=>{const b=g.target;b!=null&&b.contains(l.trigger)&&d()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,d]),a.jsx(Ht,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:h=>h.preventDefault(),onDismiss:d,children:a.jsxs(qt,{"data-state":l.stateAttribute,...f,...u,ref:n,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(fs,{children:r}),a.jsx(ds,{scope:t,isInside:!0,children:a.jsx(kr,{id:l.contentId,role:"tooltip",children:o||r})})]})})});Mn.displayName=he;var Pn="TooltipArrow",hs=i.forwardRef((e,n)=>{const{__scopeTooltip:t,...r}=e,o=Ye(t);return ms(Pn,t).isInside?null:a.jsx(Yt,{...o,...r,ref:n})});hs.displayName=Pn;function ps(e,n){const t=Math.abs(n.top-e.y),r=Math.abs(n.bottom-e.y),o=Math.abs(n.right-e.x),s=Math.abs(n.left-e.x);switch(Math.min(t,r,o,s)){case s:return"left";case o:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function gs(e,n,t=5){const r=[];switch(n){case"top":r.push({x:e.x-t,y:e.y+t},{x:e.x+t,y:e.y+t});break;case"bottom":r.push({x:e.x-t,y:e.y-t},{x:e.x+t,y:e.y-t});break;case"left":r.push({x:e.x+t,y:e.y-t},{x:e.x+t,y:e.y+t});break;case"right":r.push({x:e.x-t,y:e.y-t},{x:e.x-t,y:e.y+t});break}return r}function ws(e){const{top:n,right:t,bottom:r,left:o}=e;return[{x:o,y:n},{x:t,y:n},{x:t,y:r},{x:o,y:r}]}function bs(e,n){const{x:t,y:r}=e;let o=!1;for(let s=0,c=n.length-1;s<n.length;c=s++){const u=n[s],l=n[c],f=u.x,d=u.y,h=l.x,g=l.y;d>r!=g>r&&t<(h-f)*(r-d)/(g-d)+f&&(o=!o)}return o}function vs(e){const n=e.slice();return n.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),ys(n)}function ys(e){if(e.length<=1)return e.slice();const n=[];for(let r=0;r<e.length;r++){const o=e[r];for(;n.length>=2;){const s=n[n.length-1],c=n[n.length-2];if((s.x-c.x)*(o.y-c.y)>=(s.y-c.y)*(o.x-c.x))n.pop();else break}n.push(o)}n.pop();const t=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;t.length>=2;){const s=t[t.length-1],c=t[t.length-2];if((s.x-c.x)*(o.y-c.y)>=(s.y-c.y)*(o.x-c.x))t.pop();else break}t.push(o)}return t.pop(),n.length===1&&t.length===1&&n[0].x===t[0].x&&n[0].y===t[0].y?n:n.concat(t)}var xs=xn,Ss=Sn,Cs=Cn,En=Mn;const Nn=xs,Ms=Ss,Ee=Cs,be=i.forwardRef(({className:e,sideOffset:n=4,...t},r)=>a.jsx(En,{ref:r,sideOffset:n,className:z("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));be.displayName=En.displayName;const Ke=({children:e,content:n,position:t="top"})=>{const r=t==="top"?"top":t==="bottom"?"bottom":t==="left"?"left":"right";return a.jsx(Nn,{children:a.jsxs(Ms,{children:[a.jsx(Ee,{asChild:!0,children:a.jsx("span",{className:"cursor-help",children:e})}),a.jsx(be,{side:r,children:n})]})})};var nt=["Enter"," "],Ts=["ArrowDown","PageUp","Home"],jn=["ArrowUp","PageDown","End"],Ps=[...Ts,...jn],Es={ltr:[...nt,"ArrowRight"],rtl:[...nt,"ArrowLeft"]},Ns={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Te="Menu",[Se,js,ks]=_r(Te),[ie,kn]=Ie(Te,[ks,Le,Vt]),ze=Le(),_n=Vt(),[_s,ce]=ie(Te),[Rs,Pe]=ie(Te),Rn=e=>{const{__scopeMenu:n,open:t=!1,children:r,dir:o,onOpenChange:s,modal:c=!0}=e,u=ze(n),[l,f]=i.useState(null),d=i.useRef(!1),h=ee(s),g=Lt(o);return i.useEffect(()=>{const b=()=>{d.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>d.current=!1;return document.addEventListener("keydown",b,{capture:!0}),()=>{document.removeEventListener("keydown",b,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),a.jsx($t,{...u,children:a.jsx(_s,{scope:n,open:t,onOpenChange:h,content:l,onContentChange:f,children:a.jsx(Rs,{scope:n,onClose:i.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:g,modal:c,children:r})})})};Rn.displayName=Te;var Ds="MenuAnchor",ft=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e,o=ze(t);return a.jsx(Ft,{...o,...r,ref:n})});ft.displayName=Ds;var ht="MenuPortal",[As,Dn]=ie(ht,{forceMount:void 0}),An=e=>{const{__scopeMenu:n,forceMount:t,children:r,container:o}=e,s=ce(ht,n);return a.jsx(As,{scope:n,forceMount:t,children:a.jsx(te,{present:t||s.open,children:a.jsx(Rr,{asChild:!0,container:o,children:r})})})};An.displayName=ht;var U="MenuContent",[Os,pt]=ie(U),On=i.forwardRef((e,n)=>{const t=Dn(U,e.__scopeMenu),{forceMount:r=t.forceMount,...o}=e,s=ce(U,e.__scopeMenu),c=Pe(U,e.__scopeMenu);return a.jsx(Se.Provider,{scope:e.__scopeMenu,children:a.jsx(te,{present:r||s.open,children:a.jsx(Se.Slot,{scope:e.__scopeMenu,children:c.modal?a.jsx(Is,{...o,ref:n}):a.jsx(Ls,{...o,ref:n})})})})}),Is=i.forwardRef((e,n)=>{const t=ce(U,e.__scopeMenu),r=i.useRef(null),o=q(n,r);return i.useEffect(()=>{const s=r.current;if(s)return Dr(s)},[]),a.jsx(gt,{...e,ref:o,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:N(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),Ls=i.forwardRef((e,n)=>{const t=ce(U,e.__scopeMenu);return a.jsx(gt,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),Ws=Lr("MenuContent.ScrollLock"),gt=i.forwardRef((e,n)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:l,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:g,onDismiss:b,disableOutsideScroll:y,...T}=e,w=ce(U,t),m=Pe(U,t),p=ze(t),v=_n(t),x=js(t),[C,E]=i.useState(null),R=i.useRef(null),A=q(n,R,w.onContentChange),k=i.useRef(0),_=i.useRef(""),I=i.useRef(0),V=i.useRef(null),pe=i.useRef("right"),M=i.useRef(0),j=y?Ir:i.Fragment,P=y?{as:Ws,allowPinchZoom:!0}:void 0,W=S=>{var le,Mt;const O=_.current+S,Y=x().filter(Z=>!Z.disabled),ne=document.activeElement,Ve=(le=Y.find(Z=>Z.ref.current===ne))==null?void 0:le.textValue,Xe=Y.map(Z=>Z.textValue),Ct=Ks(Xe,O,Ve),ge=(Mt=Y.find(Z=>Z.textValue===Ct))==null?void 0:Mt.ref.current;(function Z(Tt){_.current=Tt,window.clearTimeout(k.current),Tt!==""&&(k.current=window.setTimeout(()=>Z(""),1e3))})(O),ge&&setTimeout(()=>ge.focus())};i.useEffect(()=>()=>window.clearTimeout(k.current),[]),Or();const $=i.useCallback(S=>{var Y,ne;return pe.current===((Y=V.current)==null?void 0:Y.side)&&Qs(S,(ne=V.current)==null?void 0:ne.area)},[]);return a.jsx(Os,{scope:t,searchRef:_,onItemEnter:i.useCallback(S=>{$(S)&&S.preventDefault()},[$]),onItemLeave:i.useCallback(S=>{var O;$(S)||((O=R.current)==null||O.focus(),E(null))},[$]),onTriggerLeave:i.useCallback(S=>{$(S)&&S.preventDefault()},[$]),pointerGraceTimerRef:I,onPointerGraceIntentChange:i.useCallback(S=>{V.current=S},[]),children:a.jsx(j,{...P,children:a.jsx(Wr,{asChild:!0,trapped:o,onMountAutoFocus:N(s,S=>{var O;S.preventDefault(),(O=R.current)==null||O.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:a.jsx(Ht,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:g,onDismiss:b,children:a.jsx(zr,{asChild:!0,...v,dir:m.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:E,onEntryFocus:N(l,S=>{m.isUsingKeyboardRef.current||S.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(qt,{role:"menu","aria-orientation":"vertical","data-state":Jn(w.open),"data-radix-menu-content":"",dir:m.dir,...p,...T,ref:A,style:{outline:"none",...T.style},onKeyDown:N(T.onKeyDown,S=>{const Y=S.target.closest("[data-radix-menu-content]")===S.currentTarget,ne=S.ctrlKey||S.altKey||S.metaKey,Ve=S.key.length===1;Y&&(S.key==="Tab"&&S.preventDefault(),!ne&&Ve&&W(S.key));const Xe=R.current;if(S.target!==Xe||!Ps.includes(S.key))return;S.preventDefault();const ge=x().filter(le=>!le.disabled).map(le=>le.ref.current);jn.includes(S.key)&&ge.reverse(),Vs(ge)}),onBlur:N(e.onBlur,S=>{S.currentTarget.contains(S.target)||(window.clearTimeout(k.current),_.current="")}),onPointerMove:N(e.onPointerMove,Ce(S=>{const O=S.target,Y=M.current!==S.clientX;if(S.currentTarget.contains(O)&&Y){const ne=S.clientX>M.current?"right":"left";pe.current=ne,M.current=S.clientX}}))})})})})})})});On.displayName=U;var $s="MenuGroup",wt=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return a.jsx(G.div,{role:"group",...r,ref:n})});wt.displayName=$s;var Fs="MenuLabel",In=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return a.jsx(G.div,{...r,ref:n})});In.displayName=Fs;var Ae="MenuItem",At="menu.itemSelect",Ge=i.forwardRef((e,n)=>{const{disabled:t=!1,onSelect:r,...o}=e,s=i.useRef(null),c=Pe(Ae,e.__scopeMenu),u=pt(Ae,e.__scopeMenu),l=q(n,s),f=i.useRef(!1),d=()=>{const h=s.current;if(!t&&h){const g=new CustomEvent(At,{bubbles:!0,cancelable:!0});h.addEventListener(At,b=>r==null?void 0:r(b),{once:!0}),Ar(h,g),g.defaultPrevented?f.current=!1:c.onClose()}};return a.jsx(Ln,{...o,ref:l,disabled:t,onClick:N(e.onClick,d),onPointerDown:h=>{var g;(g=e.onPointerDown)==null||g.call(e,h),f.current=!0},onPointerUp:N(e.onPointerUp,h=>{var g;f.current||(g=h.currentTarget)==null||g.click()}),onKeyDown:N(e.onKeyDown,h=>{const g=u.searchRef.current!=="";t||g&&h.key===" "||nt.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Ge.displayName=Ae;var Ln=i.forwardRef((e,n)=>{const{__scopeMenu:t,disabled:r=!1,textValue:o,...s}=e,c=pt(Ae,t),u=_n(t),l=i.useRef(null),f=q(n,l),[d,h]=i.useState(!1),[g,b]=i.useState("");return i.useEffect(()=>{const y=l.current;y&&b((y.textContent??"").trim())},[s.children]),a.jsx(Se.ItemSlot,{scope:t,disabled:r,textValue:o??g,children:a.jsx(Ur,{asChild:!0,...u,focusable:!r,children:a.jsx(G.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:f,onPointerMove:N(e.onPointerMove,Ce(y=>{r?c.onItemLeave(y):(c.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:N(e.onPointerLeave,Ce(y=>c.onItemLeave(y))),onFocus:N(e.onFocus,()=>h(!0)),onBlur:N(e.onBlur,()=>h(!1))})})})}),Hs="MenuCheckboxItem",Wn=i.forwardRef((e,n)=>{const{checked:t=!1,onCheckedChange:r,...o}=e;return a.jsx(Yn,{scope:e.__scopeMenu,checked:t,children:a.jsx(Ge,{role:"menuitemcheckbox","aria-checked":Oe(t)?"mixed":t,...o,ref:n,"data-state":vt(t),onSelect:N(o.onSelect,()=>r==null?void 0:r(Oe(t)?!0:!t),{checkForDefaultPrevented:!1})})})});Wn.displayName=Hs;var $n="MenuRadioGroup",[qs,Ys]=ie($n,{value:void 0,onValueChange:()=>{}}),Fn=i.forwardRef((e,n)=>{const{value:t,onValueChange:r,...o}=e,s=ee(r);return a.jsx(qs,{scope:e.__scopeMenu,value:t,onValueChange:s,children:a.jsx(wt,{...o,ref:n})})});Fn.displayName=$n;var Hn="MenuRadioItem",qn=i.forwardRef((e,n)=>{const{value:t,...r}=e,o=Ys(Hn,e.__scopeMenu),s=t===o.value;return a.jsx(Yn,{scope:e.__scopeMenu,checked:s,children:a.jsx(Ge,{role:"menuitemradio","aria-checked":s,...r,ref:n,"data-state":vt(s),onSelect:N(r.onSelect,()=>{var c;return(c=o.onValueChange)==null?void 0:c.call(o,t)},{checkForDefaultPrevented:!1})})})});qn.displayName=Hn;var bt="MenuItemIndicator",[Yn,Us]=ie(bt,{checked:!1}),Un=i.forwardRef((e,n)=>{const{__scopeMenu:t,forceMount:r,...o}=e,s=Us(bt,t);return a.jsx(te,{present:r||Oe(s.checked)||s.checked===!0,children:a.jsx(G.span,{...o,ref:n,"data-state":vt(s.checked)})})});Un.displayName=bt;var zs="MenuSeparator",zn=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return a.jsx(G.div,{role:"separator","aria-orientation":"horizontal",...r,ref:n})});zn.displayName=zs;var Gs="MenuArrow",Gn=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e,o=ze(t);return a.jsx(Yt,{...o,...r,ref:n})});Gn.displayName=Gs;var Bs="MenuSub",[oc,Bn]=ie(Bs),we="MenuSubTrigger",Vn=i.forwardRef((e,n)=>{const t=ce(we,e.__scopeMenu),r=Pe(we,e.__scopeMenu),o=Bn(we,e.__scopeMenu),s=pt(we,e.__scopeMenu),c=i.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:l}=s,f={__scopeMenu:e.__scopeMenu},d=i.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return i.useEffect(()=>d,[d]),i.useEffect(()=>{const h=u.current;return()=>{window.clearTimeout(h),l(null)}},[u,l]),a.jsx(ft,{asChild:!0,...f,children:a.jsx(Ln,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":o.contentId,"data-state":Jn(t.open),...e,ref:Ut(n,o.onTriggerChange),onClick:h=>{var g;(g=e.onClick)==null||g.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:N(e.onPointerMove,Ce(h=>{s.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!t.open&&!c.current&&(s.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),d()},100))})),onPointerLeave:N(e.onPointerLeave,Ce(h=>{var b,y;d();const g=(b=t.content)==null?void 0:b.getBoundingClientRect();if(g){const T=(y=t.content)==null?void 0:y.dataset.side,w=T==="right",m=w?-5:5,p=g[w?"left":"right"],v=g[w?"right":"left"];s.onPointerGraceIntentChange({area:[{x:h.clientX+m,y:h.clientY},{x:p,y:g.top},{x:v,y:g.top},{x:v,y:g.bottom},{x:p,y:g.bottom}],side:T}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(h),h.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:N(e.onKeyDown,h=>{var b;const g=s.searchRef.current!=="";e.disabled||g&&h.key===" "||Es[r.dir].includes(h.key)&&(t.onOpenChange(!0),(b=t.content)==null||b.focus(),h.preventDefault())})})})});Vn.displayName=we;var Xn="MenuSubContent",Kn=i.forwardRef((e,n)=>{const t=Dn(U,e.__scopeMenu),{forceMount:r=t.forceMount,...o}=e,s=ce(U,e.__scopeMenu),c=Pe(U,e.__scopeMenu),u=Bn(Xn,e.__scopeMenu),l=i.useRef(null),f=q(n,l);return a.jsx(Se.Provider,{scope:e.__scopeMenu,children:a.jsx(te,{present:r||s.open,children:a.jsx(Se.Slot,{scope:e.__scopeMenu,children:a.jsx(gt,{id:u.contentId,"aria-labelledby":u.triggerId,...o,ref:f,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;c.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:N(e.onFocusOutside,d=>{d.target!==u.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:N(e.onEscapeKeyDown,d=>{c.onClose(),d.preventDefault()}),onKeyDown:N(e.onKeyDown,d=>{var b;const h=d.currentTarget.contains(d.target),g=Ns[c.dir].includes(d.key);h&&g&&(s.onOpenChange(!1),(b=u.trigger)==null||b.focus(),d.preventDefault())})})})})})});Kn.displayName=Xn;function Jn(e){return e?"open":"closed"}function Oe(e){return e==="indeterminate"}function vt(e){return Oe(e)?"indeterminate":e?"checked":"unchecked"}function Vs(e){const n=document.activeElement;for(const t of e)if(t===n||(t.focus(),document.activeElement!==n))return}function Xs(e,n){return e.map((t,r)=>e[(n+r)%e.length])}function Ks(e,n,t){const o=n.length>1&&Array.from(n).every(f=>f===n[0])?n[0]:n,s=t?e.indexOf(t):-1;let c=Xs(e,Math.max(s,0));o.length===1&&(c=c.filter(f=>f!==t));const l=c.find(f=>f.toLowerCase().startsWith(o.toLowerCase()));return l!==t?l:void 0}function Js(e,n){const{x:t,y:r}=e;let o=!1;for(let s=0,c=n.length-1;s<n.length;c=s++){const u=n[s],l=n[c],f=u.x,d=u.y,h=l.x,g=l.y;d>r!=g>r&&t<(h-f)*(r-d)/(g-d)+f&&(o=!o)}return o}function Qs(e,n){if(!n)return!1;const t={x:e.clientX,y:e.clientY};return Js(t,n)}function Ce(e){return n=>n.pointerType==="mouse"?e(n):void 0}var Zs=Rn,ei=ft,ti=An,ni=On,ri=wt,oi=In,ai=Ge,si=Wn,ii=Fn,ci=qn,li=Un,ui=zn,di=Gn,mi=Vn,fi=Kn,Be="DropdownMenu",[hi]=Ie(Be,[kn]),L=kn(),[pi,Qn]=hi(Be),Zn=e=>{const{__scopeDropdownMenu:n,children:t,dir:r,open:o,defaultOpen:s,onOpenChange:c,modal:u=!0}=e,l=L(n),f=i.useRef(null),[d,h]=Wt({prop:o,defaultProp:s??!1,onChange:c,caller:Be});return a.jsx(pi,{scope:n,triggerId:Qe(),triggerRef:f,contentId:Qe(),open:d,onOpenChange:h,onOpenToggle:i.useCallback(()=>h(g=>!g),[h]),modal:u,children:a.jsx(Zs,{...l,open:d,onOpenChange:h,dir:r,modal:u,children:t})})};Zn.displayName=Be;var er="DropdownMenuTrigger",tr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...o}=e,s=Qn(er,t),c=L(t);return a.jsx(ei,{asChild:!0,...c,children:a.jsx(G.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:Ut(n,s.triggerRef),onPointerDown:N(e.onPointerDown,u=>{!r&&u.button===0&&u.ctrlKey===!1&&(s.onOpenToggle(),s.open||u.preventDefault())}),onKeyDown:N(e.onKeyDown,u=>{r||(["Enter"," "].includes(u.key)&&s.onOpenToggle(),u.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});tr.displayName=er;var gi="DropdownMenuPortal",nr=e=>{const{__scopeDropdownMenu:n,...t}=e,r=L(n);return a.jsx(ti,{...r,...t})};nr.displayName=gi;var rr="DropdownMenuContent",or=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Qn(rr,t),s=L(t),c=i.useRef(!1);return a.jsx(ni,{id:o.contentId,"aria-labelledby":o.triggerId,...s,...r,ref:n,onCloseAutoFocus:N(e.onCloseAutoFocus,u=>{var l;c.current||(l=o.triggerRef.current)==null||l.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:N(e.onInteractOutside,u=>{const l=u.detail.originalEvent,f=l.button===0&&l.ctrlKey===!0,d=l.button===2||f;(!o.modal||d)&&(c.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});or.displayName=rr;var wi="DropdownMenuGroup",ar=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(ri,{...o,...r,ref:n})});ar.displayName=wi;var bi="DropdownMenuLabel",sr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(oi,{...o,...r,ref:n})});sr.displayName=bi;var vi="DropdownMenuItem",ir=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(ai,{...o,...r,ref:n})});ir.displayName=vi;var yi="DropdownMenuCheckboxItem",cr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(si,{...o,...r,ref:n})});cr.displayName=yi;var xi="DropdownMenuRadioGroup",Si=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(ii,{...o,...r,ref:n})});Si.displayName=xi;var Ci="DropdownMenuRadioItem",lr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(ci,{...o,...r,ref:n})});lr.displayName=Ci;var Mi="DropdownMenuItemIndicator",ur=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(li,{...o,...r,ref:n})});ur.displayName=Mi;var Ti="DropdownMenuSeparator",dr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(ui,{...o,...r,ref:n})});dr.displayName=Ti;var Pi="DropdownMenuArrow",Ei=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(di,{...o,...r,ref:n})});Ei.displayName=Pi;var Ni="DropdownMenuSubTrigger",mr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(mi,{...o,...r,ref:n})});mr.displayName=Ni;var ji="DropdownMenuSubContent",fr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=L(t);return a.jsx(fi,{...o,...r,ref:n,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});fr.displayName=ji;var ki=Zn,_i=tr,Ri=nr,hr=or,Di=ar,pr=sr,gr=ir,wr=cr,br=lr,vr=ur,yr=dr,xr=mr,Sr=fr;const Cr=ki,Mr=_i,Tr=Di,Ai=i.forwardRef(({className:e,inset:n,children:t,...r},o)=>a.jsxs(xr,{ref:o,className:z("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",e),...r,children:[t,a.jsx($r,{className:"ml-auto"})]}));Ai.displayName=xr.displayName;const Oi=i.forwardRef(({className:e,...n},t)=>a.jsx(Sr,{ref:t,className:z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...n}));Oi.displayName=Sr.displayName;const yt=i.forwardRef(({className:e,sideOffset:n=4,...t},r)=>a.jsx(Ri,{children:a.jsx(hr,{ref:r,sideOffset:n,className:z("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...t})}));yt.displayName=hr.displayName;const Me=i.forwardRef(({className:e,inset:n,...t},r)=>a.jsx(gr,{ref:r,className:z("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",e),...t}));Me.displayName=gr.displayName;const Ii=i.forwardRef(({className:e,children:n,checked:t,...r},o)=>a.jsxs(wr,{ref:o,className:z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(vr,{children:a.jsx(at,{className:"h-4 w-4"})})}),n]}));Ii.displayName=wr.displayName;const Li=i.forwardRef(({className:e,children:n,...t},r)=>a.jsxs(br,{ref:r,className:z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(vr,{children:a.jsx(Zr,{className:"h-2 w-2 fill-current"})})}),n]}));Li.displayName=br.displayName;const xt=i.forwardRef(({className:e,inset:n,...t},r)=>a.jsx(pr,{ref:r,className:z("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",e),...t}));xt.displayName=pr.displayName;const St=i.forwardRef(({className:e,...n},t)=>a.jsx(yr,{ref:t,className:z("-mx-1 my-1 h-px bg-muted",e),...n}));St.displayName=yr.displayName;const rt="INBOX",ac="Sent",sc="Spam",Wi="Trash";function $i(e){const n=e||1,[t,r]=i.useState(()=>{try{const f=sessionStorage.getItem(`email_unread_${n}`);return f?parseInt(f,10):0}catch{return 0}}),o=i.useCallback(f=>{try{sessionStorage.setItem(`email_unread_${n}`,f.toString()),sessionStorage.setItem(`email_last_check_${n}`,new Date().getTime().toString())}catch{}},[n]),s=i.useCallback(()=>{try{const f=sessionStorage.getItem(`email_last_check_${n}`);if(!f)return!0;const d=new Date().getTime(),h=parseInt(f,10);return d-h>12e4}catch{return!0}},[n]),{data:c,isLoading:u,error:l}=We({queryKey:["/api/user-emails",n,rt],queryFn:ot({on401:"returnNull"}),refetchInterval:5*60*1e3,staleTime:3*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,enabled:s()});return i.useEffect(()=>{if(c&&typeof c=="object"&&"emails"in c&&Array.isArray(c.emails)){const f=c.emails.filter(d=>!d.isRead).length;r(f),o(f)}},[c,o]),i.useEffect(()=>{if(!window.__WS_ACTIVE){const d=setInterval(()=>{s()&&document.visibilityState==="visible"&&fetch(`/api/email-unread-count?userId=${n}&_t=${new Date().getTime()}`,{credentials:"include",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Cache-Control":"no-cache"}}).then(h=>h.json()).then(h=>{h&&typeof h.count=="number"&&(r(h.count),o(h.count))}).catch(h=>{console.error("Erreur lors du rafraîchissement du compteur d'emails:",{})})},3e5);return()=>clearInterval(d)}},[n,s,o]),{unreadCount:t,isLoading:u,error:l}}function Fi(){var V,pe;const e=Zt(),{toast:n}=It(),t=Ot(),[r,o]=zt(),s=((V=e.unreadCounts)==null?void 0:V.emails)||0,c=((pe=e.emails)==null?void 0:pe.isConnected)||!1,{unreadCount:u,isLoading:l}=$i(),[f,d]=i.useState(()=>{try{const M=sessionStorage.getItem("email_unread_count");return M?parseInt(M,10):0}catch{return 0}}),[h,g]=i.useState(!1),[b,y]=i.useState(!1),[T,w]=i.useState([]),m=s>0?s:u||f,{data:p,isLoading:v,refetch:x}=We({queryKey:["/api/user-emails/recent",1,rt],queryFn:async({queryKey:M})=>{const[j,P,W]=M;try{const $=await fetch(`/api/user-emails/recent?userId=${P}&mailbox=${W}&limit=10`);if(!$.ok){const O=sessionStorage.getItem("recent_emails");return O?JSON.parse(O):{emails:[]}}const S=await $.json();try{if(sessionStorage.setItem("recent_emails",JSON.stringify(S)),S.emails){const O=S.emails.filter(Y=>!Y.isRead).length;sessionStorage.setItem("email_unread_count",O.toString()),d(O)}}catch{}return S}catch($){console.error("Erreur lors du chargement des emails récents:",$);const S=sessionStorage.getItem("recent_emails");return S?JSON.parse(S):{emails:[]}}},refetchInterval:0,staleTime:2e4,gcTime:1e3*60*5,refetchOnWindowFocus:!1,enabled:b});i.useEffect(()=>{b&&(g(!0),x().then(()=>{g(!1)}))},[b,x]),i.useEffect(()=>{if(p&&typeof p=="object"&&"emails"in p&&Array.isArray(p.emails)){const M=p.emails.slice(0,10).map(P=>{var $;let W="Expéditeur inconnu";if(typeof P.from=="string")W=P.from;else if(($=P.from)!=null&&$.text)W=P.from.text;else if(Array.isArray(P.from)&&P.from.length>0){const S=P.from[0];S.name&&S.address?W=`${S.name} <${S.address}>`:S.address?W=S.address:S.name&&(W=S.name)}else typeof P.from=="object"&&P.from!==null&&(P.from.name&&P.from.address?W=`${P.from.name} <${P.from.address}>`:P.from.address?W=P.from.address:P.from.name&&(W=P.from.name));return{id:P.id||P.messageId,from:W,subject:P.subject||"Sans objet",preview:P.preview||(typeof P.text=="string"?P.text.substring(0,100):""),receivedAt:P.receivedAt||P.date,isRead:P.isRead||!1,hasAttachments:P.hasAttachments||!1,original:P}});w(M);const j=p.emails.filter(P=>!P.isRead).length;try{sessionStorage.setItem("email_unread_count",j.toString())}catch{}}},[p]);const C=async M=>{try{await fetch(`/api/emails/${M}/mark-read`,{method:"POST"}),w(j=>j.map(P=>P.id===M?{...P,isRead:!0}:P)),x(),t.invalidateQueries({queryKey:["/api/email-unread-count"]})}catch(j){console.error("Erreur lors du marquage de l'email comme lu:",j)}},E=async()=>{try{await fetch("/api/emails/mark-all-read",{method:"POST"}),w(M=>M.map(j=>({...j,isRead:!0}))),x(),t.invalidateQueries({queryKey:["/api/email-unread-count"]})}catch(M){console.error("Erreur lors du marquage des emails comme lus:",M)}},R=async M=>{try{await Fr("POST",`/api/emails/${M}/move`,{userId:1,messageId:M,destinationMailbox:Wi,sourceMailbox:rt}),w(j=>j.filter(P=>P.id!==M)),x(),t.invalidateQueries({queryKey:["/api/email-unread-count"]}),n({title:"Email déplacé",description:"L'email a été déplacé vers la corbeille",variant:"default"})}catch(j){console.error("Erreur lors du déplacement de l'email:",j),n({title:"Erreur",description:"Impossible de déplacer l'email vers la corbeille",variant:"destructive"})}},A=M=>{if(!M.original){n({title:"Erreur",description:"Impossible de répondre à cet email, données manquantes",variant:"destructive"});return}try{sessionStorage.setItem("reply_to_email",JSON.stringify(M.original)),y(!1),o("/admin/emails")}catch(j){console.error("Erreur lors de la préparation de la réponse:",j),n({title:"Erreur",description:"Impossible de préparer la réponse à cet email",variant:"destructive"})}},k=M=>{try{const j=new Date(M),P=new Date;return j.getDate()===P.getDate()&&j.getMonth()===P.getMonth()&&j.getFullYear()===P.getFullYear()?ke(j,"HH'h'mm",{locale:_e}):ke(j,"d MMM, HH'h'mm",{locale:_e})}catch{return M}},_=M=>{try{const j=M.match(/(.*)<(.*)>/);return j&&j[1].trim()?j[1].trim():M}catch{return M}},I=!c&&l&&v;return a.jsxs(Cr,{open:b,onOpenChange:y,children:[a.jsx(Mr,{asChild:!0,children:a.jsxs(H,{variant:"ghost",size:"icon",className:"relative",onClick:()=>y(!b),children:[a.jsx(Je,{className:`h-5 w-5 ${m>0?"text-green-500 animate-pulse":I?"text-gray-400":""}`}),m>0&&a.jsx(ve,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center",children:m})]})}),a.jsxs(yt,{className:"w-80",align:"end",children:[a.jsxs(xt,{className:"flex justify-between items-center",children:[a.jsxs("div",{children:["Emails ",m>0&&`(${m})`]}),m>0&&a.jsxs(H,{variant:"ghost",size:"sm",className:"h-8 text-xs py-1 px-2",onClick:()=>E(),children:[a.jsx(Jt,{className:"h-3 w-3 mr-1"})," Tout marquer comme lu"]})]}),a.jsx(St,{}),a.jsx(dt,{className:"h-[400px] overflow-auto",children:h?a.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Chargement des emails..."}):T.length===0?a.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Pas d'emails récents"}):a.jsxs(Tr,{children:[T.map(M=>a.jsxs("div",{children:[a.jsxs(Me,{className:`relative flex gap-3 p-3 ${M.isRead?"":"bg-blue-50"}`,children:[a.jsx("div",{className:"bg-blue-100 rounded-full p-2 h-10 w-10 flex items-center justify-center text-xl",children:"📨"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex justify-between items-start w-full",children:[a.jsx("div",{className:`text-sm ${M.isRead?"":"font-medium"}`,children:_(M.from)}),a.jsx("div",{className:"text-xs text-muted-foreground",children:k(M.receivedAt)})]}),a.jsx("p",{className:`text-sm ${M.isRead?"":"font-semibold"}`,children:M.subject}),a.jsx("p",{className:"text-xs text-muted-foreground pt-1 line-clamp-2",children:M.preview}),M.hasAttachments&&a.jsxs("div",{className:"mt-1 flex items-center",children:[a.jsx(to,{className:"h-3 w-3 text-blue-500 mr-1"}),a.jsx("span",{className:"text-xs text-blue-500",children:"Pièces jointes"})]})]}),a.jsx("div",{className:"absolute right-2 bottom-2 flex items-center space-x-1 opacity-0 group-hover:opacity-100 hover:opacity-100",children:a.jsxs(Nn,{children:[!M.isRead&&a.jsxs(Ke,{children:[a.jsx(Ee,{asChild:!0,children:a.jsx(H,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:j=>{j.stopPropagation(),C(M.id)},children:a.jsx(at,{className:"h-3 w-3"})})}),a.jsx(be,{side:"bottom",children:a.jsx("p",{children:"Marquer comme lu"})})]}),a.jsxs(Ke,{children:[a.jsx(Ee,{asChild:!0,children:a.jsx(H,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:j=>{j.stopPropagation(),A(M)},children:a.jsx(oo,{className:"h-3 w-3"})})}),a.jsx(be,{side:"bottom",children:a.jsx("p",{children:"Répondre"})})]}),a.jsxs(Ke,{children:[a.jsx(Ee,{asChild:!0,children:a.jsx(H,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:j=>{j.stopPropagation(),R(M.id)},children:a.jsx(so,{className:"h-3 w-3"})})}),a.jsx(be,{side:"bottom",children:a.jsx("p",{children:"Supprimer"})})]})]})}),a.jsx(H,{variant:"ghost",size:"sm",className:"absolute inset-0 opacity-0 cursor-pointer",onClick:j=>{j.stopPropagation(),o(`/admin/emails?view=${M.id}`),y(!1)},children:a.jsx("span",{className:"sr-only",children:"Ouvrir l'email"})})]}),a.jsx(Xt,{})]},M.id)),a.jsx(Me,{asChild:!0,className:"mt-2 text-center py-3 bg-gray-50 hover:bg-gray-100 flex justify-center items-center text-blue-600 gap-1 rounded-md mx-2",onClick:()=>y(!1),children:a.jsxs(Ne,{to:"/admin/emails",className:"flex items-center gap-1",children:[a.jsx("span",{children:"Voir tous les emails"}),a.jsx(Kt,{className:"h-3 w-3"})]})})]})})]})]})}function Hi(){var T;const e=Zt(),t=e.notifications||{},r=t.allNotifications||[],[o,s]=i.useState([]),[c,u]=i.useState(!1);i.useEffect(()=>{u(!0);const w=setTimeout(()=>{u(!1)},3e3);return(r.length>0||t.isConnected===!1)&&(u(!1),clearTimeout(w)),()=>clearTimeout(w)},[r.length,t.isConnected]),i.useEffect(()=>{r.length>0?(s(r),u(!1)):fetch("/api/notifications").then(w=>{if(!w.ok)throw w.status===401?new Error("Utilisateur non authentifié"):new Error(`Erreur HTTP: ${w.status}`);const m=w.headers.get("content-type");if(m&&m.includes("application/json"))return w.json();throw new Error("Réponse non-JSON reçue")}).then(w=>{Array.isArray(w)?s(w):w&&w.success===!1?(console.warn("Erreur API lors du chargement des notifications:",w.message||"Erreur inconnue"),s([])):(console.warn("Format de données incorrect pour les notifications"),s([]))}).catch(w=>{console.warn("Erreur lors du chargement des notifications:",w.message),s([])}).finally(()=>{u(!1)})},[r]);const l=w=>{t.markAsRead&&(t.markAsRead(w),s(m=>m.map(p=>p.id===w?{...p,read:!0}:p)))},f=()=>{console.log("Marquage de toutes les notifications comme lues - début de l'opération"),t.resetNewNotifications?(t.resetNewNotifications(),s(w=>w.map(m=>({...m,read:!0}))),console.log("Envoi de la requête API pour marquer toutes les notifications comme lues"),fetch("/api/notifications/mark-all-read",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin"}).then(w=>{console.log(`Réponse de l'API pour marquer toutes les notifications comme lues: status=${w.status}`),!w.ok&&w.status!==401?console.warn(`Erreur HTTP ${w.status} lors du marquage des notifications comme lues`):w.ok&&console.log("Toutes les notifications marquées comme lues avec succès")}).catch(w=>{console.error("Erreur lors du marquage des notifications:",w.message)})):console.warn("Impossible de marquer toutes les notifications comme lues - resetNewNotifications n'est pas disponible")},d=((T=e.unreadCounts)==null?void 0:T.notifications)||0,[h,g]=i.useState(!1),b=w=>{try{const m=new Date(w),p=new Date;return m.getDate()===p.getDate()&&m.getMonth()===p.getMonth()&&m.getFullYear()===p.getFullYear()?ke(m,"HH'h'mm",{locale:_e}):ke(m,"d MMM, HH'h'mm",{locale:_e})}catch{return w}},y=w=>{switch(w){case"payment":return{bg:"bg-green-50",icon:"💶"};case"lead":return{bg:"bg-blue-50",icon:"📊"};default:return{bg:"bg-gray-50",icon:"🔔"}}};return a.jsxs(Cr,{open:h,onOpenChange:g,children:[a.jsx(Mr,{asChild:!0,children:a.jsxs(H,{variant:"ghost",size:"icon",className:"relative",onClick:()=>g(!h),children:[a.jsx(Ze,{className:`h-5 w-5 ${d>0?"text-blue-500 animate-pulse":""}`}),d>0&&a.jsx(ve,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center",children:d})]})}),a.jsxs(yt,{className:"w-80",align:"end",children:[a.jsxs(xt,{className:"flex justify-between items-center",children:[a.jsxs("div",{children:["Notifications ",d>0&&`(${d})`]}),d>0&&a.jsxs(H,{variant:"ghost",size:"sm",className:"h-8 text-xs py-1 px-2",onClick:()=>f(),children:[a.jsx(Jt,{className:"h-3 w-3 mr-1"})," Tout marquer comme lu"]})]}),a.jsx(St,{}),a.jsx(dt,{className:"h-[400px] overflow-auto",children:c?a.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Chargement des notifications..."}):o.length===0?a.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Pas de notification pour le moment"}):a.jsxs(Tr,{children:[o.map(w=>{const{bg:m,icon:p}=y(w.type);return a.jsxs("div",{children:[a.jsxs(Me,{className:`flex gap-3 p-3 ${w.read?"":"bg-blue-50"}`,children:[a.jsx("div",{className:`${m} rounded-full p-2 h-10 w-10 flex items-center justify-center text-xl`,children:p}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex justify-between items-start w-full",children:[a.jsx("div",{className:"font-medium text-sm",children:w.title}),a.jsx("div",{className:"text-xs text-muted-foreground",children:b(w.time)})]}),a.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:w.message})]}),!w.read&&a.jsx(H,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-auto flex-shrink-0",onClick:v=>{v.stopPropagation(),l(w.id)},children:a.jsx(at,{className:"h-3 w-3"})})]}),a.jsx(Xt,{})]},w.id)}),a.jsx(Me,{asChild:!0,className:"mt-2 text-center py-3 bg-gray-50 hover:bg-gray-100 flex justify-center items-center text-blue-600 gap-1 rounded-md mx-2",onClick:()=>g(!1),children:a.jsxs(Ne,{to:"/admin/notifications",className:"flex items-center gap-1",children:[a.jsx("span",{children:"Voir toutes les notifications"}),a.jsx(Kt,{className:"h-3 w-3"})]})})]})})]})]})}function qi(){const{isConnected:e}=st();return e?a.jsxs(ve,{variant:"outline",className:"bg-green-50 text-green-700 hover:bg-green-100 border-green-200 gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),a.jsx("span",{className:"whitespace-nowrap",children:"Mises à jour en temps réel actives"})]}):a.jsxs(ve,{variant:"outline",className:"bg-amber-50 text-amber-700 hover:bg-amber-100 border-amber-200 gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 animate-pulse"}),a.jsx("span",{className:"whitespace-nowrap",children:"Connexion en cours..."})]})}function Yi(){const{user:e}=Gt(),[n,t]=i.useState(null);i.useEffect(()=>{const o=localStorage.getItem("adminUser");if(o)try{const c=JSON.parse(o);if(c&&(c.fullName||c.username)){const u=c.fullName||c.username||c.email||"Utilisateur";t(u)}}catch(c){console.error("Erreur lors de la lecture des données utilisateur du cache:",c)}async function s(){try{const c=localStorage.getItem("adminToken");if(!c)return;const u=await fetch("/api/user",{method:"GET",headers:{Authorization:`Bearer ${c}`},credentials:"include"});if(!u.ok)return;const l=await u.json();if(!l||!l.id)return;const f=l.fullName||l.username||l.email||"Utilisateur";t(f),localStorage.setItem("adminUser",JSON.stringify(l)),localStorage.setItem("lastUserCheck",new Date().getTime().toString())}catch(c){console.error("Erreur lors de la récupération de l'utilisateur:",c)}}s()},[]);const r=n||e&&(e.fullName||e.username||e.email)||"Utilisateur";return a.jsxs("span",{className:"text-sm text-gray-600 font-normal ml-2",children:["Bonjour ",a.jsx("span",{className:"text-blue-600 font-medium",children:r})]})}function ic({children:e,title:n="Tableau de bord",description:t}){const[r]=zt(),o=Bt(),[s,c]=i.useState(!o);return i.useEffect(()=>{c(!o)},[o]),i.useEffect(()=>{function u(){window.innerWidth<768?c(!1):c(!0)}return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[]),a.jsx(mo,{children:a.jsxs("div",{className:"flex h-screen bg-gray-50",children:[a.jsxs("div",{className:`fixed inset-y-0 z-50 flex w-72 flex-col bg-white transition-transform duration-300 ease-in-out md:relative md:translate-x-0 ${s?"translate-x-0":"-translate-x-full"}`,style:{height:"100vh"},children:[a.jsx(uo,{activePath:r}),o&&a.jsx(H,{variant:"ghost",size:"icon",className:"absolute right-2 top-2 h-8 w-8 rounded-full",onClick:()=>c(!1),children:a.jsx(Hr,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[a.jsxs("header",{className:"sticky top-0 z-10 flex h-16 items-center gap-2 md:gap-4 border-b bg-white px-3 md:px-6",children:[a.jsxs(H,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>c(!0),children:[a.jsx(qr,{className:"h-6 w-6"}),a.jsx("span",{className:"sr-only",children:"Toggle Menu"})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[" ",a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-lg font-semibold truncate",children:n}),a.jsx(Yi,{}),a.jsx("div",{className:"ml-2",children:a.jsx(qi,{})})]}),t&&a.jsx("p",{className:"text-sm text-gray-500 truncate hidden sm:block",children:t})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Hi,{}),a.jsx(Fi,{})]})]}),a.jsx("main",{className:"flex-1 overflow-y-auto px-3 py-4 md:px-6 md:py-6",children:e})]}),s&&o&&a.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:()=>c(!1)})]})})}export{ic as A,_e as B,Zr as C,Cr as D,Nn as E,Ee as F,be as G,nc as H,rt as I,tc as J,Jr as K,ec as L,ro as M,Zi as N,st as O,Qr as P,eo as Q,oo as R,ac as S,Wi as T,io as U,ye as a,$e as b,se as c,po as d,Jo as e,ke as f,Nt as g,vo as h,je as i,Zo as j,ta as k,wo as l,en as m,sc as n,so as o,Mr as p,yt as q,Me as r,Et as s,X as t,$i as u,St as v,dt as w,xt as x,Tr as y,Ke as z};
