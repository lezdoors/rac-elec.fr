import{r as v,j as e,B as k,ae as t,a6 as _}from"./index-CtI9_f3l.js";import{a as ee}from"./use-auth-DZJFHebW.js";import{C as x,a as u,b as h,c as q,d as p}from"./card-qGsq2vZt.js";import{T as se,a as te,b as ae,c as re}from"./tabs-fLE30lNc.js";import{S as ne,a as ie,d as le,b as de,c as g}from"./select-BPWiWZAy.js";import{C as B}from"./calendar-U6lWGmsj.js";import{P as E,a as I,b as U}from"./popover-Bii16twT.js";import{L as oe}from"./label-Do6r1Bqs.js";import{B as ce}from"./use-mobile-CqsOkNhC.js";import{A as me}from"./admin-layout-DqNbd7iv.js";import{C as V}from"./clock-CBCSOyre.js";import{C as z}from"./calendar-CnKzgrNk.js";import{F as N}from"./file-text-u97VJV6g.js";import{C as M}from"./credit-card-ClRQNtg8.js";import{C as Q}from"./circle-check-big-BFwvq5Tr.js";import{U as Y}from"./users-V-ayvxLX.js";import{R as xe}from"./refresh-cw-7p9b1IT4.js";import"./useMutation-Dnkxsn9W.js";import"./index-B6qX_rVB.js";import"./index-X7hvRruK.js";import"./index-CLT64vp6.js";import"./index-COG5zxgD.js";import"./index-C4BTlCvW.js";import"./chevron-down-Cd3y9YsB.js";import"./endOfMonth-YgcIzgnY.js";import"./isBefore-B4kOMf_l.js";import"./log-out-BrgV-bVq.js";import"./settings-CxpgQ106.js";import"./separator-DP0NmSu9.js";import"./check-BfI4DC2f.js";import"./external-link-Cvgvkj5c.js";function K(o){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(o)}function Qe(){var C,S,D,R,A,$,F,L,T;const[o,O]=v.useState({type:"today"}),[j,G]=v.useState(),[f,J]=v.useState(),W=()=>{const r=new Date,l=i=>{const a=i.getFullYear(),d=String(i.getMonth()+1).padStart(2,"0"),m=String(i.getDate()).padStart(2,"0");return`${a}-${d}-${m}`},n=l(r);switch(o.type){case"today":return{startDate:n,endDate:n};case"yesterday":const i=new Date(r);i.setDate(i.getDate()-1);const a=l(i);return{startDate:a,endDate:a};case"week":const d=new Date(r);return d.setDate(r.getDate()-r.getDay()),{startDate:l(d),endDate:n};case"month":const m=new Date(r.getFullYear(),r.getMonth(),1);return{startDate:l(m),endDate:n};case"custom":return{startDate:j?l(j):n,endDate:f?l(f):n};default:return{startDate:n,endDate:n}}},{startDate:y,endDate:b}=W(),{data:s,isLoading:X}=ee({queryKey:[`/api/dashboard/stats?startDate=${y}&endDate=${b}`],queryFn:_({on401:"throw"}),enabled:!!y&&!!b}),c=X,Z=()=>{var d,m,H,P;if(c)return"Chargement des données en cours...";const r=((d=s==null?void 0:s.payments)==null?void 0:d.count)||0,l=((m=s==null?void 0:s.payments)==null?void 0:m.revenue)||0,n=((H=s==null?void 0:s.leads)==null?void 0:H.count)||0,i=((P=s==null?void 0:s.requests)==null?void 0:P.count)||0;let a="";return r>0?a+=`${r} paiement${r>1?"s":""} RAC- pour ${K(l)}`:a+="Aucun paiement RAC-",a+=", ",n>0?a+=`${n} nouveau${n>1?"x":""} lead${n>1?"s":""}`:a+="aucun nouveau lead",a+=", ",i>0?a+=`${i} demande${i>1?"s":""} de service`:a+="aucune nouvelle demande",a+` ${w()}.`},w=()=>{switch(o.type){case"today":return"aujourd'hui";case"yesterday":return"hier";case"week":return"cette semaine";case"month":return"ce mois";case"custom":return"sur la période sélectionnée";default:return"aujourd'hui"}};return e.jsx(me,{children:e.jsxs("div",{className:"flex-1 space-y-4 p-4 md:p-8 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Tableau de bord"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(ce,{variant:"outline",className:"text-green-600 border-green-200",children:[e.jsx(V,{className:"mr-1 h-3 w-3"}),"Données RAC- en temps réel"]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(oe,{htmlFor:"date-filter",children:"Période :"}),e.jsxs(ne,{value:o.type,onValueChange:r=>O({type:r}),children:[e.jsx(ie,{className:"w-[180px]",children:e.jsx(le,{})}),e.jsxs(de,{children:[e.jsx(g,{value:"today",children:"Aujourd'hui"}),e.jsx(g,{value:"yesterday",children:"Hier"}),e.jsx(g,{value:"week",children:"Cette semaine"}),e.jsx(g,{value:"month",children:"Ce mois"}),e.jsx(g,{value:"custom",children:"Personnalisé"})]})]}),o.type==="custom"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(E,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:"w-[120px] justify-start text-left font-normal",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),j?j.toLocaleDateString():"Début"]})}),e.jsx(U,{className:"w-auto p-0",children:e.jsx(B,{mode:"single",selected:j,onSelect:G,initialFocus:!0})})]}),e.jsx("span",{children:"-"}),e.jsxs(E,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:"w-[120px] justify-start text-left font-normal",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),f?f.toLocaleDateString():"Fin"]})}),e.jsx(U,{className:"w-auto p-0",children:e.jsx(B,{mode:"single",selected:f,onSelect:J,initialFocus:!0})})]})]})]}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},children:e.jsxs(x,{className:"bg-gradient-to-br from-emerald-50 via-blue-50 to-indigo-50 border-0 shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-blue-200/20 to-emerald-200/20 rounded-full -translate-y-20 translate-x-20"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-purple-200/15 to-pink-200/15 rounded-full translate-y-16 -translate-x-16"}),e.jsx(u,{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(t.div,{className:"p-3 bg-gradient-to-br from-emerald-100 to-blue-100 rounded-xl shadow-md border border-white/50",whileHover:{scale:1.05,rotate:5},transition:{type:"spring",stiffness:300},children:e.jsx(N,{className:"h-6 w-6 text-emerald-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"text-xl font-bold bg-gradient-to-r from-emerald-700 to-blue-700 bg-clip-text text-transparent",children:"Résumé Intelligent"}),e.jsx(t.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"})})]}),e.jsxs(q,{className:"text-slate-600 flex items-center gap-2 mt-1",children:[e.jsx(V,{className:"h-3 w-3"}),"Données ",w()," - Références RAC- authentiques"]})]})]})}),e.jsx(p,{className:"relative z-10",children:e.jsx("div",{className:"bg-white/80 rounded-xl p-4 backdrop-blur-sm border border-white/60 shadow-sm",children:e.jsx("p",{className:"text-slate-800 font-semibold leading-relaxed",children:Z()})})})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},whileHover:{y:-5},children:e.jsxs(x,{className:"bg-gradient-to-br from-blue-50 to-cyan-50 border-blue-200 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(h,{className:"text-sm font-semibold text-blue-700",children:"Paiements RAC-"}),e.jsx(t.div,{whileHover:{scale:1.1,rotate:15},transition:{type:"spring",stiffness:300},className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(M,{className:"h-5 w-5 text-blue-600"})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-800 mb-1",children:c?e.jsx("div",{className:"animate-pulse bg-blue-200 h-8 w-8 rounded"}):e.jsx(t.span,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:.2},children:((C=s==null?void 0:s.payments)==null?void 0:C.count)||0})}),e.jsx("p",{className:"text-sm font-medium text-blue-600 mb-2",children:K(((S=s==null?void 0:s.payments)==null?void 0:S.revenue)||0)}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsxs("span",{className:"text-xs text-slate-600",children:[((D=s==null?void 0:s.payments)==null?void 0:D.successRate)||0,"% réussis"]})]})})]})]})}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},whileHover:{y:-5},children:e.jsxs(x,{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(h,{className:"text-sm font-semibold text-purple-700",children:"Leads"}),e.jsx(t.div,{whileHover:{scale:1.1,rotate:15},transition:{type:"spring",stiffness:300},className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Y,{className:"h-5 w-5 text-purple-600"})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-800 mb-1",children:c?e.jsx("div",{className:"animate-pulse bg-purple-200 h-8 w-8 rounded"}):e.jsx(t.span,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:.3},children:((R=s==null?void 0:s.leads)==null?void 0:R.count)||0})}),e.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Nouveaux prospects"})]})]})}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},whileHover:{y:-5},children:e.jsxs(x,{className:"bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(h,{className:"text-sm font-semibold text-orange-700",children:"Demandes"}),e.jsx(t.div,{whileHover:{scale:1.1,rotate:15},transition:{type:"spring",stiffness:300},className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(N,{className:"h-5 w-5 text-orange-600"})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-3xl font-bold text-orange-800 mb-1",children:c?e.jsx("div",{className:"animate-pulse bg-orange-200 h-8 w-8 rounded"}):e.jsx(t.span,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:.4},children:((A=s==null?void 0:s.requests)==null?void 0:A.count)||0})}),e.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Demandes de service"})]})]})}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3},whileHover:{y:-5},children:e.jsxs(x,{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(h,{className:"text-sm font-semibold text-green-700",children:"Taux de réussite"}),e.jsx(t.div,{whileHover:{scale:1.1,rotate:15},transition:{type:"spring",stiffness:300},className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-green-600"})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-800 mb-1",children:c?e.jsx("div",{className:"animate-pulse bg-green-200 h-8 w-8 rounded"}):e.jsxs(t.span,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:.5},children:[(($=s==null?void 0:s.payments)==null?void 0:$.successRate)||0,"%"]})}),e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Paiements réussis"})]})]})})]}),e.jsxs(se,{defaultValue:"payments",className:"space-y-4",children:[e.jsx(te,{children:e.jsx(ae,{value:"payments",children:"Activité récente"})}),e.jsx(re,{value:"payments",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(u,{children:[e.jsx(h,{children:"Activité récente"}),e.jsx(q,{children:"Aperçu des dernières activités RAC- sur votre plateforme"})]}),e.jsx(p,{children:c?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx(xe,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Chargement des données..."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Période: ",y," au ",b]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(M,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Paiements RAC-"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((F=s==null?void 0:s.payments)==null?void 0:F.count)||0," transactions"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100",children:e.jsx(Y,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Nouveaux leads"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((L=s==null?void 0:s.leads)==null?void 0:L.count)||0," prospects"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-purple-100",children:e.jsx(N,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Demandes"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((T=s==null?void 0:s.requests)==null?void 0:T.count)||0," services"]})]})]})]})]})})]})})]})]})})}export{Qe as default};
