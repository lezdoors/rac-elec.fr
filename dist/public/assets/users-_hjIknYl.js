import{c as ye,a as ss,as,r as v,d as ue,t as he,o as we,e as Z,j as e,B as h,I as u,Z as pe,U as q,L as $,$ as W,a1 as Y,a2 as _,a3 as ee,a8 as se,F as je,M as k,n as B,f as r,g as l,h as n,i,k as d,m as p,X as ts,aa as ae,l as K,p as T,q as ke,s as g,bX as rs,O as Te}from"./index-DoOyQpDg.js";import{A as ls,U as ge,f as fe,E as is,z as ns,F as cs,G as os,B as te}from"./admin-layout-554xjVzY.js";import{T as re,a as le,b as j,c as S}from"./tabs-BOIci4Wz.js";import{T as ds,a as ms,b as Ne,c as F,d as xs,e as P}from"./table-OJjEBl1q.js";import{C as us,a as hs,d as ps}from"./card-BV3MLhEv.js";import{S as Fe,a as Ae,d as Le,b as Me,c as z}from"./select-D7uG6fJR.js";import{S as G}from"./switch-DqOLqS8n.js";import{C as Ue}from"./checkbox-DKUZeilc.js";import{A as js,a as gs}from"./avatar-q319xsMw.js";import{B as oe}from"./use-mobile-BJYmzBjN.js";import{a as fs}from"./use-auth-CUsndVaB.js";import{S as Ns}from"./search-BPMxFEwF.js";import{U as vs}from"./users-BJhNGsQY.js";import{C as w}from"./chevron-down-B9b-t5lK.js";import{A as ve}from"./at-sign-CDgLjHyJ.js";import{S as Re,T as De}from"./trash-2-DklfBdd3.js";import{L as ie}from"./lock-DKAF76mo.js";import{I as ne}from"./info-C9y9nRl-.js";import{E as bs}from"./eye-DwxF1BgM.js";import{C as qe}from"./circle-alert-CntoVg7e.js";import{f as ws}from"./formatDistanceToNow-BRIUaAT8.js";import"./log-out-G2g80KMN.js";import"./credit-card-B63Ehg5s.js";import"./settings-DlXIVaIO.js";import"./index-CVS3WhXl.js";import"./index-DHO6DMX2.js";import"./index-C9E8glm3.js";import"./separator-DQVI2MlT.js";import"./external-link-Cly8VjAW.js";import"./index-Ch80ccjy.js";import"./endOfMonth-C6raWiDY.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=ye("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=ye("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=ye("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),Ie={admin:[{page:"dashboard",canView:!0,canEdit:!0},{page:"leads",canView:!0,canEdit:!0},{page:"tasks",canView:!0,canEdit:!0},{page:"calendar",canView:!0,canEdit:!0},{page:"communications",canView:!0,canEdit:!0},{page:"contacts",canView:!0,canEdit:!0},{page:"stats",canView:!0,canEdit:!0},{page:"configuration",canView:!0,canEdit:!0},{page:"users",canView:!0,canEdit:!0},{page:"payments",canView:!0,canEdit:!0}],manager:[{page:"dashboard",canView:!0,canEdit:!0},{page:"leads",canView:!0,canEdit:!0},{page:"tasks",canView:!0,canEdit:!0},{page:"calendar",canView:!0,canEdit:!0},{page:"communications",canView:!0,canEdit:!0},{page:"contacts",canView:!0,canEdit:!0},{page:"stats",canView:!0,canEdit:!0},{page:"payments",canView:!0,canEdit:!0},{page:"configuration",canView:!1,canEdit:!1},{page:"users",canView:!1,canEdit:!1},{page:"animations",canView:!1,canEdit:!1},{page:"settings",canView:!1,canEdit:!1}],agent:[{page:"dashboard",canView:!0,canEdit:!1},{page:"leads",canView:!0,canEdit:!0},{page:"tasks",canView:!0,canEdit:!0},{page:"calendar",canView:!0,canEdit:!0},{page:"communications",canView:!0,canEdit:!0},{page:"contacts",canView:!0,canEdit:!0},{page:"stats",canView:!0,canEdit:!1},{page:"configuration",canView:!1,canEdit:!1},{page:"users",canView:!1,canEdit:!1},{page:"payments",canView:!1,canEdit:!1}]};function C(m){return Ie[m]||Ie.agent}const He=we({username:g().min(3,"Le nom d'utilisateur doit contenir au moins 3 caractères"),email:g().email("Format d'email invalide"),password:g().min(6,"Le mot de passe doit contenir au moins 6 caractères"),fullName:g().optional(),role:g(),active:T().optional(),permissions:rs(we({page:g(),canView:T(),canEdit:T()})).optional(),smtpHost:g().optional(),smtpPort:ke().optional(),smtpSecure:T().optional(),smtpUser:g().optional(),smtpPassword:g().optional(),smtpFromEmail:g().email("Format d'email invalide").optional(),smtpEnabled:T().optional(),commissionEnabled:T().optional(),commissionRate:ke().optional(),onboardingCompleted:T().optional()}),Cs=we({newPassword:g().min(6,"Le mot de passe doit contenir au moins 6 caractères"),confirmPassword:g()}).refine(m=>m.newPassword===m.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]});function A({content:m,children:E}){return e.jsx(is,{children:e.jsxs(ns,{children:[e.jsx(cs,{asChild:!0,children:E}),e.jsx(os,{className:"bg-black text-white text-xs p-2 rounded",children:e.jsx("p",{children:m})})]})})}function ce({permissions:m,onChange:E}){return e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map((c,f)=>e.jsxs("div",{className:"flex flex-col p-3 bg-white border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"font-medium text-gray-700 capitalize",children:c.page==="leads"?"Demandes":c.page==="tasks"?"Tâches":c.page==="calendar"?"Calendrier":c.page==="communications"?"Communications":c.page==="contacts"?"Contacts":c.page==="stats"?"Statistiques":c.page==="payments"?"Paiements":c.page==="configuration"?"Configuration":c.page==="users"?"Utilisateurs":c.page}),c.canView&&c.canEdit?e.jsx(oe,{className:"bg-blue-500 hover:bg-blue-600",children:"Tous droits"}):c.canView?e.jsx(oe,{className:"bg-green-500 hover:bg-green-600",children:"Lecture"}):e.jsx(oe,{variant:"outline",children:"Aucun accès"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{id:`view-${f}`,checked:c.canView,onCheckedChange:L=>{const b=[...m];b[f]={...c,canView:L,canEdit:L?c.canEdit:!1},E(b)}}),e.jsx(Te,{htmlFor:`view-${f}`,className:"text-gray-600",children:"Afficher"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{id:`edit-${f}`,checked:c.canEdit,disabled:!c.canView,onCheckedChange:L=>{const b=[...m];b[f]={...c,canEdit:L},E(b)}}),e.jsx(Te,{htmlFor:`edit-${f}`,className:"text-gray-600",children:"Modifier"})]})]})]},c.page))})})}function ra(){const{toast:m}=ss(),E=as(),[c,f]=v.useState(!1),[L,b]=v.useState(!1),[x,de]=v.useState(null),[Oe,Q]=v.useState(!1),[$e,J]=v.useState(!1),[Ce,Ee]=v.useState(null),[X,Be]=v.useState("all"),[N,Se]=v.useState({column:"createdAt",direction:"desc"}),[me,Ke]=v.useState(""),Ge={column:"createdAt",direction:"desc"},Qe=s=>{switch(s){case"admin":return"Administrateur";case"manager":return"Responsable";case"agent":return"Agent commercial";default:return s}},t=ue({resolver:he(He),defaultValues:{username:"",email:"",password:"",fullName:"",role:"agent",active:!0,permissions:C("agent"),smtpEnabled:!0,smtpHost:"s4015.fra1.stableserver.net",smtpPort:465,smtpSecure:!0,smtpFromEmail:"",commissionEnabled:!1,commissionRate:0,onboardingCompleted:!1}}),o=ue({resolver:he(He.partial({password:!0})),defaultValues:{username:"",email:"",password:"",fullName:"",role:"agent",active:!0}}),M=ue({resolver:he(Cs),defaultValues:{newPassword:"",confirmPassword:""}}),{data:Pe,isLoading:Je,refetch:Es}=fs({queryKey:["users"],queryFn:async()=>await(await K("GET","/api/users")).json()}),U=Z({mutationFn:async s=>await(await K("POST","/api/users",s)).json(),onSuccess:()=>{f(!1),t.reset(),E.invalidateQueries({queryKey:["users"]}),m({title:"Utilisateur créé",description:"L'utilisateur a été créé avec succès."})},onError:s=>{m({title:"Erreur",description:`Erreur lors de la création de l'utilisateur: ${s.message}`,variant:"destructive"})}}),V=Z({mutationFn:async s=>{const{id:a,...y}=s;return await(await K("PUT",`/api/users/${a}`,y)).json()},onSuccess:()=>{b(!1),de(null),o.reset(),E.invalidateQueries({queryKey:["users"]}),m({title:"Utilisateur mis à jour",description:"L'utilisateur a été mis à jour avec succès."})},onError:s=>{m({title:"Erreur",description:`Erreur lors de la mise à jour de l'utilisateur: ${s.message}`,variant:"destructive"})}}),R=Z({mutationFn:async s=>(await K("DELETE",`/api/users/${s}`)).ok,onSuccess:()=>{J(!1),Ee(null),E.invalidateQueries({queryKey:["users"]}),m({title:"Utilisateur supprimé",description:"L'utilisateur a été supprimé avec succès."})},onError:s=>{m({title:"Erreur",description:`Erreur lors de la suppression de l'utilisateur: ${s.message}`,variant:"destructive"})}}),D=Z({mutationFn:async({userId:s,password:a})=>(await K("POST",`/api/users/${s}/reset-password`,{password:a})).ok,onSuccess:()=>{Q(!1),M.reset(),m({title:"Mot de passe réinitialisé",description:"Le mot de passe a été réinitialisé avec succès."})},onError:s=>{m({title:"Erreur",description:`Erreur lors de la réinitialisation du mot de passe: ${s.message}`,variant:"destructive"})}}),Xe=s=>{s.smtpEnabled&&!s.smtpUser&&(s.smtpUser=s.email),s.smtpEnabled&&!s.smtpFromEmail&&(s.smtpFromEmail=s.email),U.mutate(s)},Ze=s=>{de(s),o.reset({username:s.username,email:s.email,fullName:s.fullName||"",role:s.role,active:s.active,permissions:s.permissions||C(s.role),smtpEnabled:s.smtpEnabled,smtpHost:s.smtpHost,smtpPort:s.smtpPort,smtpSecure:s.smtpSecure,smtpUser:s.smtpUser,smtpPassword:"",smtpFromEmail:s.smtpFromEmail,commissionEnabled:s.commissionEnabled,commissionRate:s.commissionRate}),b(!0)},We=s=>{if(x)if(s.smtpEnabled&&!s.smtpUser&&(s.smtpUser=s.email),s.smtpEnabled&&!s.smtpFromEmail&&(s.smtpFromEmail=s.email),s.password)V.mutate({id:x.id,...s});else{const{password:a,...y}=s;V.mutate({id:x.id,...y})}},Ye=s=>{de(s),Q(!0),M.reset({newPassword:"",confirmPassword:""})},_e=s=>{x&&D.mutate({userId:x.id,password:s.newPassword})},Ve=[...Pe?Pe.filter(s=>X==="all"?!0:s.role===X).filter(s=>{if(!me)return!0;const a=me.toLowerCase();return s.username.toLowerCase().includes(a)||s.email.toLowerCase().includes(a)||(s.fullName||"").toLowerCase().includes(a)}):[]].sort((s,a)=>{const{column:y,direction:xe}=N;let H=s[y],O=a[y];return(y==="createdAt"||y==="lastLogin")&&(H=H?new Date(H).getTime():0,O=O?new Date(O).getTime():0),H<O?xe==="asc"?-1:1:H>O?xe==="asc"?1:-1:0}),I=s=>{Se(a=>({column:s,direction:a.column===s&&a.direction==="asc"?"desc":"asc"}))},es=s=>s.fullName?s.fullName.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().substring(0,2):s.username.substring(0,2).toUpperCase();return v.useEffect(()=>{const s=t.watch("role");s&&t.setValue("permissions",C(s))},[t.watch("role")]),v.useEffect(()=>{Se(Ge)},[X]),e.jsxs(ls,{children:[e.jsx("div",{className:"container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des utilisateurs"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Créez et gérez les utilisateurs du système"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs(h,{onClick:()=>{f(!0),t.reset({username:"",email:"",password:"",fullName:"",role:"agent",active:!0,permissions:C("agent"),smtpEnabled:!0,smtpHost:"s4015.fra1.stableserver.net",smtpPort:465,smtpSecure:!0,commissionEnabled:!1,commissionRate:0,onboardingCompleted:!1})},className:"flex items-center gap-1.5",children:[e.jsx(ge,{className:"h-4 w-4"}),"Créer un utilisateur"]})})]}),e.jsxs(us,{children:[e.jsx(hs,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(Ns,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{type:"text",placeholder:"Rechercher...",className:"pl-9",value:me,onChange:s=>Ke(s.target.value)})]}),e.jsx(re,{value:X,onValueChange:Be,className:"w-full sm:w-auto",children:e.jsxs(le,{className:"w-full grid-cols-4",children:[e.jsxs(j,{value:"all",className:"gap-2",children:[e.jsx(vs,{className:"h-4 w-4"}),"Tous"]}),e.jsxs(j,{value:"admin",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Admin"]}),e.jsxs(j,{value:"manager",className:"gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Responsables"]}),e.jsxs(j,{value:"agent",className:"gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Agents"]})]})})]})}),e.jsx(ps,{children:Je?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx($,{className:"h-8 w-8 animate-spin text-blue-500"})}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs(ds,{children:[e.jsx(ms,{children:e.jsxs(Ne,{children:[e.jsx(F,{className:"w-12"}),e.jsx(F,{className:"cursor-pointer hover:text-blue-600",onClick:()=>I("username"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Utilisateur",N.column==="username"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(F,{className:"cursor-pointer hover:text-blue-600",onClick:()=>I("role"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Rôle",N.column==="role"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(F,{className:"cursor-pointer hover:text-blue-600 hidden md:table-cell",onClick:()=>I("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Email",N.column==="email"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(F,{className:"cursor-pointer hover:text-blue-600 hidden md:table-cell",onClick:()=>I("createdAt"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Création",N.column==="createdAt"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(F,{className:"cursor-pointer hover:text-blue-600 hidden lg:table-cell",onClick:()=>I("lastLogin"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Dernière connexion",N.column==="lastLogin"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(F,{className:"w-[120px] text-right",children:"Actions"})]})}),e.jsx(xs,{children:Ve.length===0?e.jsx(Ne,{children:e.jsx(P,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Aucun utilisateur trouvé"})}):Ve.map(s=>e.jsxs(Ne,{className:s.active?"":"opacity-60",children:[e.jsx(P,{className:"py-2",children:e.jsx(js,{className:"h-9 w-9",children:e.jsx(gs,{className:`${s.role==="admin"?"bg-purple-100 text-purple-800":s.role==="manager"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:es(s)})})}),e.jsx(P,{className:"font-medium",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-900",children:s.fullName||s.username}),s.fullName&&e.jsxs("span",{className:"text-xs text-gray-500",children:["@",s.username]})]})}),e.jsx(P,{children:e.jsx(oe,{variant:s.role==="admin"?"purple":s.role==="manager"?"blue":"default",className:"rounded-md",children:s.role==="admin"?"Administrateur":s.role==="manager"?"Responsable":"Agent commercial"})}),e.jsx(P,{className:"hidden md:table-cell",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{className:"h-3.5 w-3.5 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.email})]})}),e.jsx(P,{className:"text-gray-500 hidden md:table-cell",children:s.createdAt?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:fe(new Date(s.createdAt),"dd/MM/yyyy",{locale:te})}),e.jsx("span",{className:"text-xs",children:fe(new Date(s.createdAt),"HH:mm",{locale:te})})]}):"-"}),e.jsx(P,{className:"text-gray-500 hidden lg:table-cell",children:s.lastLogin?e.jsx("div",{title:fe(new Date(s.lastLogin),"dd/MM/yyyy HH:mm",{locale:te}),children:ws(new Date(s.lastLogin),{addSuffix:!0,locale:te})}):"-"}),e.jsx(P,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(A,{content:"Modifier",children:e.jsx(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>Ze(s),children:e.jsx(Re,{className:"h-4 w-4"})})}),e.jsx(A,{content:"Réinitialiser le mot de passe",children:e.jsx(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>Ye(s),children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsx(A,{content:"Supprimer",children:e.jsx(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 hover:bg-red-50",onClick:()=>{Ee(s.id),J(!0)},children:e.jsx(De,{className:"h-4 w-4"})})})]})})]},s.id))})]})})})]})]})}),e.jsx(W,{open:c,onOpenChange:s=>!U.isPending&&f(s),children:e.jsxs(Y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(_,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5"}),"Créer un nouvel utilisateur"]}),e.jsx(se,{children:"Ajoutez un nouvel utilisateur et configurez ses accès au système."})]}),e.jsx(je,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(Xe),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-blue-600"}),"Notification d'arrivée"]}),e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"Le nouvel utilisateur recevra un email de bienvenue avec ses informations de connexion et la configuration de sa boîte mail personnelle."}),e.jsxs("ul",{className:"text-xs text-blue-600 space-y-1 mb-2",children:[e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(B,{className:"h-3.5 w-3.5 mt-0.5 text-blue-700"}),e.jsx("span",{children:"Informations d'accès à la plateforme"})]}),e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(B,{className:"h-3.5 w-3.5 mt-0.5 text-blue-700"}),e.jsx("span",{children:"Configuration de messagerie automatique"})]}),e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(B,{className:"h-3.5 w-3.5 mt-0.5 text-blue-700"}),e.jsx("span",{children:"Informations du rôle et des permissions"})]})]})]}),e.jsx(r,{control:t.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Nom complet"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{placeholder:"Nom et prénom",className:"pl-9",...s})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"username",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Nom d'utilisateur",e.jsx(A,{content:"Identifiant unique utilisé pour la connexion",children:e.jsx(ne,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{placeholder:"Nom d'utilisateur",className:"pl-9",...s})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Email",e.jsx(A,{content:"Adresse email utilisée pour les notifications et la récupération du compte",children:e.jsx(ne,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{type:"email",placeholder:"utilisateur@exemple.com",className:"pl-9",...s,onChange:a=>{s.onChange(a),t.watch("smtpEnabled")&&(t.setValue("smtpFromEmail",a.target.value),t.setValue("smtpUser",a.target.value))}})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"password",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Mot de passe",e.jsx(A,{content:"Minimum 6 caractères. Un mot de passe fort est recommandé.",children:e.jsx(ne,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{type:"password",placeholder:"Mot de passe",className:"pl-9",...s})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"role",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Rôle",e.jsx(A,{content:"Détermine le niveau d'accès et les permissions de l'utilisateur",children:e.jsx(ne,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsxs(Fe,{onValueChange:a=>{s.onChange(a),t.setValue("permissions",C(a))},defaultValue:s.value,children:[e.jsx(i,{children:e.jsx(Ae,{className:"w-full",children:e.jsx(Le,{placeholder:"Sélectionner un rôle"})})}),e.jsxs(Me,{children:[e.jsx(z,{value:"admin",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{children:"Administrateur"})]})}),e.jsx(z,{value:"manager",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{children:"Responsable"})]})}),e.jsx(z,{value:"agent",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:"Agent commercial"})]})})]})]}),e.jsx(p,{children:"Définit les droits d'accès de l'utilisateur dans le système."}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"active",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Compte actif"}),e.jsx(p,{children:"Détermine si l'utilisateur peut se connecter au système."})]}),e.jsx(i,{children:e.jsx(G,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs(re,{defaultValue:"permissions",children:[e.jsxs(le,{className:"grid w-full grid-cols-4",children:[e.jsx(j,{value:"permissions",children:"Permissions"}),e.jsx(j,{value:"smtp",children:"Config SMTP"}),e.jsxs(j,{value:"email-preview",className:"flex items-center gap-1.5",children:[e.jsx(bs,{className:"h-4 w-4"}),"Aperçu email"]}),e.jsx(j,{value:"commission",children:"Commission"})]}),e.jsx(S,{value:"email-preview",className:"py-4",children:e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-100 border-b p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Aperçu de l'email de bienvenue"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(h,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 rounded-full",children:e.jsx(ys,{className:"h-3 w-3"})}),e.jsx(h,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 rounded-full",children:e.jsx(ts,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"p-5 overflow-auto max-h-[500px]",children:e.jsxs("div",{className:"mx-auto max-w-[550px]",children:[e.jsxs("div",{className:"text-center mb-5",children:[e.jsx("div",{className:"inline-block bg-blue-600 text-white p-3 rounded-full mb-3",children:e.jsx(k,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-xl font-bold text-blue-800",children:"Bienvenue chez Raccordement Électrique"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Votre compte a été créé avec succès"})]}),e.jsxs("div",{className:"bg-gray-50 border rounded-lg p-5 mb-5",children:[e.jsxs("h3",{className:"font-medium text-gray-800 mb-3 flex items-center gap-1.5",children:[e.jsx(q,{className:"h-4 w-4 text-blue-600"}),"Vos informations de connexion"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white rounded border",children:[e.jsx("span",{className:"text-gray-600",children:"Nom d'utilisateur :"}),e.jsx("span",{className:"font-medium",children:t.watch("username")||"[nom d'utilisateur]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white rounded border",children:[e.jsx("span",{className:"text-gray-600",children:"Email :"}),e.jsx("span",{className:"font-medium",children:t.watch("email")||"[email]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white rounded border",children:[e.jsx("span",{className:"text-gray-600",children:"Rôle :"}),e.jsx("span",{className:"font-medium",children:Qe(t.watch("role")||"agent")})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-5 mb-5",children:[e.jsxs("h3",{className:"font-medium text-blue-800 mb-3 flex items-center gap-1.5",children:[e.jsx(k,{className:"h-4 w-4 text-blue-600"}),"Configuration de messagerie"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white/80 rounded border border-blue-100",children:[e.jsx("span",{className:"text-gray-600",children:"Serveur :"}),e.jsx("span",{className:"font-medium font-mono text-blue-700",children:"s4015.fra1.stableserver.net"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white/80 rounded border border-blue-100",children:[e.jsx("span",{className:"text-gray-600",children:"Email :"}),e.jsx("span",{className:"font-medium font-mono text-blue-700",children:t.watch("email")||"[email]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white/80 rounded border border-blue-100",children:[e.jsx("span",{className:"text-gray-600",children:"Mot de passe :"}),e.jsx("span",{className:"font-medium font-mono text-blue-700",children:"Kamaka00."})]})]}),e.jsx("div",{className:"mt-3 text-xs text-blue-700",children:"Vous pouvez accéder à votre messagerie via un client mail (Outlook, Thunderbird, Gmail, etc.) ou directement depuis l'interface du CRM."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(h,{className:"bg-blue-600 hover:bg-blue-700",children:"Accéder au CRM"}),e.jsxs("p",{className:"mt-4 text-xs text-gray-500",children:["En cas de problème, contactez l'administrateur du système à ",e.jsx("a",{href:"mailto:admin@portail-electricite.com",className:"text-blue-600 underline",children:"admin@portail-electricite.com"})]})]})]})})]})}),e.jsx(S,{value:"permissions",className:"py-4",children:e.jsxs(re,{defaultValue:"default",children:[e.jsxs(le,{className:"grid w-full grid-cols-2",children:[e.jsx(j,{value:"default",children:"Permissions par défaut"}),e.jsx(j,{value:"custom",children:"Permissions personnalisées"})]}),e.jsxs(S,{value:"default",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Les permissions seront attribuées automatiquement en fonction du rôle de l'utilisateur."}),e.jsx(ce,{permissions:C(t.watch("role")||"agent"),onChange:()=>{}})]}),e.jsxs(S,{value:"custom",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Personnalisez les permissions de l'utilisateur."}),e.jsx(r,{control:t.control,name:"permissions",render:({field:s})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(ce,{permissions:s.value||[],onChange:s.onChange})}),e.jsx(d,{})]})})]})]})}),e.jsx(S,{value:"smtp",className:"py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-sky-50 border border-blue-200 rounded-lg p-5 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-500 p-2 rounded-full text-white mt-1",children:e.jsx(k,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Configuration automatique de la messagerie"}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"L'utilisateur recevra un email de bienvenue contenant ses identifiants et informations de connexion."}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm bg-white/75 p-3 rounded-md border border-blue-100 mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Serveur SMTP:"}),e.jsx("span",{className:"font-mono",children:"s4015.fra1.stableserver.net"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Port:"}),e.jsx("span",{className:"font-mono",children:"465"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Sécurité:"}),e.jsx("span",{className:"font-mono",children:"SSL/TLS"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Mot de passe:"}),e.jsx("span",{className:"font-mono",children:"Kamaka00."})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3 text-xs text-yellow-800",children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(qe,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}),e.jsx("p",{children:"Cette configuration permet à l'utilisateur d'envoyer des emails depuis le système et d'utiliser sa boîte email personnalisée."})]})})]})]})}),e.jsx(r,{control:t.control,name:"smtpEnabled",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Activer la configuration SMTP"}),e.jsx(p,{children:"Permet à l'utilisateur d'envoyer des emails depuis le système."})]}),e.jsx(i,{children:e.jsx(G,{checked:s.value,onCheckedChange:s.onChange})})]})}),t.watch("smtpEnabled")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(r,{control:t.control,name:"smtpHost",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Serveur SMTP"}),e.jsx(i,{children:e.jsx(u,{placeholder:"smtp.example.com",...s,value:s.value||""})}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"smtpPort",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Port"}),e.jsx(i,{children:e.jsx(u,{type:"number",placeholder:"465",...s,value:s.value||"",onChange:a=>s.onChange(a.target.value?parseInt(a.target.value):"")})}),e.jsx(d,{})]})})]}),e.jsx(r,{control:t.control,name:"smtpSecure",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Connexion sécurisée"}),e.jsx(p,{children:"Utiliser SSL/TLS pour la connexion au serveur SMTP."})]}),e.jsx(i,{children:e.jsx(G,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:t.control,name:"smtpUser",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Nom d'utilisateur SMTP"}),e.jsx(i,{children:e.jsx(u,{placeholder:"user@example.com",...s,value:s.value||""})}),e.jsx(p,{children:"Généralement identique à l'adresse email."}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"smtpPassword",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Mot de passe SMTP"}),e.jsx(i,{children:e.jsx(u,{type:"password",placeholder:"********",...s,value:s.value||""})}),e.jsx(p,{children:"Laissez vide pour conserver le mot de passe actuel."}),e.jsx(d,{})]})}),e.jsx(r,{control:t.control,name:"smtpFromEmail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Email d'expédition"}),e.jsx(i,{children:e.jsx(u,{placeholder:"noreply@example.com",...s,value:s.value||""})}),e.jsx(p,{children:"Adresse utilisée comme expéditeur des emails."}),e.jsx(d,{})]})})]})]})}),e.jsx(S,{value:"commission",className:"py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-lg p-5 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-amber-500 p-2 rounded-full text-white mt-1",children:e.jsx(ze,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 mb-2",children:"Commissions sur paiements"}),e.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Activez et configurez les commissions pour cet utilisateur sur les paiements reçus."}),e.jsxs("div",{className:"bg-white/75 p-3 rounded-md border border-amber-100 text-sm",children:[e.jsx("p",{className:"text-amber-800 mb-2",children:"Le système permettra de suivre et calculer automatiquement les commissions de l'utilisateur sur les paiements des demandes qu'il a traitées."}),e.jsx("p",{className:"text-amber-800 font-medium",children:"Ces informations sont visibles uniquement par les administrateurs."})]})]})]})}),e.jsx(r,{control:t.control,name:"commissionEnabled",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Activer les commissions"}),e.jsx(p,{children:"L'utilisateur recevra des commissions sur les paiements."})]}),e.jsx(i,{children:e.jsx(G,{checked:s.value,onCheckedChange:s.onChange})})]})}),t.watch("commissionEnabled")&&e.jsx(r,{control:t.control,name:"commissionRate",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Taux de commission (€ par paiement)"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{type:"number",step:"0.01",min:"0",placeholder:"14.00",className:"pl-9",...s,value:s.value||"",onChange:a=>s.onChange(a.target.value?parseFloat(a.target.value):"")})]})}),e.jsx(p,{children:"Montant fixe en euros par paiement traité. Par défaut: 14€."}),e.jsx(d,{})]})})]})})]})})]}),e.jsxs(ae,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>!U.isPending&&f(!1),disabled:U.isPending,children:"Annuler"}),e.jsx(h,{type:"submit",disabled:U.isPending,className:"gap-1",children:U.isPending?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 animate-spin"}),"Création en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4"}),"Créer l'utilisateur"]})})]})]})})]})}),e.jsx(W,{open:L,onOpenChange:s=>!V.isPending&&b(s),children:e.jsxs(Y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(_,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5"}),"Modifier l'utilisateur"]}),e.jsx(se,{children:"Modifiez les informations et les accès de cet utilisateur."})]}),e.jsx(je,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(We),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(r,{control:o.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Nom complet"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{placeholder:"Nom et prénom",className:"pl-9",...s,value:s.value||""})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:o.control,name:"username",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Nom d'utilisateur"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{placeholder:"Nom d'utilisateur",className:"pl-9",...s})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:o.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Email"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{type:"email",placeholder:"utilisateur@exemple.com",className:"pl-9",...s,onChange:a=>{s.onChange(a),o.watch("smtpEnabled")&&((!o.getValues("smtpFromEmail")||o.getValues("smtpFromEmail")===(x==null?void 0:x.email))&&o.setValue("smtpFromEmail",a.target.value),(!o.getValues("smtpUser")||o.getValues("smtpUser")===(x==null?void 0:x.email))&&o.setValue("smtpUser",a.target.value))}})]})}),e.jsx(d,{})]})}),e.jsx(r,{control:o.control,name:"password",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Mot de passe"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(u,{type:"password",placeholder:"Laisser vide pour ne pas modifier",className:"pl-9",...s,value:s.value||""})]})}),e.jsx(p,{children:"Laissez vide pour conserver le mot de passe actuel."}),e.jsx(d,{})]})}),e.jsx(r,{control:o.control,name:"role",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Rôle"}),e.jsxs(Fe,{onValueChange:a=>{s.onChange(a),(!o.getValues("permissions")||JSON.stringify(o.getValues("permissions"))===JSON.stringify(C((x==null?void 0:x.role)||"")))&&o.setValue("permissions",C(a))},defaultValue:s.value,value:s.value,children:[e.jsx(i,{children:e.jsx(Ae,{className:"w-full",children:e.jsx(Le,{placeholder:"Sélectionner un rôle"})})}),e.jsxs(Me,{children:[e.jsx(z,{value:"admin",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{children:"Administrateur"})]})}),e.jsx(z,{value:"manager",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{children:"Responsable"})]})}),e.jsx(z,{value:"agent",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:"Agent commercial"})]})})]})]}),e.jsx(p,{children:"Définit les droits d'accès de l'utilisateur dans le système."}),e.jsx(d,{})]})}),e.jsx(r,{control:o.control,name:"active",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Compte actif"}),e.jsx(p,{children:"Détermine si l'utilisateur peut se connecter au système."})]}),e.jsx(i,{children:e.jsx(G,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs(re,{defaultValue:"permissions",children:[e.jsxs(le,{className:"grid w-full grid-cols-2",children:[e.jsx(j,{value:"default",children:"Permissions par défaut"}),e.jsx(j,{value:"custom",children:"Permissions personnalisées"})]}),e.jsxs(S,{value:"default",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Les permissions seront attribuées automatiquement en fonction du rôle de l'utilisateur."}),e.jsx(ce,{permissions:C(o.watch("role")||"agent"),onChange:()=>{}})]}),e.jsxs(S,{value:"custom",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Personnalisez les permissions de l'utilisateur."}),e.jsx(r,{control:o.control,name:"permissions",render:({field:s})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(ce,{permissions:s.value||[],onChange:s.onChange})}),e.jsx(d,{})]})})]})]})})]}),e.jsxs(ae,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>!V.isPending&&b(!1),disabled:V.isPending,children:"Annuler"}),e.jsx(h,{type:"submit",disabled:V.isPending,className:"gap-1",children:V.isPending?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 animate-spin"}),"Mise à jour en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4"}),"Enregistrer les modifications"]})})]})]})})]})}),e.jsx(W,{open:Oe,onOpenChange:s=>!D.isPending&&Q(s),children:e.jsxs(Y,{className:"max-w-md",children:[e.jsxs(_,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Réinitialiser le mot de passe"]}),e.jsxs(se,{children:["Définissez un nouveau mot de passe pour l'utilisateur ",x==null?void 0:x.username,"."]})]}),e.jsx(je,{...M,children:e.jsxs("form",{onSubmit:M.handleSubmit(_e),className:"space-y-4",children:[e.jsx(r,{control:M.control,name:"newPassword",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Nouveau mot de passe"}),e.jsx(i,{children:e.jsx(u,{type:"password",placeholder:"••••••••",...s})}),e.jsx(d,{})]})}),e.jsx(r,{control:M.control,name:"confirmPassword",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Confirmer le mot de passe"}),e.jsx(i,{children:e.jsx(u,{type:"password",placeholder:"••••••••",...s})}),e.jsx(d,{})]})}),e.jsxs(ae,{className:"mt-6",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>!D.isPending&&Q(!1),disabled:D.isPending,children:"Annuler"}),e.jsx(h,{type:"submit",disabled:D.isPending,className:"gap-1",children:D.isPending?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 animate-spin"}),"Réinitialisation..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4"}),"Réinitialiser"]})})]})]})})]})}),e.jsx(W,{open:$e,onOpenChange:s=>!R.isPending&&J(s),children:e.jsxs(Y,{className:"max-w-md",children:[e.jsxs(_,{children:[e.jsxs(ee,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5"}),"Confirmer la suppression"]}),e.jsx(se,{children:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible."})]}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"La suppression d'un utilisateur entraînera la perte de toutes ses données associées, y compris :"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-2 space-y-1",children:[e.jsx("li",{children:"Son compte et ses informations personnelles"}),e.jsx("li",{children:"Ses statistiques et son historique"}),e.jsx("li",{children:"Ses configurations et préférences"})]})]}),e.jsxs(ae,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>!R.isPending&&J(!1),disabled:R.isPending,children:"Annuler"}),e.jsx(h,{variant:"destructive",onClick:()=>Ce&&R.mutate(Ce),disabled:R.isPending,className:"gap-1",children:R.isPending?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 animate-spin"}),"Suppression..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4"}),"Supprimer définitivement"]})})]})]})})]})}export{ra as default};
