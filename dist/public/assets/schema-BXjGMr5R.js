var qs=Object.defineProperty;var Vs=(t,e,r)=>e in t?qs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var i=(t,e,r)=>Vs(t,typeof e!="symbol"?e+"":e,r);import{z as a}from"./index-BSDRWTu8.js";const o=Symbol.for("drizzle:entityKind");function A(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,o))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(o in r&&r[o]===e[o])return!0;r=Object.getPrototypeOf(r)}return!1}var le;le=o;class V{constructor(e,r){i(this,"name");i(this,"keyAsName");i(this,"primary");i(this,"notNull");i(this,"default");i(this,"defaultFn");i(this,"onUpdateFn");i(this,"hasDefault");i(this,"isUnique");i(this,"uniqueName");i(this,"uniqueType");i(this,"dataType");i(this,"columnType");i(this,"enumValues");i(this,"generated");i(this,"generatedIdentity");i(this,"config");this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}i(V,le,"Column");var ue;ue=o;class Gn{constructor(e,r,n){i(this,"config");i(this,"$default",this.$defaultFn);i(this,"$onUpdate",this.$onUpdateFn);this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}i(Gn,ue,"ColumnBuilder");const M=Symbol.for("drizzle:Name");var ce;ce=o;class Kn{constructor(e,r){i(this,"reference");i(this,"_onUpdate","no action");i(this,"_onDelete","no action");this.reference=()=>{const{name:n,columns:l,foreignColumns:u}=e();return{name:n,columns:l,foreignTable:u[0].table,foreignColumns:u}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Xn(e,this)}}i(Kn,ce,"PgForeignKeyBuilder");var de;de=o;class Xn{constructor(e,r){i(this,"reference");i(this,"onUpdate");i(this,"onDelete");this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:e,columns:r,foreignColumns:n}=this.reference(),l=r.map(h=>h.name),u=n.map(h=>h.name),d=[this.table[M],...l,n[0].table[M],...u];return e??`${d.join("_")}_fk`}}i(Xn,de,"PgForeignKey");function Fs(t,...e){return t(...e)}function zs(t,e){return`${t[M]}_${e.join("_")}_unique`}function te(t,e,r){for(let n=e;n<t.length;n++){const l=t[n];if(l==="\\"){n++;continue}if(l==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(l===","||l==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function Yn(t,e=0){const r=[];let n=e,l=!1;for(;n<t.length;){const u=t[n];if(u===","){(l||n===e)&&r.push(""),l=!0,n++;continue}if(l=!1,u==="\\"){n+=2;continue}if(u==='"'){const[y,b]=te(t,n+1,!0);r.push(y),n=b;continue}if(u==="}")return[r,n+1];if(u==="{"){const[y,b]=Yn(t,n+1);r.push(y),n=b;continue}const[d,h]=te(t,n,!1);r.push(d),n=h}return[r,n]}function Us(t){const[e]=Yn(t,1);return e}function Jn(t){return`{${t.map(e=>Array.isArray(e)?Jn(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var me,pe;class f extends(pe=Gn,me=o,pe){constructor(){super(...arguments);i(this,"foreignKeyConfigs",[])}array(r){return new Wn(this.config.name,this,r)}references(r,n={}){return this.foreignKeyConfigs.push({ref:r,actions:n}),this}unique(r,n){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=n==null?void 0:n.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,n){return this.foreignKeyConfigs.map(({ref:l,actions:u})=>Fs((d,h)=>{const y=new Kn(()=>{const b=d();return{columns:[r],foreignColumns:[b]}});return h.onUpdate&&y.onUpdate(h.onUpdate),h.onDelete&&y.onDelete(h.onDelete),y.build(n)},l,u))}buildExtraConfigColumn(r){return new Hn(r,this.config)}}i(f,me,"PgColumnBuilder");var ge,fe;class p extends(fe=V,ge=o,fe){constructor(e,r){r.uniqueName||(r.uniqueName=zs(e,[r.name])),super(e,r),this.table=e}}i(p,ge,"PgColumn");var ye,he;class Hn extends(he=p,ye=o,he){constructor(){super(...arguments);i(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});i(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}i(Hn,ye,"ExtraConfigColumn");var _e,be;class Wn extends(be=f,_e=o,be){constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){const r=this.config.baseBuilder.build(e);return new W(e,this.config,r)}}i(Wn,_e,"PgArrayBuilder");var Ne,Se;const X=class X extends(Se=p,Ne=o,Se){constructor(r,n,l,u){super(r,n);i(this,"size");this.baseColumn=l,this.range=u,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=Us(r)),r.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(r,n=!1){const l=r.map(u=>u===null?null:A(this.baseColumn,X)?this.baseColumn.mapToDriverValue(u,!0):this.baseColumn.mapToDriverValue(u));return n?l:Jn(l)}};i(X,Ne,"PgArray");let W=X;const re=Symbol.for("drizzle:isPgEnum");function Qs(t){return!!t&&typeof t=="function"&&re in t&&t[re]===!0}var Te;Te=o;class k{constructor(e,r,n,l=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:l}}}i(k,Te,"Subquery");const Rs={startActiveSpan(t,e){return e()}},q=Symbol.for("drizzle:ViewBaseConfig"),Y=Symbol.for("drizzle:Schema"),ne=Symbol.for("drizzle:Columns"),ie=Symbol.for("drizzle:ExtraConfigColumns"),J=Symbol.for("drizzle:OriginalName"),H=Symbol.for("drizzle:BaseName"),O=Symbol.for("drizzle:IsAlias"),se=Symbol.for("drizzle:ExtraConfigBuilder"),Zn=Symbol.for("drizzle:IsDrizzleTable");var Pe,we,Ie,Ae,De,xe,Ee,Ce,ve,Le;Le=o,ve=M,Ce=J,Ee=Y,xe=ne,De=ie,Ae=H,Ie=O,we=Zn,Pe=se;class D{constructor(e,r,n){i(this,ve);i(this,Ce);i(this,Ee);i(this,xe);i(this,De);i(this,Ae);i(this,Ie,!1);i(this,we,!0);i(this,Pe);this[M]=this[J]=e,this[Y]=r,this[H]=n}}i(D,Le,"Table"),i(D,"Symbol",{Name:M,Schema:Y,OriginalName:J,Columns:ne,ExtraConfigColumns:ie,BaseName:H,IsAlias:O,ExtraConfigBuilder:se});function kn(t){return typeof t=="object"&&t!==null&&Zn in t}function Os(t){return t!=null&&typeof t.getSQL=="function"}function js(t){var r;const e={sql:"",params:[]};for(const n of t)e.sql+=n.sql,e.params.push(...n.params),(r=n.typings)!=null&&r.length&&(e.typings||(e.typings=[]),e.typings.push(...n.typings));return e}var Be;Be=o;class C{constructor(e){i(this,"value");this.value=Array.isArray(e)?e:[e]}getSQL(){return new P([this])}}i(C,Be,"StringChunk");var Me;Me=o;const B=class B{constructor(e){i(this,"decoder",ei);i(this,"shouldInlineParams",!1);this.queryChunks=e}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Rs.startActiveSpan("drizzle.buildSQL",r=>{const n=this.buildQueryFromSourceParams(this.queryChunks,e);return r==null||r.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){const n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:l,escapeName:u,escapeParam:d,prepareTyping:h,inlineParams:y,paramStartIndex:b}=n;return js(e.map(c=>{var L;if(A(c,C))return{sql:c.value.join(""),params:[]};if(A(c,j))return{sql:u(c.value),params:[]};if(c===void 0)return{sql:"",params:[]};if(Array.isArray(c)){const _=[new C("(")];for(const[w,Ms]of c.entries())_.push(Ms),w<c.length-1&&_.push(new C(", "));return _.push(new C(")")),this.buildQueryFromSourceParams(_,n)}if(A(c,B))return this.buildQueryFromSourceParams(c.queryChunks,{...n,inlineParams:y||c.shouldInlineParams});if(A(c,D)){const _=c[D.Symbol.Schema],w=c[D.Symbol.Name];return{sql:_===void 0||c[O]?u(w):u(_)+"."+u(w),params:[]}}if(A(c,V)){const _=l.getColumnCasing(c);if(r.invokeSource==="indexes")return{sql:u(_),params:[]};const w=c.table[D.Symbol.Schema];return{sql:c.table[O]||w===void 0?u(c.table[D.Symbol.Name])+"."+u(_):u(w)+"."+u(c.table[D.Symbol.Name])+"."+u(_),params:[]}}if(A(c,ni)){const _=c[q].schema,w=c[q].name;return{sql:_===void 0||c[q].isAlias?u(w):u(_)+"."+u(w),params:[]}}if(A(c,ee)){if(A(c.value,G))return{sql:d(b.value++,c),params:[c],typings:["none"]};const _=c.value===null?null:c.encoder.mapToDriverValue(c.value);if(A(_,B))return this.buildQueryFromSourceParams([_],n);if(y)return{sql:this.mapInlineParam(_,n),params:[]};let w=["none"];return h&&(w=[h(c.encoder)]),{sql:d(b.value++,_),params:[_],typings:w}}return A(c,G)?{sql:d(b.value++,c),params:[c],typings:["none"]}:A(c,B.Aliased)&&c.fieldAlias!==void 0?{sql:u(c.fieldAlias),params:[]}:A(c,k)?c._.isWith?{sql:u(c._.alias),params:[]}:this.buildQueryFromSourceParams([new C("("),c._.sql,new C(") "),new j(c._.alias)],n):Qs(c)?c.schema?{sql:u(c.schema)+"."+u(c.enumName),params:[]}:{sql:u(c.enumName),params:[]}:Os(c)?(L=c.shouldOmitSQLParens)!=null&&L.call(c)?this.buildQueryFromSourceParams([c.getSQL()],n):this.buildQueryFromSourceParams([new C("("),c.getSQL(),new C(")")],n):y?{sql:this.mapInlineParam(c,n),params:[]}:{sql:d(b.value++,c),params:[c],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){const n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new B.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}};i(B,Me,"SQL");let P=B;var qe;qe=o;class j{constructor(e){i(this,"brand");this.value=e}getSQL(){return new P([this])}}i(j,qe,"Name");const ei={mapFromDriverValue:t=>t},ti={mapToDriverValue:t=>t};({...ei,...ti});var Ve;Ve=o;class ee{constructor(e,r=ti){i(this,"brand");this.value=e,this.encoder=r}getSQL(){return new P([this])}}i(ee,Ve,"Param");function $(t,...e){const r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new C(t[0]));for(const[n,l]of e.entries())r.push(l,new C(t[n+1]));return new P(r)}(t=>{function e(){return new P([])}t.empty=e;function r(y){return new P(y)}t.fromList=r;function n(y){return new P([new C(y)])}t.raw=n;function l(y,b){const c=[];for(const[L,_]of y.entries())L>0&&b!==void 0&&c.push(b),c.push(_);return new P(c)}t.join=l;function u(y){return new j(y)}t.identifier=u;function d(y){return new G(y)}t.placeholder=d;function h(y,b){return new ee(y,b)}t.param=h})($||($={}));(t=>{var r;r=o;const n=class n{constructor(u,d){i(this,"isSelectionField",!1);this.sql=u,this.fieldAlias=d}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}};i(n,r,"SQL.Aliased");let e=n;t.Aliased=e})(P||(P={}));var Fe;Fe=o;class G{constructor(e){this.name=e}getSQL(){return new P([this])}}i(G,Fe,"Placeholder");const ri=Symbol.for("drizzle:IsDrizzleView");var ze,Ue,Qe;Qe=o,Ue=q,ze=ri;class ni{constructor({name:e,schema:r,selectedFields:n,query:l}){i(this,Ue);i(this,ze,!0);this[q]={name:e,originalName:e,schema:r,selectedFields:n,query:l,isExisting:!l,isAlias:!1}}getSQL(){return new P([this])}}i(ni,Qe,"View");function $s(t){return typeof t=="object"&&t!==null&&ri in t}V.prototype.getSQL=function(){return new P([this])};D.prototype.getSQL=function(){return new P([this])};k.prototype.getSQL=function(){return new P([this])};function Gs(t){return t[D.Symbol.Columns]}function Ks(t){return t[q].selectedFields}function I(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}var Re,Oe;class U extends(Oe=f,Re=o,Oe){generatedAlwaysAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}i(U,Re,"PgIntColumnBaseBuilder");var je,$e;class ii extends($e=U,je=o,$e){constructor(e){super(e,"number","PgBigInt53")}build(e){return new si(e,this.config)}}i(ii,je,"PgBigInt53Builder");var Ge,Ke;class si extends(Ke=p,Ge=o,Ke){getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}i(si,Ge,"PgBigInt53");var Xe,Ye;class ai extends(Ye=U,Xe=o,Ye){constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new oi(e,this.config)}}i(ai,Xe,"PgBigInt64Builder");var Je,He;class oi extends(He=p,Je=o,He){getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}i(oi,Je,"PgBigInt64");function Xs(t,e){const{name:r,config:n}=I(t,e);return n.mode==="number"?new ii(r):new ai(r)}var We,Ze;class li extends(Ze=f,We=o,Ze){constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ui(e,this.config)}}i(li,We,"PgBigSerial53Builder");var ke,et;class ui extends(et=p,ke=o,et){getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}i(ui,ke,"PgBigSerial53");var tt,rt;class ci extends(rt=f,tt=o,rt){constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new di(e,this.config)}}i(ci,tt,"PgBigSerial64Builder");var nt,it;class di extends(it=p,nt=o,it){getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}i(di,nt,"PgBigSerial64");function Ys(t,e){const{name:r,config:n}=I(t,e);return n.mode==="number"?new li(r):new ci(r)}var st,at;class mi extends(at=f,st=o,at){constructor(e){super(e,"boolean","PgBoolean")}build(e){return new pi(e,this.config)}}i(mi,st,"PgBooleanBuilder");var ot,lt;class pi extends(lt=p,ot=o,lt){getSQLType(){return"boolean"}}i(pi,ot,"PgBoolean");function T(t){return new mi(t??"")}var ut,ct;class gi extends(ct=f,ut=o,ct){constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new fi(e,this.config)}}i(gi,ut,"PgCharBuilder");var dt,mt;class fi extends(mt=p,dt=o,mt){constructor(){super(...arguments);i(this,"length",this.config.length);i(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}i(fi,dt,"PgChar");function Js(t,e={}){const{name:r,config:n}=I(t,e);return new gi(r,n)}var pt,gt;class yi extends(gt=f,pt=o,gt){constructor(e){super(e,"string","PgCidr")}build(e){return new hi(e,this.config)}}i(yi,pt,"PgCidrBuilder");var ft,yt;class hi extends(yt=p,ft=o,yt){getSQLType(){return"cidr"}}i(hi,ft,"PgCidr");function Hs(t){return new yi(t??"")}var ht,_t;class _i extends(_t=f,ht=o,_t){constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new bi(e,this.config)}}i(_i,ht,"PgCustomColumnBuilder");var bt,Nt;class bi extends(Nt=p,bt=o,Nt){constructor(r,n){super(r,n);i(this,"sqlName");i(this,"mapTo");i(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}i(bi,bt,"PgCustomColumn");function Ws(t){return(e,r)=>{const{name:n,config:l}=I(e,r);return new _i(n,l,t)}}var St,Tt;class F extends(Tt=f,St=o,Tt){defaultNow(){return this.default($`now()`)}}i(F,St,"PgDateColumnBaseBuilder");var Pt,wt;class Ni extends(wt=F,Pt=o,wt){constructor(e){super(e,"date","PgDate")}build(e){return new Si(e,this.config)}}i(Ni,Pt,"PgDateBuilder");var It,At;class Si extends(At=p,It=o,At){getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}i(Si,It,"PgDate");var Dt,xt;class Ti extends(xt=F,Dt=o,xt){constructor(e){super(e,"string","PgDateString")}build(e){return new Pi(e,this.config)}}i(Ti,Dt,"PgDateStringBuilder");var Et,Ct;class Pi extends(Ct=p,Et=o,Ct){getSQLType(){return"date"}}i(Pi,Et,"PgDateString");function Zs(t,e){const{name:r,config:n}=I(t,e);return(n==null?void 0:n.mode)==="date"?new Ni(r):new Ti(r)}var vt,Lt;class wi extends(Lt=f,vt=o,Lt){constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Ii(e,this.config)}}i(wi,vt,"PgDoublePrecisionBuilder");var Bt,Mt;class Ii extends(Mt=p,Bt=o,Mt){getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}i(Ii,Bt,"PgDoublePrecision");function R(t){return new wi(t??"")}var qt,Vt;class Ai extends(Vt=f,qt=o,Vt){constructor(e){super(e,"string","PgInet")}build(e){return new Di(e,this.config)}}i(Ai,qt,"PgInetBuilder");var Ft,zt;class Di extends(zt=p,Ft=o,zt){getSQLType(){return"inet"}}i(Di,Ft,"PgInet");function ks(t){return new Ai(t??"")}var Ut,Qt;class xi extends(Qt=U,Ut=o,Qt){constructor(e){super(e,"number","PgInteger")}build(e){return new Ei(e,this.config)}}i(xi,Ut,"PgIntegerBuilder");var Rt,Ot;class Ei extends(Ot=p,Rt=o,Ot){getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}i(Ei,Rt,"PgInteger");function m(t){return new xi(t??"")}var jt,$t;class Ci extends($t=f,jt=o,$t){constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new vi(e,this.config)}}i(Ci,jt,"PgIntervalBuilder");var Gt,Kt;class vi extends(Kt=p,Gt=o,Kt){constructor(){super(...arguments);i(this,"fields",this.config.intervalConfig.fields);i(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${r}${n}`}}i(vi,Gt,"PgInterval");function ea(t,e={}){const{name:r,config:n}=I(t,e);return new Ci(r,n)}var Xt,Yt;class Li extends(Yt=f,Xt=o,Yt){constructor(e){super(e,"json","PgJson")}build(e){return new Bi(e,this.config)}}i(Li,Xt,"PgJsonBuilder");var Jt,Ht;class Bi extends(Ht=p,Jt=o,Ht){constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}i(Bi,Jt,"PgJson");function ta(t){return new Li(t??"")}var Wt,Zt;class Mi extends(Zt=f,Wt=o,Zt){constructor(e){super(e,"json","PgJsonb")}build(e){return new qi(e,this.config)}}i(Mi,Wt,"PgJsonbBuilder");var kt,er;class qi extends(er=p,kt=o,er){constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}i(qi,kt,"PgJsonb");function z(t){return new Mi(t??"")}var tr,rr;class Vi extends(rr=f,tr=o,rr){constructor(e){super(e,"array","PgLine")}build(e){return new Fi(e,this.config)}}i(Vi,tr,"PgLineBuilder");var nr,ir;class Fi extends(ir=p,nr=o,ir){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,l]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(l)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}i(Fi,nr,"PgLine");var sr,ar;class zi extends(ar=f,sr=o,ar){constructor(e){super(e,"json","PgLineABC")}build(e){return new Ui(e,this.config)}}i(zi,sr,"PgLineABCBuilder");var or,lr;class Ui extends(lr=p,or=o,lr){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,l]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(l)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}i(Ui,or,"PgLineABC");function ra(t,e){const{name:r,config:n}=I(t,e);return!(n!=null&&n.mode)||n.mode==="tuple"?new Vi(r):new zi(r)}var ur,cr;class Qi extends(cr=f,ur=o,cr){constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ri(e,this.config)}}i(Qi,ur,"PgMacaddrBuilder");var dr,mr;class Ri extends(mr=p,dr=o,mr){getSQLType(){return"macaddr"}}i(Ri,dr,"PgMacaddr");function na(t){return new Qi(t??"")}var pr,gr;class Oi extends(gr=f,pr=o,gr){constructor(e){super(e,"string","PgMacaddr8")}build(e){return new ji(e,this.config)}}i(Oi,pr,"PgMacaddr8Builder");var fr,yr;class ji extends(yr=p,fr=o,yr){getSQLType(){return"macaddr8"}}i(ji,fr,"PgMacaddr8");function ia(t){return new Oi(t??"")}var hr,_r;class $i extends(_r=f,hr=o,_r){constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new Gi(e,this.config)}}i($i,hr,"PgNumericBuilder");var br,Nr;class Gi extends(Nr=p,br=o,Nr){constructor(r,n){super(r,n);i(this,"precision");i(this,"scale");this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}i(Gi,br,"PgNumeric");function Ki(t,e){const{name:r,config:n}=I(t,e);return new $i(r,n==null?void 0:n.precision,n==null?void 0:n.scale)}const Q=Ki;var Sr,Tr;class Xi extends(Tr=f,Sr=o,Tr){constructor(e){super(e,"array","PgPointTuple")}build(e){return new Yi(e,this.config)}}i(Xi,Sr,"PgPointTupleBuilder");var Pr,wr;class Yi extends(wr=p,Pr=o,wr){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}i(Yi,Pr,"PgPointTuple");var Ir,Ar;class Ji extends(Ar=f,Ir=o,Ar){constructor(e){super(e,"json","PgPointObject")}build(e){return new Hi(e,this.config)}}i(Ji,Ir,"PgPointObjectBuilder");var Dr,xr;class Hi extends(xr=p,Dr=o,xr){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}i(Hi,Dr,"PgPointObject");function sa(t,e){const{name:r,config:n}=I(t,e);return!(n!=null&&n.mode)||n.mode==="tuple"?new Xi(r):new Ji(r)}function aa(t){const e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function ae(t,e){const r=new ArrayBuffer(8),n=new DataView(r);for(let l=0;l<8;l++)n.setUint8(l,t[e+l]);return n.getFloat64(0,!0)}function Wi(t){const e=aa(t);let r=0;const n=e[r];r+=1;const l=new DataView(e.buffer),u=l.getUint32(r,n===1);if(r+=4,u&536870912&&(l.getUint32(r,n===1),r+=4),(u&65535)===1){const d=ae(e,r);r+=8;const h=ae(e,r);return r+=8,[d,h]}throw new Error("Unsupported geometry type")}var Er,Cr;class Zi extends(Cr=f,Er=o,Cr){constructor(e){super(e,"array","PgGeometry")}build(e){return new ki(e,this.config)}}i(Zi,Er,"PgGeometryBuilder");var vr,Lr;class ki extends(Lr=p,vr=o,Lr){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Wi(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}i(ki,vr,"PgGeometry");var Br,Mr;class es extends(Mr=f,Br=o,Mr){constructor(e){super(e,"json","PgGeometryObject")}build(e){return new ts(e,this.config)}}i(es,Br,"PgGeometryObjectBuilder");var qr,Vr;class ts extends(Vr=p,qr=o,Vr){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){const r=Wi(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}i(ts,qr,"PgGeometryObject");function oa(t,e){const{name:r,config:n}=I(t,e);return!(n!=null&&n.mode)||n.mode==="tuple"?new Zi(r):new es(r)}var Fr,zr;class rs extends(zr=f,Fr=o,zr){constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new ns(e,this.config)}}i(rs,Fr,"PgRealBuilder");var Ur,Qr;class ns extends(Qr=p,Ur=o,Qr){constructor(r,n){super(r,n);i(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}i(ns,Ur,"PgReal");function la(t){return new rs(t??"")}var Rr,Or;class is extends(Or=f,Rr=o,Or){constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ss(e,this.config)}}i(is,Rr,"PgSerialBuilder");var jr,$r;class ss extends($r=p,jr=o,$r){getSQLType(){return"serial"}}i(ss,jr,"PgSerial");function x(t){return new is(t??"")}var Gr,Kr;class as extends(Kr=U,Gr=o,Kr){constructor(e){super(e,"number","PgSmallInt")}build(e){return new os(e,this.config)}}i(as,Gr,"PgSmallIntBuilder");var Xr,Yr;class os extends(Yr=p,Xr=o,Yr){constructor(){super(...arguments);i(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}i(os,Xr,"PgSmallInt");function ua(t){return new as(t??"")}var Jr,Hr;class ls extends(Hr=f,Jr=o,Hr){constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new us(e,this.config)}}i(ls,Jr,"PgSmallSerialBuilder");var Wr,Zr;class us extends(Zr=p,Wr=o,Zr){getSQLType(){return"smallserial"}}i(us,Wr,"PgSmallSerial");function ca(t){return new ls(t??"")}var kr,en;class cs extends(en=f,kr=o,en){constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new ds(e,this.config)}}i(cs,kr,"PgTextBuilder");var tn,rn;class ds extends(rn=p,tn=o,rn){constructor(){super(...arguments);i(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}i(ds,tn,"PgText");function s(t,e={}){const{name:r,config:n}=I(t,e);return new cs(r,n)}var nn,sn;class ms extends(sn=F,nn=o,sn){constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}build(e){return new ps(e,this.config)}}i(ms,nn,"PgTimeBuilder");var an,on;class ps extends(on=p,an=o,on){constructor(r,n){super(r,n);i(this,"withTimezone");i(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}i(ps,an,"PgTime");function da(t,e={}){const{name:r,config:n}=I(t,e);return new ms(r,n.withTimezone??!1,n.precision)}var ln,un;class gs extends(un=F,ln=o,un){constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new fs(e,this.config)}}i(gs,ln,"PgTimestampBuilder");var cn,dn;class fs extends(dn=p,cn=o,dn){constructor(r,n){super(r,n);i(this,"withTimezone");i(this,"precision");i(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));i(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}i(fs,cn,"PgTimestamp");var mn,pn;class ys extends(pn=F,mn=o,pn){constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new hs(e,this.config)}}i(ys,mn,"PgTimestampStringBuilder");var gn,fn;class hs extends(fn=p,gn=o,fn){constructor(r,n){super(r,n);i(this,"withTimezone");i(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}i(hs,gn,"PgTimestampString");function g(t,e={}){const{name:r,config:n}=I(t,e);return(n==null?void 0:n.mode)==="string"?new ys(r,n.withTimezone??!1,n.precision):new gs(r,(n==null?void 0:n.withTimezone)??!1,n==null?void 0:n.precision)}var yn,hn;class _s extends(hn=f,yn=o,hn){constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default($`gen_random_uuid()`)}build(e){return new bs(e,this.config)}}i(_s,yn,"PgUUIDBuilder");var _n,bn;class bs extends(bn=p,_n=o,bn){getSQLType(){return"uuid"}}i(bs,_n,"PgUUID");function Ns(t){return new _s(t??"")}var Nn,Sn;class Ss extends(Sn=f,Nn=o,Sn){constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Ts(e,this.config)}}i(Ss,Nn,"PgVarcharBuilder");var Tn,Pn;class Ts extends(Pn=p,Tn=o,Pn){constructor(){super(...arguments);i(this,"length",this.config.length);i(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}i(Ts,Tn,"PgVarchar");function ma(t,e={}){const{name:r,config:n}=I(t,e);return new Ss(r,n)}var wn,In;class Ps extends(In=f,wn=o,In){constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new ws(e,this.config)}}i(Ps,wn,"PgBinaryVectorBuilder");var An,Dn;class ws extends(Dn=p,An=o,Dn){constructor(){super(...arguments);i(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}i(ws,An,"PgBinaryVector");function pa(t,e){const{name:r,config:n}=I(t,e);return new Ps(r,n)}var xn,En;class Is extends(En=f,xn=o,En){constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){return new As(e,this.config)}}i(Is,xn,"PgHalfVectorBuilder");var Cn,vn;class As extends(vn=p,Cn=o,vn){constructor(){super(...arguments);i(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}i(As,Cn,"PgHalfVector");function ga(t,e){const{name:r,config:n}=I(t,e);return new Is(r,n)}var Ln,Bn;class Ds extends(Bn=f,Ln=o,Bn){constructor(e,r){super(e,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(e){return new xs(e,this.config)}}i(Ds,Ln,"PgSparseVectorBuilder");var Mn,qn;class xs extends(qn=p,Mn=o,qn){constructor(){super(...arguments);i(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}i(xs,Mn,"PgSparseVector");function fa(t,e){const{name:r,config:n}=I(t,e);return new Ds(r,n)}var Vn,Fn;class Es extends(Fn=f,Vn=o,Fn){constructor(e,r){super(e,"array","PgVector"),this.config.dimensions=r.dimensions}build(e){return new Cs(e,this.config)}}i(Es,Vn,"PgVectorBuilder");var zn,Un;class Cs extends(Un=p,zn=o,Un){constructor(){super(...arguments);i(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}i(Cs,zn,"PgVector");function ya(t,e){const{name:r,config:n}=I(t,e);return new Es(r,n)}function ha(){return{bigint:Xs,bigserial:Ys,boolean:T,char:Js,cidr:Hs,customType:Ws,date:Zs,doublePrecision:R,inet:ks,integer:m,interval:ea,json:ta,jsonb:z,line:ra,macaddr:na,macaddr8:ia,numeric:Ki,point:sa,geometry:oa,real:la,serial:x,smallint:ua,smallserial:ca,text:s,time:da,timestamp:g,uuid:Ns,varchar:ma,bit:pa,halfvec:ga,sparsevec:fa,vector:ya}}const Z=Symbol.for("drizzle:PgInlineForeignKeys"),oe=Symbol.for("drizzle:EnableRLS");var Qn,Rn,On,jn,$n;class K extends($n=D,jn=o,On=Z,Rn=oe,Qn=D.Symbol.ExtraConfigBuilder,$n){constructor(){super(...arguments);i(this,On,[]);i(this,Rn,!1);i(this,Qn)}}i(K,jn,"PgTable"),i(K,"Symbol",Object.assign({},D.Symbol,{InlineForeignKeys:Z,EnableRLS:oe}));function _a(t,e,r,n,l=t){const u=new K(t,n,l),d=typeof e=="function"?e(ha()):e,h=Object.fromEntries(Object.entries(d).map(([c,L])=>{const _=L;_.setName(c);const w=_.build(u);return u[Z].push(..._.buildForeignKeys(w,u)),[c,w]})),y=Object.fromEntries(Object.entries(d).map(([c,L])=>{const _=L;_.setName(c);const w=_.buildExtraConfigColumn(u);return[c,w]})),b=Object.assign(u,h);return b[D.Symbol.Columns]=h,b[D.Symbol.ExtraConfigColumns]=y,Object.assign(b,{enableRLS:()=>(b[K.Symbol.EnableRLS]=!0,b)})}const E=(t,e,r)=>_a(t,e,r,void 0),N={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function S(t,e){return e.includes(t.columnType)}function ba(t){return"enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0}const Na=a.union([a.string(),a.number(),a.boolean(),a.null()]),Sa=a.union([Na,a.record(a.any()),a.array(a.any())]),Ta=a.custom(t=>t instanceof Buffer);function vs(t,e){const r=(e==null?void 0:e.zodInstance)??a,n=(e==null?void 0:e.coerce)??{};let l;return ba(t)&&(l=t.enumValues.length?r.enum(t.enumValues):r.string()),l||(S(t,["PgGeometry","PgPointTuple"])?l=r.tuple([r.number(),r.number()]):S(t,["PgGeometryObject","PgPointObject"])?l=r.object({x:r.number(),y:r.number()}):S(t,["PgHalfVector","PgVector"])?(l=r.array(r.number()),l=t.dimensions?l.length(t.dimensions):l):S(t,["PgLine"])?l=r.tuple([r.number(),r.number(),r.number()]):S(t,["PgLineABC"])?l=r.object({a:r.number(),b:r.number(),c:r.number()}):S(t,["PgArray"])?(l=r.array(vs(t.baseColumn,r)),l=t.size?l.length(t.size):l):t.dataType==="array"?l=r.array(r.any()):t.dataType==="number"?l=Pa(t,r,n):t.dataType==="bigint"?l=wa(t,r,n):t.dataType==="boolean"?l=n===!0||n.boolean?r.coerce.boolean():r.boolean():t.dataType==="date"?l=n===!0||n.date?r.coerce.date():r.date():t.dataType==="string"?l=Ia(t,r,n):t.dataType==="json"?l=Sa:t.dataType==="custom"?l=r.any():t.dataType==="buffer"&&(l=Ta)),l||(l=r.any()),l}function Pa(t,e,r){let n=t.getSQLType().includes("unsigned"),l,u,d=!1;S(t,["MySqlTinyInt","SingleStoreTinyInt"])?(l=n?0:N.INT8_MIN,u=n?N.INT8_UNSIGNED_MAX:N.INT8_MAX,d=!0):S(t,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(l=n?0:N.INT16_MIN,u=n?N.INT16_UNSIGNED_MAX:N.INT16_MAX,d=!0):S(t,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(l=n?0:N.INT24_MIN,u=n?N.INT24_UNSIGNED_MAX:N.INT24_MAX,d=S(t,["MySqlMediumInt","SingleStoreMediumInt"])):S(t,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(l=n?0:N.INT32_MIN,u=n?N.INT32_UNSIGNED_MAX:N.INT32_MAX,d=!0):S(t,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(l=n?0:N.INT48_MIN,u=n?N.INT48_UNSIGNED_MAX:N.INT48_MAX):S(t,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||S(t,["MySqlSerial","SingleStoreSerial"]),l=n?0:Number.MIN_SAFE_INTEGER,u=Number.MAX_SAFE_INTEGER,d=!0):S(t,["MySqlYear","SingleStoreYear"])?(l=1901,u=2155,d=!0):(l=Number.MIN_SAFE_INTEGER,u=Number.MAX_SAFE_INTEGER);let h=r===!0||r!=null&&r.number?e.coerce.number():e.number();return h=h.min(l).max(u),d?h.int():h}function wa(t,e,r){const n=t.getSQLType().includes("unsigned"),l=n?0n:N.INT64_MIN,u=n?N.INT64_UNSIGNED_MAX:N.INT64_MAX;return(r===!0||r!=null&&r.bigint?e.coerce.bigint():e.bigint()).min(l).max(u)}function Ia(t,e,r){if(S(t,["PgUUID"]))return e.string().uuid();let n,l,u=!1;S(t,["PgVarchar","SQLiteText"])?n=t.length:S(t,["MySqlVarChar","SingleStoreVarChar"])?n=t.length??N.INT16_UNSIGNED_MAX:S(t,["MySqlText","SingleStoreText"])&&(t.textType==="longtext"?n=N.INT32_UNSIGNED_MAX:t.textType==="mediumtext"?n=N.INT24_UNSIGNED_MAX:t.textType==="text"?n=N.INT16_UNSIGNED_MAX:n=N.INT8_UNSIGNED_MAX),S(t,["PgChar","MySqlChar","SingleStoreChar"])&&(n=t.length,u=!0),S(t,["PgBinaryVector"])&&(l=/^[01]+$/,n=t.dimensions);let d=r===!0||r!=null&&r.string?e.coerce.string():e.string();return d=l?d.regex(l):d,n&&u?d.length(n):n?d.max(n):d}function Ls(t){return kn(t)?Gs(t):Ks(t)}function Bs(t,e,r,n){const l={};for(const[u,d]of Object.entries(t)){if(!A(d,V)&&!A(d,P)&&!A(d,P.Aliased)&&typeof d=="object"){const L=kn(d)||$s(d)?Ls(d):d;l[u]=Bs(L,e[u]??{},r,n);continue}const h=e[u];if(h!==void 0&&typeof h!="function"){l[u]=h;continue}const y=A(d,V)?d:void 0,b=y?vs(y,n):a.any(),c=typeof h=="function"?h(b):b;r.never(y)||(l[u]=c,y&&(r.nullable(y)&&(l[u]=l[u].nullable()),r.optional(y)&&(l[u]=l[u].optional())))}return a.object(l)}const Aa={never:t=>{var e,r;return((e=t==null?void 0:t.generated)==null?void 0:e.type)==="always"||((r=t==null?void 0:t.generatedIdentity)==null?void 0:r.type)==="always"},optional:t=>!t.notNull||t.notNull&&t.hasDefault,nullable:t=>!t.notNull},v=(t,e)=>{const r=Ls(t);return Bs(r,e??{},Aa)},Da=E("contacts",{id:x("id").primaryKey(),name:s("name").notNull(),email:s("email").notNull(),phone:s("phone"),message:s("message").notNull(),source:s("source").notNull().default("contact_form"),ipAddress:s("ip_address"),userAgent:s("user_agent"),status:s("status").notNull().default("unread"),priority:s("priority").default("normal"),subject:s("subject"),createdAt:g("created_at").defaultNow().notNull(),readAt:g("read_at"),readBy:m("read_by"),repliedAt:g("replied_at"),repliedBy:m("replied_by")});v(Da).omit({id:!0,status:!0,createdAt:!0,readAt:!0,readBy:!0,repliedAt:!0,repliedBy:!0});const xa=E("notifications",{id:x("id").primaryKey(),type:s("type").notNull(),title:s("title").notNull(),message:s("message").notNull(),read:T("read").notNull().default(!1),created_at:g("created_at").defaultNow().notNull(),data:z("data")});v(xa).omit({id:!0,created_at:!0});const Ea=E("agent_tasks",{id:x("id").primaryKey(),userId:m("user_id").notNull(),title:s("title").notNull(),description:s("description"),dueDate:g("due_date"),priority:s("priority").default("normal"),status:s("status").default("pending"),relatedType:s("related_type"),relatedId:m("related_id"),remindAt:g("remind_at"),reminderSent:T("reminder_sent").default(!1),createdAt:g("created_at").defaultNow().notNull(),updatedAt:g("updated_at"),completedAt:g("completed_at")}),Ca=v(Ea).omit({id:!0,createdAt:!0,updatedAt:!0,completedAt:!0});Ca.extend({title:a.string().min(3,"Le titre doit contenir au moins 3 caractères"),priority:a.enum(["high","medium","normal","low"],{errorMap:()=>({message:"Priorité invalide"})}).default("normal"),status:a.enum(["pending","in_progress","completed","canceled"],{errorMap:()=>({message:"Statut invalide"})}).default("pending"),dueDate:a.string().optional().or(a.date()).nullable(),remindAt:a.string().optional().or(a.date()).nullable()});E("performance_metrics",{id:x("id").primaryKey(),timestamp:g("timestamp").defaultNow().notNull(),created_at:g("created_at").defaultNow().notNull(),route:s("route").notNull(),loadTime:m("load_time").notNull(),memoryUsage:m("memory_usage"),cpuUsage:Q("cpu_usage",{precision:5,scale:2}),userAgent:s("user_agent"),userId:m("user_id"),statusCode:m("status_code"),requestSize:m("request_size"),responseSize:m("response_size"),serverInfo:z("server_info")});a.object({route:a.string(),loadTime:a.number().int(),memoryUsage:a.number().int().nullable().optional(),cpuUsage:a.number().nullable().optional(),userAgent:a.string().nullable().optional(),userId:a.number().int().nullable().optional(),statusCode:a.number().int().nullable().optional(),requestSize:a.number().int().nullable().optional(),responseSize:a.number().int().nullable().optional(),serverInfo:a.any().optional()});const va=E("users",{id:x("id").primaryKey(),username:s("username").notNull().unique(),password:s("password").notNull(),fullName:s("full_name").default("").notNull(),email:s("email").default("admin@example.com").notNull(),role:s("role").notNull().default("agent"),permissions:z("permissions"),active:T("active").notNull().default(!0),lastLogin:g("last_login"),createdAt:g("created_at").defaultNow().notNull(),createdBy:m("created_by"),onboardingCompleted:T("onboarding_completed").default(!1),smtpHost:s("smtp_host"),smtpPort:m("smtp_port"),smtpSecure:T("smtp_secure").default(!0),smtpUser:s("smtp_user"),smtpPassword:s("smtp_password"),smtpFromEmail:s("smtp_from_email"),smtpEnabled:T("smtp_enabled").default(!1),commissionEnabled:T("commission_enabled").default(!0),commissionRate:Q("commission_rate").default("14")}),La=v(va).pick({username:!0,password:!0,fullName:!0,email:!0,role:!0,active:!0,permissions:!0,smtpHost:!0,smtpPort:!0,smtpSecure:!0,smtpUser:!0,smtpPassword:!0,smtpFromEmail:!0,smtpEnabled:!0,commissionEnabled:!0,commissionRate:!0,onboardingCompleted:!0});La.extend({username:a.string().min(3,"Le nom d'utilisateur doit contenir au moins 3 caractères"),password:a.string().min(6,"Le mot de passe doit contenir au moins 6 caractères"),fullName:a.string().min(1,"Le nom complet est requis"),email:a.string().email("Adresse email invalide"),role:a.enum(["admin","manager","agent"],{errorMap:()=>({message:"Rôle invalide"})}),active:a.boolean().default(!0),permissions:a.array(a.object({page:a.string(),canView:a.boolean(),canEdit:a.boolean()})).default([]),smtpHost:a.string().optional().or(a.literal("")),smtpPort:a.number().int().positive().optional().or(a.literal(0)).or(a.literal(587)),smtpUser:a.string().optional().or(a.literal("")),smtpPassword:a.string().optional().or(a.literal("")),smtpFromEmail:a.string().email("Adresse email d'expédition invalide").optional().or(a.literal("")),commissionRate:a.union([a.number(),a.string()]).transform(t=>typeof t=="number"?String(t):t).optional()});const Ba=E("service_requests",{id:x("id").primaryKey(),referenceNumber:s("reference_number").notNull().unique(),leadId:m("lead_id"),clientType:s("client_type").notNull(),name:s("name").notNull(),email:s("email").notNull(),phone:s("phone").notNull(),company:s("company"),siret:s("siret"),serviceType:s("service_type").notNull(),requestType:s("request_type").notNull(),otherRequestTypeDesc:s("other_request_type_desc"),buildingType:s("building_type").notNull(),terrainViabilise:s("terrain_viabilise"),projectStatus:s("project_status").notNull(),permitNumber:s("permit_number"),permitDeliveryDate:s("permit_delivery_date"),address:s("address").notNull(),addressComplement:s("address_complement"),city:s("city").notNull(),postalCode:s("postal_code").notNull(),cadastralReference:s("cadastral_reference"),powerRequired:s("power_required").notNull(),phaseType:s("phase_type"),desiredCompletionDate:s("desired_completion_date"),billingAddress:s("billing_address"),billingCity:s("billing_city"),billingPostalCode:s("billing_postal_code"),hasArchitect:T("has_architect"),architectName:s("architect_name"),architectPhone:s("architect_phone"),architectEmail:s("architect_email"),comments:s("comments"),estimatedPrice:s("estimated_price"),status:s("status").default("new").notNull(),category:s("category"),priceEstimate:s("price_estimate"),aiAnalysis:s("ai_analysis"),customerResponse:s("customer_response"),paymentStatus:s("payment_status"),paymentId:s("payment_id"),paymentAmount:Q("payment_amount",{precision:10,scale:2}),paymentMethod:s("payment_method"),paymentDate:g("payment_date"),cardBrand:s("card_brand"),cardLast4:s("card_last4"),cardExpMonth:m("card_exp_month"),cardExpYear:m("card_exp_year"),billingName:s("billing_name"),bankName:s("bank_name"),paymentError:s("payment_error"),gclid:s("gclid"),stripePaymentIntentId:s("stripe_payment_intent_id"),stripeCheckoutSessionId:s("stripe_checkout_session_id"),orderId:s("order_id"),ipAddress:s("ip_address"),userAgent:s("user_agent"),assignedTo:m("assigned_to"),assignedAt:g("assigned_at"),validatedBy:m("validated_by"),validatedAt:g("validated_at"),scheduledDate:g("scheduled_date"),scheduledTime:s("scheduled_time"),enedisReferenceNumber:s("enedis_reference_number"),notes:s("notes"),completedAt:g("completed_at"),cancellationReason:s("cancellation_reason"),hasReminderSent:T("has_reminder_sent").default(!1),createdAt:g("created_at").defaultNow().notNull(),updatedAt:g("updated_at").defaultNow().notNull(),lastUpdatedBy:m("last_updated_by")}),Ma=v(Ba).omit({id:!0,referenceNumber:!0,leadId:!0,createdAt:!0,updatedAt:!0,status:!0,estimatedPrice:!0,category:!0,priceEstimate:!0,aiAnalysis:!0,customerResponse:!0,assignedTo:!0,assignedAt:!0,validatedBy:!0,validatedAt:!0,scheduledDate:!0,scheduledTime:!0,enedisReferenceNumber:!0,notes:!0,completedAt:!0,cancellationReason:!0,lastUpdatedBy:!0,paymentStatus:!0,paymentId:!0,paymentAmount:!0,paymentMethod:!0,paymentDate:!0,cardBrand:!0,cardLast4:!0,cardExpMonth:!0,cardExpYear:!0,billingName:!0,bankName:!0,paymentError:!0,gclid:!0,stripePaymentIntentId:!0,stripeCheckoutSessionId:!0,orderId:!0});Ma.extend({clientType:a.enum(["particulier","professionnel","collectivite"],{errorMap:()=>({message:"Veuillez sélectionner un type de client"})}),name:a.string().min(1,"Le nom est requis"),email:a.string().email("Adresse email invalide"),phone:a.string().regex(/^\+?[0-9\s\-\(\)]{10,20}$/,"Numéro de téléphone invalide"),company:a.string().optional().or(a.literal("")),siret:a.string().optional().or(a.literal("")).transform(t=>t||""),serviceType:a.enum(["electricity","solar","particulier","professionnel"]),requestType:a.enum(["new_connection","power_upgrade","temporary_connection","relocation","technical_visit","other"],{errorMap:()=>({message:"Veuillez sélectionner un type de demande"})}),otherRequestTypeDesc:a.string().optional().or(a.literal("")),buildingType:a.enum(["individual_house","apartment_building","commercial","industrial","agricultural","public","terrain"],{errorMap:()=>({message:"Veuillez sélectionner un type de bâtiment"})}),terrainViabilise:a.enum(["viabilise","non_viabilise"]).optional().or(a.literal("")),projectStatus:a.enum(["planning","permit_pending","permit_approved","construction_started","construction_completed"],{errorMap:()=>({message:"Veuillez sélectionner l'état du projet"})}),permitNumber:a.string().optional().or(a.literal("")),permitDeliveryDate:a.string().optional().or(a.literal("")),address:a.string().min(1,"L'adresse est requise"),addressComplement:a.string().optional().or(a.literal("")),city:a.string().min(1,"La ville est requise"),postalCode:a.string().regex(/^[0-9]{5}$/,"Code postal invalide (5 chiffres)"),cadastralReference:a.string().optional().or(a.literal("")),powerRequired:a.string().min(1,"La puissance demandée est requise").transform(t=>t==="36-jaune"?"36":t),phaseType:a.enum(["monophase","triphase","inconnu"],{errorMap:()=>({message:"Veuillez sélectionner un type de phase"})}).optional().or(a.literal("")),desiredCompletionDate:a.string().optional().or(a.literal("")),useDifferentBillingAddress:a.boolean().optional().default(!1),billingAddress:a.string().optional().or(a.literal("")),billingCity:a.string().optional().or(a.literal("")),billingPostalCode:a.string().optional().or(a.literal("")).or(a.string().regex(/^[0-9]{5}$/,"Code postal invalide (5 chiffres)").optional()),hasArchitect:a.boolean().optional(),architectName:a.string().optional().or(a.literal("")),architectPhone:a.string().optional().or(a.literal("")),architectEmail:a.string().email("Adresse email invalide").optional().or(a.literal("")),comments:a.string().optional().or(a.literal(""))});const qa=E("leads",{id:x("id").primaryKey(),sessionToken:Ns("session_token").notNull().unique().defaultRandom(),referenceNumber:s("reference_number"),firstName:s("first_name"),lastName:s("last_name"),email:s("email"),phone:s("phone"),clientType:s("client_type"),company:s("company"),siret:s("siret"),serviceType:s("service_type").default("electricity"),requestType:s("request_type"),otherRequestTypeDesc:s("other_request_type_desc"),buildingType:s("building_type"),terrainViabilise:s("terrain_viabilise"),projectStatus:s("project_status"),permitNumber:s("permit_number"),permitDeliveryDate:s("permit_delivery_date"),address:s("address"),addressComplement:s("address_complement"),city:s("city"),postalCode:s("postal_code"),cadastralReference:s("cadastral_reference"),powerRequired:s("power_required"),phaseType:s("phase_type"),desiredCompletionDate:s("desired_completion_date"),billingAddress:s("billing_address"),billingCity:s("billing_city"),billingPostalCode:s("billing_postal_code"),hasArchitect:T("has_architect"),architectName:s("architect_name"),architectPhone:s("architect_phone"),architectEmail:s("architect_email"),comments:s("comments"),vatRate:s("vat_rate"),termsAccepted:T("terms_accepted").default(!1),immediatePurchaseAccepted:T("immediate_purchase_accepted").default(!1),connectionDelay:s("connection_delay"),completedSteps:m("completed_steps").default(0),isCompleted:T("is_completed").default(!1),convertedToRequest:T("converted_to_request").default(!1),convertedRequestId:m("converted_request_id"),assignedTo:m("assigned_to"),ipAddress:s("ip_address"),userAgent:s("user_agent"),createdAt:g("created_at").defaultNow().notNull(),updatedAt:g("updated_at").defaultNow().notNull(),lastTouchedAt:g("last_touched_at").defaultNow().notNull(),status:s("status").default("new"),statusUpdatedAt:g("status_updated_at"),statusUpdatedBy:m("status_updated_by"),callbackDate:g("callback_date"),callbackNotes:s("callback_notes"),hasContract:T("has_contract").default(!1),paymentStatus:s("payment_status"),paymentId:s("payment_id"),paymentAmount:Q("payment_amount",{precision:10,scale:2}),paymentMethod:s("payment_method"),paymentDate:g("payment_date"),cardBrand:s("card_brand"),cardLast4:s("card_last4"),cardExpMonth:m("card_exp_month"),cardExpYear:m("card_exp_year"),billingName:s("billing_name"),bankName:s("bank_name"),paymentError:s("payment_error")});v(qa).omit({id:!0,sessionToken:!0,completedSteps:!0,isCompleted:!0,convertedToRequest:!0,convertedRequestId:!0,assignedTo:!0,createdAt:!0,updatedAt:!0,lastTouchedAt:!0,status:!0,statusUpdatedAt:!0,statusUpdatedBy:!0,callbackDate:!0,callbackNotes:!0,paymentStatus:!0,paymentId:!0,paymentAmount:!0,paymentMethod:!0,paymentDate:!0,cardBrand:!0,cardLast4:!0,cardExpMonth:!0,cardExpYear:!0,billingName:!0,bankName:!0,paymentError:!0});const Ga={NEW:"new",INTERESTED:"interested",NOT_INTERESTED:"not_interested",NO_RESPONSE:"no_response",CALLBACK_SCHEDULED:"callback_scheduled",PROCESS_COMPLETE:"process_complete"},Ka={NEW:"new",PENDING:"pending",ASSIGNED:"assigned",VALIDATED:"validated",IN_PROGRESS:"in_progress",CONTACT_PENDING:"contact_pending",DOCUMENTS_PENDING:"documents_pending",ENEDIS_SUBMITTED:"enedis_submitted",SCHEDULED:"scheduled",COMPLETED:"completed",PROCESS_COMPLETE:"process_complete",CANCELLED:"cancelled",PAYMENT_PENDING:"payment_pending",PAID:"paid",PAYMENT_FAILED:"payment_failed"},Xa={CREATE:"create",UPDATE:"update",DELETE:"delete",ASSIGN:"assign",VALIDATE:"validate",SCHEDULE:"schedule",COMPLETE:"complete",CANCEL:"cancel",LOGIN:"login",LOGOUT:"logout",PAYMENT_CONFIRMED:"payment_confirmed",PAYMENT_FAILED:"payment_failed",PAYMENT_REMINDER_SENT:"payment_reminder_sent",PAYMENT_INITIATED:"payment_initiated",PAYMENT_PROCESSED:"payment_processed",CERTIFICATE_GENERATED:"certificate_generated",EMAIL_SENT:"email_sent",SMTP_CONFIG_UPDATED:"smtp_config_updated",SMTP_TEST:"smtp_test",APPOINTMENT_REMINDER_SENT:"appointment_reminder_sent",TASK_CREATED:"task_created",TASK_UPDATED:"task_updated",TASK_COMPLETED:"task_completed",TASK_DELETED:"task_deleted"},Va=E("system_configs",{id:x("id").primaryKey(),configKey:s("config_key").notNull().unique(),configValue:s("config_value"),configGroup:s("config_group").notNull(),isSecret:T("is_secret").default(!1).notNull(),description:s("description"),updatedAt:g("updated_at").defaultNow().notNull(),updatedBy:m("updated_by")});v(Va).omit({id:!0,updatedAt:!0});const Fa=E("email_templates",{id:x("id").primaryKey(),templateKey:s("template_key").notNull().unique(),name:s("name").notNull(),subject:s("subject").notNull(),htmlContent:s("html_content").notNull(),textContent:s("text_content").notNull(),description:s("description"),variables:s("variables"),active:T("active").default(!0).notNull(),createdAt:g("created_at").defaultNow().notNull(),updatedAt:g("updated_at").defaultNow().notNull(),updatedBy:m("updated_by")});v(Fa).omit({id:!0,createdAt:!0,updatedAt:!0});const za=E("ui_animations",{id:x("id").primaryKey(),name:s("name").notNull(),type:s("type").notNull(),category:s("category").notNull(),component:s("component").notNull(),enabled:T("enabled").default(!0).notNull(),default:T("default").default(!1).notNull(),config:z("config").default({}).notNull(),pages:s("pages").array(),lastModifiedAt:g("last_modified_at").defaultNow().notNull(),lastModifiedBy:m("last_modified_by"),createdAt:g("created_at").defaultNow().notNull()}),Ua=v(za).omit({id:!0,lastModifiedAt:!0,createdAt:!0});Ua.extend({name:a.string().min(3,"Le nom doit contenir au moins 3 caractères"),type:a.enum(["spinner","pulse","progress","dots","circuit","wave"],{errorMap:()=>({message:"Type d'animation non valide"})}),category:a.enum(["form","payment","loading","analysis","processing"],{errorMap:()=>({message:"Catégorie non valide"})}),component:a.string().min(1,"Le composant est requis"),enabled:a.boolean(),default:a.boolean()});const Qa=E("payments",{id:x("id").primaryKey(),paymentId:s("payment_id").notNull(),referenceNumber:s("reference_number").notNull(),amount:Q("amount",{precision:10,scale:2}).notNull(),status:s("status").notNull().default("pending"),method:s("method").default("card"),customerName:s("customer_name"),customerEmail:s("customer_email"),cardBrand:s("card_brand"),cardLast4:s("card_last4"),cardExpMonth:m("card_exp_month"),cardExpYear:m("card_exp_year"),billingName:s("billing_name"),paymentMethod:s("payment_method"),metadata:z("metadata"),errorMessage:s("error_message"),createdAt:g("created_at").defaultNow().notNull(),updatedAt:g("updated_at").defaultNow().notNull(),createdBy:m("created_by")});v(Qa).omit({id:!0,createdAt:!0,updatedAt:!0});const Ra=E("agent_performance_metrics",{id:x("id").primaryKey(),userId:m("user_id").notNull(),periodStart:g("period_start",{mode:"string"}).notNull(),periodEnd:g("period_end",{mode:"string"}).notNull(),leadsReceived:m("leads_received").default(0),leadsConverted:m("leads_converted").default(0),leadsConversionRate:R("leads_conversion_rate").default(0),paymentsProcessed:m("payments_processed").default(0),paymentsAmount:m("payments_amount").default(0),commissionsEarned:m("commissions_earned").default(0),taskCompletionRate:R("task_completion_rate").default(0),averageResponseTime:R("average_response_time").default(0),appointmentsScheduled:m("appointments_scheduled").default(0),clientsAcquired:m("clients_acquired").default(0),qualityScore:m("quality_score").default(0),efficiency:m("efficiency").default(0),dailyActivity:s("daily_activity"),createdAt:g("created_at",{mode:"string"}).notNull(),updatedAt:g("updated_at",{mode:"string"})});v(Ra,{dailyActivity:a.string().optional()}).omit({id:!0});const Oa=E("activity_logs",{id:x("id").primaryKey(),userId:m("user_id").notNull(),action:s("action").notNull(),entityType:s("entity_type").notNull(),entityId:m("entity_id").notNull(),details:s("details"),createdAt:g("created_at").defaultNow().notNull(),ipAddress:s("ip_address")});v(Oa).omit({id:!0,createdAt:!0});export{Xa as A,Ga as L,Ka as R};
