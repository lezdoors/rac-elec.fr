function a(){if(typeof window>"u")return null;const t=new URLSearchParams(window.location.search),e=t.get("gclid");if(e){const n={utm_source:t.get("utm_source"),utm_medium:t.get("utm_medium"),utm_campaign:t.get("utm_campaign"),utm_term:t.get("utm_term"),utm_content:t.get("utm_content")};Object.values(n).some(o=>o!==null)&&localStorage.setItem("utm_data",JSON.stringify(n))}return e}function c(t){if(!t)return;const e={gclid:t,timestamp:Date.now(),source_url:window.location.href,landing_page:window.location.pathname};try{localStorage.setItem("gclid_data",JSON.stringify(e)),console.log("✅ GCLID stored successfully:",t)}catch(n){console.warn("⚠️ Failed to store GCLID:",n)}}function l(){if(typeof window>"u")return null;try{const t=localStorage.getItem("gclid_data");if(!t)return null;const e=JSON.parse(t),n=90*24*60*60*1e3;return Date.now()-e.timestamp<n?e.gclid:(localStorage.removeItem("gclid_data"),null)}catch(t){return console.warn("⚠️ Failed to retrieve stored GCLID:",t),null}}function d(){const t=a();return t?(c(t),t):l()}function r(){if(typeof window>"u")return;const t=a();t&&u(t)&&(c(t),window.gtag&&(window.gtag("config","GT-MJKTJGCK",{custom_map:{custom_parameter_1:"gclid"},gclid:t}),window.gtag("event","gclid_captured",{event_category:"attribution",event_label:t,custom_parameter_1:t})),console.log("✅ GCLID tracking initialized:",t)),s()}function f(t){const e=d();return e?{...t,gclid:e}:t}function m(t,e={}){if(typeof window>"u"||!window.gtag)return;const n=d(),o={send_to:t,...e};if(n&&u(n)){o.gclid=n;const i=g();i&&Object.assign(o,i),console.log("✅ Conversion tracked with GCLID:",n)}window.gtag("event","conversion",o)}function u(t){return!t||typeof t!="string"?!1:/^[A-Za-z0-9_-]{20,150}$/.test(t)}function g(){if(typeof window>"u")return null;try{const t=localStorage.getItem("utm_data");return t?JSON.parse(t):null}catch(t){return console.warn("⚠️ Failed to retrieve UTM data:",t),null}}function s(){l()}typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{r()}):r(),s());export{f as addGclidToConversion,s as cleanupExpiredGclid,d as getCurrentGclid,a as getGclidFromUrl,l as getStoredGclid,g as getStoredUtmData,r as initializeGclidTracking,u as isValidGclid,c as storeGclid,m as trackConversionWithGclid};
