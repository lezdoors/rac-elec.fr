import{c as ve,a as Ze,ak as _e,r as b,d as xe,t as ue,e as W,j as e,B as p,I as h,aI as es,Q as he,U as D,L as O,R as X,V as Y,W as Z,Y as _,a1 as ee,F as pe,M as V,C as $,f as r,g as l,h as c,i,k as m,m as j,X as ss,a3 as se,z as n,E as Pe,l as B}from"./index-g663vUVK.js";import{A as as,U as je,k as ge,E as ts,z as rs,F as ls,G as is,B as ae}from"./admin-layout-B6WT7_3S.js";import{T as te,a as re,b as g,c as S}from"./tabs-CNThh04_.js";import{T as ns,a as cs,b as fe,c as T,d as os,e as P}from"./table-CZxF2-N1.js";import{C as ds,a as ms,d as xs}from"./card-DKt_lSqV.js";import{S as ke,a as Ve,d as Te,b as Fe,c as z}from"./select-DnHSBIMC.js";import{S as K}from"./switch-CAt1Q3Ry.js";import{C as Ae}from"./checkbox-HyeMAHXF.js";import{A as us,a as hs}from"./avatar-BKw9Gpu7.js";import{B as ce}from"./badge-mb8jWdec.js";import{u as ps}from"./useQuery-CxeOtd0k.js";import{S as js}from"./search-DA0Cp5at.js";import{C as w}from"./chevron-down-DJUczB_1.js";import{A as Ne}from"./at-sign-u3nVu_Jo.js";import{f as gs}from"./formatDistanceToNow-C5o16ZMq.js";import{S as Le}from"./square-pen-BCYgAmpX.js";import{L as le}from"./lock-ZonZHxxt.js";import{T as Me}from"./trash-2-B-ghr_Mr.js";import{I as ie}from"./info-BlXdDKOW.js";import{E as fs}from"./eye-W5LFV4a-.js";import{C as Ue}from"./circle-alert-CF5U9qV8.js";import"./use-auth-BCNYZ3U0.js";import"./use-mobile-v6UDzhLX.js";import"./index-CNJcDG8K.js";import"./log-out-DJssqXLy.js";import"./file-text-DnLFp8lJ.js";import"./credit-card-8NOcrF_w.js";import"./settings-DZgC3gNK.js";import"./index-Bsk_hE0M.js";import"./index-bJ3AQevT.js";import"./separator-g3iHG0jd.js";import"./external-link-Dc1GsCBe.js";import"./index-DBhGjxYv.js";import"./endOfMonth-lsC2qiEG.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=ve("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=ve("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=ve("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),De={admin:[{page:"dashboard",canView:!0,canEdit:!0},{page:"leads",canView:!0,canEdit:!0},{page:"tasks",canView:!0,canEdit:!0},{page:"calendar",canView:!0,canEdit:!0},{page:"communications",canView:!0,canEdit:!0},{page:"contacts",canView:!0,canEdit:!0},{page:"stats",canView:!0,canEdit:!0},{page:"configuration",canView:!0,canEdit:!0},{page:"users",canView:!0,canEdit:!0},{page:"payments",canView:!0,canEdit:!0}],manager:[{page:"dashboard",canView:!0,canEdit:!0},{page:"leads",canView:!0,canEdit:!0},{page:"tasks",canView:!0,canEdit:!0},{page:"calendar",canView:!0,canEdit:!0},{page:"communications",canView:!0,canEdit:!0},{page:"contacts",canView:!0,canEdit:!0},{page:"stats",canView:!0,canEdit:!0},{page:"payments",canView:!0,canEdit:!0},{page:"configuration",canView:!1,canEdit:!1},{page:"users",canView:!1,canEdit:!1},{page:"animations",canView:!1,canEdit:!1},{page:"settings",canView:!1,canEdit:!1}],agent:[{page:"dashboard",canView:!0,canEdit:!1},{page:"leads",canView:!0,canEdit:!0},{page:"tasks",canView:!0,canEdit:!0},{page:"calendar",canView:!0,canEdit:!0},{page:"communications",canView:!0,canEdit:!0},{page:"contacts",canView:!0,canEdit:!0},{page:"stats",canView:!0,canEdit:!1},{page:"configuration",canView:!1,canEdit:!1},{page:"users",canView:!1,canEdit:!1},{page:"payments",canView:!1,canEdit:!1}]};function C(x){return De[x]||De.agent}const ze=n.object({username:n.string().min(3,"Le nom d'utilisateur doit contenir au moins 3 caractères"),email:n.string().email("Format d'email invalide"),password:n.string().min(6,"Le mot de passe doit contenir au moins 6 caractères"),fullName:n.string().optional(),role:n.string(),active:n.boolean().optional(),permissions:n.array(n.object({page:n.string(),canView:n.boolean(),canEdit:n.boolean()})).optional(),smtpHost:n.string().optional(),smtpPort:n.number().optional(),smtpSecure:n.boolean().optional(),smtpUser:n.string().optional(),smtpPassword:n.string().optional(),smtpFromEmail:n.string().email("Format d'email invalide").optional(),smtpEnabled:n.boolean().optional(),commissionEnabled:n.boolean().optional(),commissionRate:n.number().optional(),onboardingCompleted:n.boolean().optional()}),bs=n.object({newPassword:n.string().min(6,"Le mot de passe doit contenir au moins 6 caractères"),confirmPassword:n.string()}).refine(x=>x.newPassword===x.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]});function F({content:x,children:E}){return e.jsx(ts,{children:e.jsxs(rs,{children:[e.jsx(ls,{asChild:!0,children:E}),e.jsx(is,{className:"bg-black text-white text-xs p-2 rounded",children:e.jsx("p",{children:x})})]})})}function ne({permissions:x,onChange:E}){return e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map((o,f)=>e.jsxs("div",{className:"flex flex-col p-3 bg-white border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"font-medium text-gray-700 capitalize",children:o.page==="leads"?"Demandes":o.page==="tasks"?"Tâches":o.page==="calendar"?"Calendrier":o.page==="communications"?"Communications":o.page==="contacts"?"Contacts":o.page==="stats"?"Statistiques":o.page==="payments"?"Paiements":o.page==="configuration"?"Configuration":o.page==="users"?"Utilisateurs":o.page}),o.canView&&o.canEdit?e.jsx(ce,{className:"bg-blue-500 hover:bg-blue-600",children:"Tous droits"}):o.canView?e.jsx(ce,{className:"bg-green-500 hover:bg-green-600",children:"Lecture"}):e.jsx(ce,{variant:"outline",children:"Aucun accès"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{id:`view-${f}`,checked:o.canView,onCheckedChange:A=>{const v=[...x];v[f]={...o,canView:A,canEdit:A?o.canEdit:!1},E(v)}}),e.jsx(Pe,{htmlFor:`view-${f}`,className:"text-gray-600",children:"Afficher"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{id:`edit-${f}`,checked:o.canEdit,disabled:!o.canView,onCheckedChange:A=>{const v=[...x];v[f]={...o,canEdit:A},E(v)}}),e.jsx(Pe,{htmlFor:`edit-${f}`,className:"text-gray-600",children:"Modifier"})]})]})]},o.page))})})}function ta(){const{toast:x}=Ze(),E=_e(),[o,f]=b.useState(!1),[A,v]=b.useState(!1),[u,oe]=b.useState(null),[qe,Q]=b.useState(!1),[Ie,G]=b.useState(!1),[we,ye]=b.useState(null),[J,He]=b.useState("all"),[N,Ce]=b.useState({column:"createdAt",direction:"desc"}),[de,Oe]=b.useState(""),$e={column:"createdAt",direction:"desc"},Be=s=>{switch(s){case"admin":return"Administrateur";case"manager":return"Responsable";case"agent":return"Agent commercial";default:return s}},t=xe({resolver:ue(ze),defaultValues:{username:"",email:"",password:"",fullName:"",role:"agent",active:!0,permissions:C("agent"),smtpEnabled:!0,smtpHost:"s4015.fra1.stableserver.net",smtpPort:465,smtpSecure:!0,smtpFromEmail:"",commissionEnabled:!1,commissionRate:0,onboardingCompleted:!1}}),d=xe({resolver:ue(ze.partial({password:!0})),defaultValues:{username:"",email:"",password:"",fullName:"",role:"agent",active:!0}}),L=xe({resolver:ue(bs),defaultValues:{newPassword:"",confirmPassword:""}}),{data:Ee,isLoading:Ke,refetch:vs}=ps({queryKey:["users"],queryFn:async()=>await(await B("GET","/api/users")).json()}),M=W({mutationFn:async s=>await(await B("POST","/api/users",s)).json(),onSuccess:()=>{f(!1),t.reset(),E.invalidateQueries({queryKey:["users"]}),x({title:"Utilisateur créé",description:"L'utilisateur a été créé avec succès."})},onError:s=>{x({title:"Erreur",description:`Erreur lors de la création de l'utilisateur: ${s.message}`,variant:"destructive"})}}),k=W({mutationFn:async s=>{const{id:a,...y}=s;return await(await B("PUT",`/api/users/${a}`,y)).json()},onSuccess:()=>{v(!1),oe(null),d.reset(),E.invalidateQueries({queryKey:["users"]}),x({title:"Utilisateur mis à jour",description:"L'utilisateur a été mis à jour avec succès."})},onError:s=>{x({title:"Erreur",description:`Erreur lors de la mise à jour de l'utilisateur: ${s.message}`,variant:"destructive"})}}),U=W({mutationFn:async s=>(await B("DELETE",`/api/users/${s}`)).ok,onSuccess:()=>{G(!1),ye(null),E.invalidateQueries({queryKey:["users"]}),x({title:"Utilisateur supprimé",description:"L'utilisateur a été supprimé avec succès."})},onError:s=>{x({title:"Erreur",description:`Erreur lors de la suppression de l'utilisateur: ${s.message}`,variant:"destructive"})}}),R=W({mutationFn:async({userId:s,password:a})=>(await B("POST",`/api/users/${s}/reset-password`,{password:a})).ok,onSuccess:()=>{Q(!1),L.reset(),x({title:"Mot de passe réinitialisé",description:"Le mot de passe a été réinitialisé avec succès."})},onError:s=>{x({title:"Erreur",description:`Erreur lors de la réinitialisation du mot de passe: ${s.message}`,variant:"destructive"})}}),Qe=s=>{s.smtpEnabled&&!s.smtpUser&&(s.smtpUser=s.email),s.smtpEnabled&&!s.smtpFromEmail&&(s.smtpFromEmail=s.email),M.mutate(s)},Ge=s=>{oe(s),d.reset({username:s.username,email:s.email,fullName:s.fullName||"",role:s.role,active:s.active,permissions:s.permissions||C(s.role),smtpEnabled:s.smtpEnabled,smtpHost:s.smtpHost,smtpPort:s.smtpPort,smtpSecure:s.smtpSecure,smtpUser:s.smtpUser,smtpPassword:"",smtpFromEmail:s.smtpFromEmail,commissionEnabled:s.commissionEnabled,commissionRate:s.commissionRate}),v(!0)},Je=s=>{if(u)if(s.smtpEnabled&&!s.smtpUser&&(s.smtpUser=s.email),s.smtpEnabled&&!s.smtpFromEmail&&(s.smtpFromEmail=s.email),s.password)k.mutate({id:u.id,...s});else{const{password:a,...y}=s;k.mutate({id:u.id,...y})}},We=s=>{oe(s),Q(!0),L.reset({newPassword:"",confirmPassword:""})},Xe=s=>{u&&R.mutate({userId:u.id,password:s.newPassword})},Se=[...Ee?Ee.filter(s=>J==="all"?!0:s.role===J).filter(s=>{if(!de)return!0;const a=de.toLowerCase();return s.username.toLowerCase().includes(a)||s.email.toLowerCase().includes(a)||(s.fullName||"").toLowerCase().includes(a)}):[]].sort((s,a)=>{const{column:y,direction:me}=N;let I=s[y],H=a[y];return(y==="createdAt"||y==="lastLogin")&&(I=I?new Date(I).getTime():0,H=H?new Date(H).getTime():0),I<H?me==="asc"?-1:1:I>H?me==="asc"?1:-1:0}),q=s=>{Ce(a=>({column:s,direction:a.column===s&&a.direction==="asc"?"desc":"asc"}))},Ye=s=>s.fullName?s.fullName.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().substring(0,2):s.username.substring(0,2).toUpperCase();return b.useEffect(()=>{const s=t.watch("role");s&&t.setValue("permissions",C(s))},[t.watch("role")]),b.useEffect(()=>{Ce($e)},[J]),e.jsxs(as,{children:[e.jsx("div",{className:"container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des utilisateurs"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Créez et gérez les utilisateurs du système"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs(p,{onClick:()=>{f(!0),t.reset({username:"",email:"",password:"",fullName:"",role:"agent",active:!0,permissions:C("agent"),smtpEnabled:!0,smtpHost:"s4015.fra1.stableserver.net",smtpPort:465,smtpSecure:!0,commissionEnabled:!1,commissionRate:0,onboardingCompleted:!1})},className:"flex items-center gap-1.5",children:[e.jsx(je,{className:"h-4 w-4"}),"Créer un utilisateur"]})})]}),e.jsxs(ds,{children:[e.jsx(ms,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(js,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{type:"text",placeholder:"Rechercher...",className:"pl-9",value:de,onChange:s=>Oe(s.target.value)})]}),e.jsx(te,{value:J,onValueChange:He,className:"w-full sm:w-auto",children:e.jsxs(re,{className:"w-full grid-cols-4",children:[e.jsxs(g,{value:"all",className:"gap-2",children:[e.jsx(es,{className:"h-4 w-4"}),"Tous"]}),e.jsxs(g,{value:"admin",className:"gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Admin"]}),e.jsxs(g,{value:"manager",className:"gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Responsables"]}),e.jsxs(g,{value:"agent",className:"gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Agents"]})]})})]})}),e.jsx(xs,{children:Ke?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-blue-500"})}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs(ns,{children:[e.jsx(cs,{children:e.jsxs(fe,{children:[e.jsx(T,{className:"w-12"}),e.jsx(T,{className:"cursor-pointer hover:text-blue-600",onClick:()=>q("username"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Utilisateur",N.column==="username"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(T,{className:"cursor-pointer hover:text-blue-600",onClick:()=>q("role"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Rôle",N.column==="role"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(T,{className:"cursor-pointer hover:text-blue-600 hidden md:table-cell",onClick:()=>q("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Email",N.column==="email"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(T,{className:"cursor-pointer hover:text-blue-600 hidden md:table-cell",onClick:()=>q("createdAt"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Création",N.column==="createdAt"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(T,{className:"cursor-pointer hover:text-blue-600 hidden lg:table-cell",onClick:()=>q("lastLogin"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Dernière connexion",N.column==="lastLogin"&&(N.direction==="asc"?e.jsx(w,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4 transform rotate-180"}))]})}),e.jsx(T,{className:"w-[120px] text-right",children:"Actions"})]})}),e.jsx(os,{children:Se.length===0?e.jsx(fe,{children:e.jsx(P,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Aucun utilisateur trouvé"})}):Se.map(s=>e.jsxs(fe,{className:s.active?"":"opacity-60",children:[e.jsx(P,{className:"py-2",children:e.jsx(us,{className:"h-9 w-9",children:e.jsx(hs,{className:`${s.role==="admin"?"bg-purple-100 text-purple-800":s.role==="manager"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Ye(s)})})}),e.jsx(P,{className:"font-medium",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-900",children:s.fullName||s.username}),s.fullName&&e.jsxs("span",{className:"text-xs text-gray-500",children:["@",s.username]})]})}),e.jsx(P,{children:e.jsx(ce,{variant:s.role==="admin"?"purple":s.role==="manager"?"blue":"default",className:"rounded-md",children:s.role==="admin"?"Administrateur":s.role==="manager"?"Responsable":"Agent commercial"})}),e.jsx(P,{className:"hidden md:table-cell",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ne,{className:"h-3.5 w-3.5 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.email})]})}),e.jsx(P,{className:"text-gray-500 hidden md:table-cell",children:s.createdAt?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:ge(new Date(s.createdAt),"dd/MM/yyyy",{locale:ae})}),e.jsx("span",{className:"text-xs",children:ge(new Date(s.createdAt),"HH:mm",{locale:ae})})]}):"-"}),e.jsx(P,{className:"text-gray-500 hidden lg:table-cell",children:s.lastLogin?e.jsx("div",{title:ge(new Date(s.lastLogin),"dd/MM/yyyy HH:mm",{locale:ae}),children:gs(new Date(s.lastLogin),{addSuffix:!0,locale:ae})}):"-"}),e.jsx(P,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{content:"Modifier",children:e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>Ge(s),children:e.jsx(Le,{className:"h-4 w-4"})})}),e.jsx(F,{content:"Réinitialiser le mot de passe",children:e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>We(s),children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsx(F,{content:"Supprimer",children:e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 hover:bg-red-50",onClick:()=>{ye(s.id),G(!0)},children:e.jsx(Me,{className:"h-4 w-4"})})})]})})]},s.id))})]})})})]})]})}),e.jsx(X,{open:o,onOpenChange:s=>!M.isPending&&f(s),children:e.jsxs(Y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Créer un nouvel utilisateur"]}),e.jsx(ee,{children:"Ajoutez un nouvel utilisateur et configurez ses accès au système."})]}),e.jsx(pe,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(Qe),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-blue-600"}),"Notification d'arrivée"]}),e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"Le nouvel utilisateur recevra un email de bienvenue avec ses informations de connexion et la configuration de sa boîte mail personnelle."}),e.jsxs("ul",{className:"text-xs text-blue-600 space-y-1 mb-2",children:[e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx($,{className:"h-3.5 w-3.5 mt-0.5 text-blue-700"}),e.jsx("span",{children:"Informations d'accès à la plateforme"})]}),e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx($,{className:"h-3.5 w-3.5 mt-0.5 text-blue-700"}),e.jsx("span",{children:"Configuration de messagerie automatique"})]}),e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx($,{className:"h-3.5 w-3.5 mt-0.5 text-blue-700"}),e.jsx("span",{children:"Informations du rôle et des permissions"})]})]})]}),e.jsx(r,{control:t.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Nom complet"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{placeholder:"Nom et prénom",className:"pl-9",...s})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"username",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Nom d'utilisateur",e.jsx(F,{content:"Identifiant unique utilisé pour la connexion",children:e.jsx(ie,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{placeholder:"Nom d'utilisateur",className:"pl-9",...s})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Email",e.jsx(F,{content:"Adresse email utilisée pour les notifications et la récupération du compte",children:e.jsx(ie,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{type:"email",placeholder:"utilisateur@exemple.com",className:"pl-9",...s,onChange:a=>{s.onChange(a),t.watch("smtpEnabled")&&(t.setValue("smtpFromEmail",a.target.value),t.setValue("smtpUser",a.target.value))}})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"password",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Mot de passe",e.jsx(F,{content:"Minimum 6 caractères. Un mot de passe fort est recommandé.",children:e.jsx(ie,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{type:"password",placeholder:"Mot de passe",className:"pl-9",...s})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"role",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs("span",{className:"flex items-center gap-1",children:["Rôle",e.jsx(F,{content:"Détermine le niveau d'accès et les permissions de l'utilisateur",children:e.jsx(ie,{className:"h-3.5 w-3.5 text-gray-500"})})]})}),e.jsxs(ke,{onValueChange:a=>{s.onChange(a),t.setValue("permissions",C(a))},defaultValue:s.value,children:[e.jsx(i,{children:e.jsx(Ve,{className:"w-full",children:e.jsx(Te,{placeholder:"Sélectionner un rôle"})})}),e.jsxs(Fe,{children:[e.jsx(z,{value:"admin",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{children:"Administrateur"})]})}),e.jsx(z,{value:"manager",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{children:"Responsable"})]})}),e.jsx(z,{value:"agent",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:"Agent commercial"})]})})]})]}),e.jsx(j,{children:"Définit les droits d'accès de l'utilisateur dans le système."}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"active",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Compte actif"}),e.jsx(j,{children:"Détermine si l'utilisateur peut se connecter au système."})]}),e.jsx(i,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs(te,{defaultValue:"permissions",children:[e.jsxs(re,{className:"grid w-full grid-cols-4",children:[e.jsx(g,{value:"permissions",children:"Permissions"}),e.jsx(g,{value:"smtp",children:"Config SMTP"}),e.jsxs(g,{value:"email-preview",className:"flex items-center gap-1.5",children:[e.jsx(fs,{className:"h-4 w-4"}),"Aperçu email"]}),e.jsx(g,{value:"commission",children:"Commission"})]}),e.jsx(S,{value:"email-preview",className:"py-4",children:e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-100 border-b p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Aperçu de l'email de bienvenue"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(p,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 rounded-full",children:e.jsx(Ns,{className:"h-3 w-3"})}),e.jsx(p,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 rounded-full",children:e.jsx(ss,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"p-5 overflow-auto max-h-[500px]",children:e.jsxs("div",{className:"mx-auto max-w-[550px]",children:[e.jsxs("div",{className:"text-center mb-5",children:[e.jsx("div",{className:"inline-block bg-blue-600 text-white p-3 rounded-full mb-3",children:e.jsx(V,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-xl font-bold text-blue-800",children:"Bienvenue chez Raccordement Électrique"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Votre compte a été créé avec succès"})]}),e.jsxs("div",{className:"bg-gray-50 border rounded-lg p-5 mb-5",children:[e.jsxs("h3",{className:"font-medium text-gray-800 mb-3 flex items-center gap-1.5",children:[e.jsx(D,{className:"h-4 w-4 text-blue-600"}),"Vos informations de connexion"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white rounded border",children:[e.jsx("span",{className:"text-gray-600",children:"Nom d'utilisateur :"}),e.jsx("span",{className:"font-medium",children:t.watch("username")||"[nom d'utilisateur]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white rounded border",children:[e.jsx("span",{className:"text-gray-600",children:"Email :"}),e.jsx("span",{className:"font-medium",children:t.watch("email")||"[email]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white rounded border",children:[e.jsx("span",{className:"text-gray-600",children:"Rôle :"}),e.jsx("span",{className:"font-medium",children:Be(t.watch("role")||"agent")})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-5 mb-5",children:[e.jsxs("h3",{className:"font-medium text-blue-800 mb-3 flex items-center gap-1.5",children:[e.jsx(V,{className:"h-4 w-4 text-blue-600"}),"Configuration de messagerie"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white/80 rounded border border-blue-100",children:[e.jsx("span",{className:"text-gray-600",children:"Serveur :"}),e.jsx("span",{className:"font-medium font-mono text-blue-700",children:"s4015.fra1.stableserver.net"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white/80 rounded border border-blue-100",children:[e.jsx("span",{className:"text-gray-600",children:"Email :"}),e.jsx("span",{className:"font-medium font-mono text-blue-700",children:t.watch("email")||"[email]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center text-sm p-2 bg-white/80 rounded border border-blue-100",children:[e.jsx("span",{className:"text-gray-600",children:"Mot de passe :"}),e.jsx("span",{className:"font-medium font-mono text-blue-700",children:"Kamaka00."})]})]}),e.jsx("div",{className:"mt-3 text-xs text-blue-700",children:"Vous pouvez accéder à votre messagerie via un client mail (Outlook, Thunderbird, Gmail, etc.) ou directement depuis l'interface du CRM."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"bg-blue-600 hover:bg-blue-700",children:"Accéder au CRM"}),e.jsxs("p",{className:"mt-4 text-xs text-gray-500",children:["En cas de problème, contactez l'administrateur du système à ",e.jsx("a",{href:"mailto:admin@demande-raccordement.fr",className:"text-blue-600 underline",children:"admin@demande-raccordement.fr"})]})]})]})})]})}),e.jsx(S,{value:"permissions",className:"py-4",children:e.jsxs(te,{defaultValue:"default",children:[e.jsxs(re,{className:"grid w-full grid-cols-2",children:[e.jsx(g,{value:"default",children:"Permissions par défaut"}),e.jsx(g,{value:"custom",children:"Permissions personnalisées"})]}),e.jsxs(S,{value:"default",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Les permissions seront attribuées automatiquement en fonction du rôle de l'utilisateur."}),e.jsx(ne,{permissions:C(t.watch("role")||"agent"),onChange:()=>{}})]}),e.jsxs(S,{value:"custom",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Personnalisez les permissions de l'utilisateur."}),e.jsx(r,{control:t.control,name:"permissions",render:({field:s})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(ne,{permissions:s.value||[],onChange:s.onChange})}),e.jsx(m,{})]})})]})]})}),e.jsx(S,{value:"smtp",className:"py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-sky-50 border border-blue-200 rounded-lg p-5 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-500 p-2 rounded-full text-white mt-1",children:e.jsx(V,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Configuration automatique de la messagerie"}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"L'utilisateur recevra un email de bienvenue contenant ses identifiants et informations de connexion."}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm bg-white/75 p-3 rounded-md border border-blue-100 mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Serveur SMTP:"}),e.jsx("span",{className:"font-mono",children:"s4015.fra1.stableserver.net"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Port:"}),e.jsx("span",{className:"font-mono",children:"465"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Sécurité:"}),e.jsx("span",{className:"font-mono",children:"SSL/TLS"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-800",children:"Mot de passe:"}),e.jsx("span",{className:"font-mono",children:"Kamaka00."})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3 text-xs text-yellow-800",children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Ue,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}),e.jsx("p",{children:"Cette configuration permet à l'utilisateur d'envoyer des emails depuis le système et d'utiliser sa boîte email personnalisée."})]})})]})]})}),e.jsx(r,{control:t.control,name:"smtpEnabled",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Activer la configuration SMTP"}),e.jsx(j,{children:"Permet à l'utilisateur d'envoyer des emails depuis le système."})]}),e.jsx(i,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})}),t.watch("smtpEnabled")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(r,{control:t.control,name:"smtpHost",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Serveur SMTP"}),e.jsx(i,{children:e.jsx(h,{placeholder:"smtp.example.com",...s,value:s.value||""})}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"smtpPort",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Port"}),e.jsx(i,{children:e.jsx(h,{type:"number",placeholder:"465",...s,value:s.value||"",onChange:a=>s.onChange(a.target.value?parseInt(a.target.value):"")})}),e.jsx(m,{})]})})]}),e.jsx(r,{control:t.control,name:"smtpSecure",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Connexion sécurisée"}),e.jsx(j,{children:"Utiliser SSL/TLS pour la connexion au serveur SMTP."})]}),e.jsx(i,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:t.control,name:"smtpUser",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Nom d'utilisateur SMTP"}),e.jsx(i,{children:e.jsx(h,{placeholder:"user@example.com",...s,value:s.value||""})}),e.jsx(j,{children:"Généralement identique à l'adresse email."}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"smtpPassword",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Mot de passe SMTP"}),e.jsx(i,{children:e.jsx(h,{type:"password",placeholder:"********",...s,value:s.value||""})}),e.jsx(j,{children:"Laissez vide pour conserver le mot de passe actuel."}),e.jsx(m,{})]})}),e.jsx(r,{control:t.control,name:"smtpFromEmail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Email d'expédition"}),e.jsx(i,{children:e.jsx(h,{placeholder:"noreply@example.com",...s,value:s.value||""})}),e.jsx(j,{children:"Adresse utilisée comme expéditeur des emails."}),e.jsx(m,{})]})})]})]})}),e.jsx(S,{value:"commission",className:"py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-lg p-5 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-amber-500 p-2 rounded-full text-white mt-1",children:e.jsx(Re,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 mb-2",children:"Commissions sur paiements"}),e.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Activez et configurez les commissions pour cet utilisateur sur les paiements reçus."}),e.jsxs("div",{className:"bg-white/75 p-3 rounded-md border border-amber-100 text-sm",children:[e.jsx("p",{className:"text-amber-800 mb-2",children:"Le système permettra de suivre et calculer automatiquement les commissions de l'utilisateur sur les paiements des demandes qu'il a traitées."}),e.jsx("p",{className:"text-amber-800 font-medium",children:"Ces informations sont visibles uniquement par les administrateurs."})]})]})]})}),e.jsx(r,{control:t.control,name:"commissionEnabled",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Activer les commissions"}),e.jsx(j,{children:"L'utilisateur recevra des commissions sur les paiements."})]}),e.jsx(i,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})}),t.watch("commissionEnabled")&&e.jsx(r,{control:t.control,name:"commissionRate",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Taux de commission (€ par paiement)"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{type:"number",step:"0.01",min:"0",placeholder:"14.00",className:"pl-9",...s,value:s.value||"",onChange:a=>s.onChange(a.target.value?parseFloat(a.target.value):"")})]})}),e.jsx(j,{children:"Montant fixe en euros par paiement traité. Par défaut: 14€."}),e.jsx(m,{})]})})]})})]})})]}),e.jsxs(se,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>!M.isPending&&f(!1),disabled:M.isPending,children:"Annuler"}),e.jsx(p,{type:"submit",disabled:M.isPending,className:"gap-1",children:M.isPending?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 animate-spin"}),"Création en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-4 w-4"}),"Créer l'utilisateur"]})})]})]})})]})}),e.jsx(X,{open:A,onOpenChange:s=>!k.isPending&&v(s),children:e.jsxs(Y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"Modifier l'utilisateur"]}),e.jsx(ee,{children:"Modifiez les informations et les accès de cet utilisateur."})]}),e.jsx(pe,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(Je),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(r,{control:d.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Nom complet"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{placeholder:"Nom et prénom",className:"pl-9",...s,value:s.value||""})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:d.control,name:"username",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Nom d'utilisateur"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{placeholder:"Nom d'utilisateur",className:"pl-9",...s})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:d.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Email"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{type:"email",placeholder:"utilisateur@exemple.com",className:"pl-9",...s,onChange:a=>{s.onChange(a),d.watch("smtpEnabled")&&((!d.getValues("smtpFromEmail")||d.getValues("smtpFromEmail")===(u==null?void 0:u.email))&&d.setValue("smtpFromEmail",a.target.value),(!d.getValues("smtpUser")||d.getValues("smtpUser")===(u==null?void 0:u.email))&&d.setValue("smtpUser",a.target.value))}})]})}),e.jsx(m,{})]})}),e.jsx(r,{control:d.control,name:"password",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Mot de passe"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(h,{type:"password",placeholder:"Laisser vide pour ne pas modifier",className:"pl-9",...s,value:s.value||""})]})}),e.jsx(j,{children:"Laissez vide pour conserver le mot de passe actuel."}),e.jsx(m,{})]})}),e.jsx(r,{control:d.control,name:"role",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Rôle"}),e.jsxs(ke,{onValueChange:a=>{s.onChange(a),(!d.getValues("permissions")||JSON.stringify(d.getValues("permissions"))===JSON.stringify(C((u==null?void 0:u.role)||"")))&&d.setValue("permissions",C(a))},defaultValue:s.value,value:s.value,children:[e.jsx(i,{children:e.jsx(Ve,{className:"w-full",children:e.jsx(Te,{placeholder:"Sélectionner un rôle"})})}),e.jsxs(Fe,{children:[e.jsx(z,{value:"admin",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{children:"Administrateur"})]})}),e.jsx(z,{value:"manager",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{children:"Responsable"})]})}),e.jsx(z,{value:"agent",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:"Agent commercial"})]})})]})]}),e.jsx(j,{children:"Définit les droits d'accès de l'utilisateur dans le système."}),e.jsx(m,{})]})}),e.jsx(r,{control:d.control,name:"active",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Compte actif"}),e.jsx(j,{children:"Détermine si l'utilisateur peut se connecter au système."})]}),e.jsx(i,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs(te,{defaultValue:"permissions",children:[e.jsxs(re,{className:"grid w-full grid-cols-2",children:[e.jsx(g,{value:"default",children:"Permissions par défaut"}),e.jsx(g,{value:"custom",children:"Permissions personnalisées"})]}),e.jsxs(S,{value:"default",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Les permissions seront attribuées automatiquement en fonction du rôle de l'utilisateur."}),e.jsx(ne,{permissions:C(d.watch("role")||"agent"),onChange:()=>{}})]}),e.jsxs(S,{value:"custom",className:"py-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Personnalisez les permissions de l'utilisateur."}),e.jsx(r,{control:d.control,name:"permissions",render:({field:s})=>e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(ne,{permissions:s.value||[],onChange:s.onChange})}),e.jsx(m,{})]})})]})]})})]}),e.jsxs(se,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>!k.isPending&&v(!1),disabled:k.isPending,children:"Annuler"}),e.jsx(p,{type:"submit",disabled:k.isPending,className:"gap-1",children:k.isPending?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 animate-spin"}),"Mise à jour en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4"}),"Enregistrer les modifications"]})})]})]})})]})}),e.jsx(X,{open:qe,onOpenChange:s=>!R.isPending&&Q(s),children:e.jsxs(Y,{className:"max-w-md",children:[e.jsxs(Z,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5"}),"Réinitialiser le mot de passe"]}),e.jsxs(ee,{children:["Définissez un nouveau mot de passe pour l'utilisateur ",u==null?void 0:u.username,"."]})]}),e.jsx(pe,{...L,children:e.jsxs("form",{onSubmit:L.handleSubmit(Xe),className:"space-y-4",children:[e.jsx(r,{control:L.control,name:"newPassword",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Nouveau mot de passe"}),e.jsx(i,{children:e.jsx(h,{type:"password",placeholder:"••••••••",...s})}),e.jsx(m,{})]})}),e.jsx(r,{control:L.control,name:"confirmPassword",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Confirmer le mot de passe"}),e.jsx(i,{children:e.jsx(h,{type:"password",placeholder:"••••••••",...s})}),e.jsx(m,{})]})}),e.jsxs(se,{className:"mt-6",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>!R.isPending&&Q(!1),disabled:R.isPending,children:"Annuler"}),e.jsx(p,{type:"submit",disabled:R.isPending,className:"gap-1",children:R.isPending?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 animate-spin"}),"Réinitialisation..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4"}),"Réinitialiser"]})})]})]})})]})}),e.jsx(X,{open:Ie,onOpenChange:s=>!U.isPending&&G(s),children:e.jsxs(Y,{className:"max-w-md",children:[e.jsxs(Z,{children:[e.jsxs(_,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(Ue,{className:"h-5 w-5"}),"Confirmer la suppression"]}),e.jsx(ee,{children:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible."})]}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"La suppression d'un utilisateur entraînera la perte de toutes ses données associées, y compris :"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-2 space-y-1",children:[e.jsx("li",{children:"Son compte et ses informations personnelles"}),e.jsx("li",{children:"Ses statistiques et son historique"}),e.jsx("li",{children:"Ses configurations et préférences"})]})]}),e.jsxs(se,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>!U.isPending&&G(!1),disabled:U.isPending,children:"Annuler"}),e.jsx(p,{variant:"destructive",onClick:()=>we&&U.mutate(we),disabled:U.isPending,className:"gap-1",children:U.isPending?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 animate-spin"}),"Suppression..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"h-4 w-4"}),"Supprimer définitivement"]})})]})]})})]})}export{ta as default};
