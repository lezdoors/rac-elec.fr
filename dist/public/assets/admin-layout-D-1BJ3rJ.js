import{c as q,r as i,aF as dt,aG as me,j as s,v as G,L as $e,B as Y,aH as It,q as eo,M as rt,aj as Gt,a as Vt,al as Ae,am as $,ao as X,aq as se,ap as R,aC as z,ar as ge,aE as Xt,av as to,aI as no,aJ as ro,at as ot,aK as oo,au as ao,aw as so,ax as io,az as co,aA as lo,aL as Kt,ay as uo,aM as fo,aD as mo,an as ho,o as po,C as ft,u as Jt,m as go,aN as vo}from"./index-BK98VQ5F.js";import{u as Qt,S as wo}from"./use-auth-DDA4cOrX.js";import{B as Me}from"./badge-CFTHm_pp.js";import{u as Ge}from"./useQuery-CeUf9-P4.js";import{u as Zt,c as en,R as yo,I as bo}from"./use-mobile-CaPxtXK8.js";import{L as xo}from"./log-out-Cxe76wKU.js";import{F as Co}from"./file-text-Cf4cAjZj.js";import{C as So}from"./credit-card-sbxkXRy6.js";import{S as Po}from"./settings-CokUIdI1.js";import{u as tn}from"./index-CigaS-v9.js";import{d as Eo,u as Mo,e as To,o as No,s as jo,f as Ro,g as ko,h as Ao,i as _o,l as Do,c as nn,A as Oo,a as Io,b as Lo,R as Wo,C as $o}from"./index-DRwQ35eW.js";import{S as rn}from"./separator-CGE3VMYe.js";import{u as Fo}from"./index-YVpoeFfG.js";import{E as on}from"./external-link-BPiGZE9F.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=q("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=q("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=q("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=q("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=q("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=q("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=q("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=q("FileBox",[["path",{d:"M14.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"16lz6z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 13.1a2 2 0 0 0-1 1.76v3.24a2 2 0 0 0 .97 1.78L6 21.7a2 2 0 0 0 2.03.01L11 19.9a2 2 0 0 0 1-1.76V14.9a2 2 0 0 0-.97-1.78L8 11.3a2 2 0 0 0-2.03-.01Z",key:"99pj1s"}],["path",{d:"M7 17v5",key:"1yj1jh"}],["path",{d:"M11.7 14.2 7 17l-4.7-2.8",key:"1yk8tc"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=q("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=q("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=q("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=q("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=q("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=q("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function Zo(){const[e,n]=i.useState([]),[t,r]=i.useState(0),[o,a]=i.useState(!0),[c,l]=i.useState(null),u=i.useRef(null),f=i.useRef(!1),{data:d,isLoading:h,refetch:p}=Ge({queryKey:["/api/notifications/unread"],queryFn:dt({on401:"returnNull"}),staleTime:3*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchInterval:5*60*1e3}),w=i.useCallback(async m=>{var g;try{const v=localStorage.getItem("adminToken");if(!v)return;(await fetch(`/api/notifications/${m}/read`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},credentials:"include"})).ok&&(n(x=>x.map(N=>N.id===m?{...N,isRead:!0}:N)),r(x=>Math.max(0,x-1)),((g=u.current)==null?void 0:g.readyState)===WebSocket.OPEN&&u.current.send(JSON.stringify({type:"NOTIFICATION_READ",notificationId:m})))}catch(v){console.error("Erreur lors du marquage d'une notification comme lue:",v)}},[]),y=i.useCallback(async()=>{var m;try{const g=localStorage.getItem("adminToken");if(!g)return;(await fetch("/api/notifications/read-all",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},credentials:"include"})).ok&&(n(b=>b.map(x=>({...x,isRead:!0}))),r(0),((m=u.current)==null?void 0:m.readyState)===WebSocket.OPEN&&u.current.send(JSON.stringify({type:"ALL_NOTIFICATIONS_READ"})))}catch(g){console.error("Erreur lors du marquage de toutes les notifications comme lues:",g)}},[]),S=i.useCallback(()=>{try{const m=window.location.protocol==="https:"?"wss:":"ws:",g=window.location.host,v=localStorage.getItem("adminToken");if(!v){console.log("Pas de token pour la connexion WebSocket, abandon");return}const b=`${m}//${g}/ws?token=${v}`;u.current&&u.current.readyState!==WebSocket.CLOSED&&u.current.close(),u.current=new WebSocket(b),u.current.onopen=()=>{console.log("Connexion WebSocket établie"),window.__WS_ACTIVE=!0},u.current.onmessage=x=>{var N;try{const E=JSON.parse(x.data);if(E.type==="NOTIFICATION"){const P=E.notification;n(D=>[P,...D]),P.isRead||r(D=>D+1)}else if(E.type==="NOTIFICATION_UPDATE"){const P=E.notification;n(D=>D.map(j=>j.id===P.id?P:j)),E.unreadCountChanged&&r(E.unreadCount)}else E.type==="NOTIFICATION_COUNT"?r(E.count):E.type==="PING"&&((N=u.current)==null?void 0:N.readyState)===WebSocket.OPEN&&u.current.send(JSON.stringify({type:"PONG"}))}catch(E){console.error("Erreur lors du traitement d'un message WebSocket:",E)}},u.current.onclose=()=>{console.log("Connexion WebSocket fermée"),window.__WS_ACTIVE=!1,setTimeout(()=>{S()},5e3)},u.current.onerror=x=>{console.error("Erreur WebSocket:",x),window.__WS_ACTIVE=!1,l("Erreur de connexion au serveur de notifications")}}catch(m){console.error("Erreur lors de l'établissement de la connexion WebSocket:",m),window.__WS_ACTIVE=!1}},[]);return i.useEffect(()=>{if(d&&!f.current){if(d.notifications&&Array.isArray(d.notifications)){n(d.notifications);const m=d.notifications.filter(g=>!g.isRead);r(m.length)}a(!1),f.current=!0}},[d]),i.useEffect(()=>(S(),()=>{u.current&&(u.current.close(),window.__WS_ACTIVE=!1)}),[S]),i.useEffect(()=>{const m=setInterval(()=>{!window.__WS_ACTIVE&&document.visibilityState==="visible"&&p()},18e4);return()=>clearInterval(m)},[p]),{notifications:e,unreadCount:t,loading:o,error:c,markAsRead:w,markAllAsRead:y,refetch:p}}function ea(){const[e,n]=i.useState(()=>{try{const l=sessionStorage.getItem("contacts_unread_count");return l?parseInt(l,10):0}catch{return 0}}),t=i.useCallback(l=>{try{sessionStorage.setItem("contacts_unread_count",l.toString()),sessionStorage.setItem("contacts_last_check",new Date().getTime().toString())}catch{}},[]),r=i.useCallback(()=>{try{const l=sessionStorage.getItem("contacts_last_check");if(!l)return!0;const u=new Date().getTime(),f=parseInt(l,10);return u-f>12e4}catch{return!0}},[]),{data:o,isLoading:a,error:c}=Ge({queryKey:["/api/contacts/unread-count"],queryFn:dt({on401:"returnNull"}),refetchInterval:5*60*1e3,staleTime:3*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,enabled:r()});return i.useEffect(()=>{o&&typeof o=="object"&&"count"in o&&typeof o.count=="number"&&(n(o.count),t(o.count))},[o,t]),i.useEffect(()=>{if(!window.__WS_ACTIVE){const u=setInterval(()=>{r()&&document.visibilityState==="visible"&&fetch(`/api/contacts/unread-count?_t=${new Date().getTime()}`,{credentials:"include",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Cache-Control":"no-cache"}}).then(f=>f.json()).then(f=>{f&&typeof f.count=="number"&&(n(f.count),t(f.count))}).catch(f=>{console.error("Erreur lors du rafraîchissement du compteur de contacts:",{})})},3e5);return()=>clearInterval(u)}},[r,t]),{unreadCount:e,isLoading:a,error:c}}function ta({className:e,activePath:n}){var y,S,m,g;i.useState(!1);const{user:t,isLoading:r}=Qt();(y=t==null?void 0:t.role)!=null&&y.toLowerCase();const o=((S=t==null?void 0:t.role)==null?void 0:S.toLowerCase())===me.ADMIN.toLowerCase(),a=((m=t==null?void 0:t.role)==null?void 0:m.toLowerCase())===me.MANAGER.toLowerCase(),c=((g=t==null?void 0:t.role)==null?void 0:g.toLowerCase())===me.AGENT.toLowerCase();console.log("SideNav - Données utilisateur:",{id:t==null?void 0:t.id,username:t==null?void 0:t.username,role:t==null?void 0:t.role,isAdmin:o,isManager:a,isAgent:c,permissions:t==null?void 0:t.permissions});const{unreadCount:l}=Zo(),{unreadCount:u}=ea();Zt();const f=v=>{const b=`permission_${t==null?void 0:t.id}_${v}`,x=sessionStorage.getItem(b);if(x)return x==="true";if(!t||!t.id||!t.role)return!1;const N=t.role.toLowerCase(),E=N===me.ADMIN.toLowerCase(),P=N===me.AGENT.toLowerCase(),D=N===me.MANAGER.toLowerCase();let j=!1;if(E)j=!0;else if(Array.isArray(t.permissions)&&t.permissions.length>0){const A=t.permissions.find(L=>L.page===v);A?j=A.canView===!0:P?j=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts"].includes(v):D&&(j=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts","notifications","paiements"].includes(v))}else P?j=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts"].includes(v):D&&(j=["dashboard","demandes","leads","clients","rendez-vous","emails","contacts","notifications","paiements"].includes(v));try{sessionStorage.setItem(b,j.toString())}catch{}return j},d=()=>[{label:"Tableau de bord",path:"/admin/dashboard",page:"dashboard",icon:Go,badge:null},{label:"Demandes",path:"/admin/demandes",page:"demandes",icon:Co,badge:null},{label:"Paiements",path:"/admin/paiements",page:"paiements",icon:So,badge:null},{label:"Terminal de paiement",path:"/admin/terminal-paiement",page:"paiements",icon:Ko,badge:null},{label:"Débogage paiements",path:"/payment-debug",page:"paiements",icon:Ho,badge:null},{label:"Statistiques",path:"/admin/user-statistics",page:"dashboard",icon:Yo,badge:null}].filter(b=>f(b.page)),h=()=>[{label:"Clients",path:"/admin/clients",page:"clients",icon:It,badge:null},{label:"Leads",path:"/admin/leads",page:"leads",icon:Qo,badge:null},{label:"Rendez-vous",path:"/admin/rendez-vous",page:"rendez-vous",icon:eo,badge:null},{label:"Contacts",path:"/admin/contacts",page:"contacts",icon:rt,badge:u||null},{label:"Mail",path:"/admin/mail",page:"emails",icon:rt,badge:null}].filter(b=>f(b.page)),p=()=>[{label:"Utilisateurs",path:"/admin/users",page:"users",icon:It,badge:null},{label:"Paramètres",path:"/admin/settings",page:"settings",icon:Po,badge:null},{label:"Animations",path:"/admin/animations",page:"animations",icon:wo,badge:null},{label:"Config SMTP",path:"/admin/smtp",page:"emails",icon:Vo,badge:null},{label:"Google Snippets",path:"/admin/google-snippets",page:"settings",icon:zo,badge:null},{label:"Performance",path:"/admin/performance-monitor",page:"settings",icon:qo,badge:null},{label:"Test Notifications",path:"/admin/notification-tests",page:"settings",icon:at,badge:null},{label:"Notifications",path:"/admin/notifications",page:"notifications",icon:at,badge:l||null}].filter(b=>f(b.page));let w=[{title:"Général",items:d()},{title:"Gestion",items:h()}];return o&&w.push({title:"Administration",items:p()}),s.jsx("div",{className:G("pb-12 h-full overflow-hidden flex flex-col",e),children:s.jsxs("div",{className:"space-y-4 py-4 flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:[s.jsx("div",{className:"px-4 py-2",children:s.jsx("div",{className:"flex items-center justify-between space-x-2",children:s.jsx("h2",{className:"text-lg font-semibold tracking-tight text-gray-800",children:"Administration"})})}),w.filter(v=>v.items.length>0).map((v,b)=>s.jsxs("div",{className:"px-3 py-2",children:[s.jsx("h2",{className:"mb-2 px-4 text-lg font-semibold tracking-tight",children:v.title}),s.jsx("div",{className:"space-y-1",children:v.items.map((x,N)=>s.jsx($e,{href:x.path,children:s.jsxs(Y,{variant:n===x.path?"secondary":"ghost",className:"w-full justify-start",children:[s.jsx(x.icon,{className:"mr-2 h-4 w-4"}),x.label,x.badge&&x.badge>0&&s.jsx(Me,{className:"ml-auto",variant:n===x.path?"default":"secondary",children:x.badge})]})},N))})]},b)),s.jsx("div",{className:"px-3 py-2",children:s.jsx("div",{className:"space-y-1",children:s.jsx($e,{href:"/logout",children:s.jsxs(Y,{variant:"ghost",className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50",children:[s.jsx(xo,{className:"mr-2 h-4 w-4"}),"Déconnexion"]})})})})]})})}const sn=i.createContext(null);function na({children:e}){const[n,t]=i.useState(!1),r=i.useRef(null),o=i.useRef(new Map),a=i.useRef(null),c=i.useRef(null),l=i.useRef(0),u=Gt(),{toast:f}=Vt(),d=5,h=3e3,p=i.useRef(!1),w=i.useCallback(()=>{if(p.current){console.log("WebSocket Provider: Connexion déjà en cours, ignorer cette tentative");return}p.current=!0;try{if(r.current&&r.current.readyState!==WebSocket.CLOSED&&r.current.close(),window.location.hostname.includes("replit")||window.location.hostname.includes("repl.co")){console.log("WebSocket Provider: Fonctionnalité désactivée pour Replit"),console.log("WebSocket: Fonctionnalité désactivée pour le site public"),console.log("WebSocket: Fonctionnalité désactivée"),console.log("WebSocket: Simulation d'abonnement aux données de type 'notifications'"),setTimeout(()=>{p.current=!1,t(!0)},500);return}else{const v=window.location.protocol==="https:"?"wss:":"ws:",b=window.location.host,x=`${v}//${b}/ws`,N=localStorage.getItem("auth_token"),E=Date.now();let P=`${x}?timestamp=${E}&client=webapp`;N&&(P+=`&token=${encodeURIComponent(N)}`),P+="&mode=optimized",console.log("WebSocket Provider: Connexion à",P),r.current=new WebSocket(P)}const g=setTimeout(()=>{r.current&&r.current.readyState!==WebSocket.OPEN&&(console.log("WebSocket Provider: Timeout de connexion, fermeture forcée"),r.current.close())},5e3);r.current.onopen=()=>{clearTimeout(g),p.current=!1,console.log("WebSocket Provider: Connexion centralisée établie"),t(!0),l.current=0,o.current.forEach((v,b)=>{v.length>0&&r.current&&r.current.readyState===WebSocket.OPEN&&(console.log(`WebSocket Provider: Abonnement au type ${b} via le système centralisé`),r.current.send(JSON.stringify({type:"subscribe",dataType:b})))}),c.current&&clearInterval(c.current),c.current=setInterval(()=>{r.current&&r.current.readyState===WebSocket.OPEN&&r.current.send(JSON.stringify({type:"ping",timestamp:new Date().toISOString()}))},3e4)},r.current.onmessage=v=>{try{const b=JSON.parse(v.data);if(b.type==="pong"){console.log("WebSocket Provider: Pong reçu");return}if(b.type==="notifications"){const x=o.current.get("notifications")||[];x.length>0&&x.forEach(N=>{N.queryKeysToInvalidate.forEach(E=>{u.invalidateQueries({queryKey:[E]})}),N.onNewData&&N.onNewData(b)})}else if(b.type==="NOTIFICATION_UPDATE"||b.type==="ALL_NOTIFICATIONS_READ"){console.log(`WebSocket Provider: Message ${b.type} reçu`);const x=o.current.get("notifications")||[];x.length>0&&x.forEach(N=>{N.queryKeysToInvalidate.forEach(E=>{u.invalidateQueries({queryKey:[E]})}),N.onNewData&&N.onNewData(b)})}else if(b.type.startsWith("new_")||b.type.startsWith("update_")){const x=b.type.split("_")[0],E=b.type.substring(x.length+1),P=o.current.get(E)||[];if(P.length===0)return;const D=E==="demandes"?"demande":E==="paiements"?"paiement":E.slice(0,-1),j=b[D];P.forEach(A=>{A.queryKeysToInvalidate.forEach(L=>{u.invalidateQueries({queryKey:[L]})}),A.onNewData&&A.onNewData(j)})}}catch(b){console.error("WebSocket Provider: Erreur lors du traitement du message",b)}},r.current.onclose=v=>{if(console.log(`WebSocket Provider: Connexion fermée (code: ${v.code})`),t(!1),c.current&&(clearInterval(c.current),c.current=null),a.current&&(clearTimeout(a.current),a.current=null),Array.from(o.current.values()).some(x=>x.length>0)&&l.current<d){const x=Math.min(h*Math.pow(1.5,l.current)+Math.random()*1e3,6e4);console.log(`WebSocket Provider: Tentative de reconnexion dans ${x/1e3}s (${l.current+1}/${d})`),l.current++,a.current=setTimeout(()=>{w()},x)}else l.current>=d&&(console.log("WebSocket Provider: Nombre maximum de tentatives de reconnexion atteint"),f({title:"Problème de connexion en temps réel",description:"Nous rencontrons des difficultés à maintenir une connexion en temps réel. Rechargez la page pour réessayer.",variant:"destructive"}))},r.current.onerror=v=>{console.error("WebSocket Provider: Erreur de connexion",v)}}catch(m){console.error("WebSocket Provider: Erreur lors de la création de la connexion",m),t(!1)}},[u,f]),y=i.useCallback(m=>{const{dataType:g}=m,v=o.current.get(g)||[];return v.push(m),o.current.set(g,v),v.length===1&&r.current&&r.current.readyState===WebSocket.OPEN&&r.current.send(JSON.stringify({type:"subscribe",dataType:g})),(!r.current||r.current.readyState===WebSocket.CLOSED||r.current.readyState===WebSocket.CLOSING)&&w(),()=>{const x=(o.current.get(g)||[]).filter(N=>N!==m);x.length===0?(o.current.delete(g),r.current&&r.current.readyState===WebSocket.OPEN&&r.current.send(JSON.stringify({type:"unsubscribe",dataType:g})),!Array.from(o.current.values()).some(E=>E.length>0)&&r.current&&r.current.close()):o.current.set(g,x)}},[w]);i.useEffect(()=>()=>{a.current&&clearTimeout(a.current),c.current&&clearInterval(c.current),r.current&&r.current.close()},[]);const S=i.useCallback(()=>(console.log("WebSocket Provider: Reconnexion manuelle initiée"),l.current=0,a.current&&(clearTimeout(a.current),a.current=null),w(),!0),[w]);return s.jsx(sn.Provider,{value:{isConnected:n,subscribe:y,reconnect:S},children:e})}function mt(){const e=i.useContext(sn);if(!e)throw new Error("useWebSocketContext doit être utilisé à l'intérieur d'un WebSocketProvider");return e}function oe({dataType:e,queryKeysToInvalidate:n,onNewData:t}){const{isConnected:r,subscribe:o,reconnect:a}=mt();return i.useEffect(()=>o({dataType:e,queryKeysToInvalidate:n,onNewData:t}),[e,o,...n]),{isConnected:r,reconnect:a}}function cn(){mt();const[e,n]=i.useState({emails:0,notifications:0}),[t,r]=i.useState([]),[o,a]=i.useState([]),{isConnected:c}=oe({dataType:"notifications",queryKeysToInvalidate:["/api/notifications/unread","/api/notifications"],onNewData:m=>{m&&m.notification&&(r(g=>[m.notification,...g]),a(g=>[m.notification,...g]),n(g=>({...g,notifications:g.notifications+1})))}}),{isConnected:l}=oe({dataType:"emails",queryKeysToInvalidate:["/api/email-unread-count"],onNewData:m=>{m&&typeof m.count=="number"&&n(g=>({...g,emails:m.count}))}}),{isConnected:u}=oe({dataType:"leads",queryKeysToInvalidate:["/api/leads"]}),{isConnected:f}=oe({dataType:"demandes",queryKeysToInvalidate:["/api/service-requests"]}),{isConnected:d}=oe({dataType:"paiements",queryKeysToInvalidate:["/api/payments"]}),{isConnected:h}=oe({dataType:"dashboard",queryKeysToInvalidate:["/api/dashboard"]}),{isConnected:p}=oe({dataType:"performance",queryKeysToInvalidate:["/api/performance-metrics"]}),{isConnected:w}=oe({dataType:"contacts",queryKeysToInvalidate:["/api/contacts"]}),y=()=>{r([]),n(m=>({...m,notifications:0}))};i.useEffect(()=>{fetch("/api/email-unread-count",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(m=>{if(!m.ok)throw m.status===401?new Error("not_authenticated"):new Error(`Erreur HTTP ${m.status}`);const g=m.headers.get("content-type");if(g&&g.includes("application/json"))return m.json();throw new Error("response_not_json")}).then(m=>{m&&typeof m.count=="number"&&n(g=>({...g,emails:m.count}))}).catch(m=>{if(m.message==="not_authenticated"||m.message==="response_not_json"){console.warn(`Emails: ${m.message}`);return}console.warn("Erreur lors du rafraîchissement du compteur d'emails:",m.message||"Erreur inconnue")}),fetch("/api/notifications/unread",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(m=>{if(!m.ok)throw m.status===401?new Error("not_authenticated"):new Error(`Erreur HTTP ${m.status}`);const g=m.headers.get("content-type");if(g&&g.includes("application/json"))return m.json();throw new Error("response_not_json")}).then(m=>{m&&Array.isArray(m)&&n(g=>({...g,notifications:m.length}))}).catch(m=>{if(m.message==="not_authenticated"||m.message==="response_not_json"){console.warn(`Notifications: ${m.message}`);return}console.warn("Erreur lors du rafraîchissement du compteur de notifications:",m.message||"Erreur inconnue")})},[]);const S=m=>{console.log(`Marquage de la notification ${m} comme lue - début de l'opération`),r(g=>g.filter(v=>v.id!==m)),a(g=>g.map(v=>v.id===m?{...v,read:!0}:v)),n(g=>({...g,notifications:Math.max(0,g.notifications-1)})),console.log(`Envoi de la requête API pour marquer la notification ${m} comme lue`),fetch(`/api/notifications/${m}/mark-read`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin"}).then(g=>{console.log(`Réponse de l'API pour marquer la notification ${m} comme lue: status=${g.status}`),!g.ok&&g.status!==401?console.warn(`Erreur HTTP ${g.status} lors du marquage de notification comme lue`):g.ok&&console.log(`Notification ${m} marquée comme lue avec succès`)}).catch(g=>{console.error("Erreur lors du marquage de la notification:",g.message||"Erreur inconnue")})};return i.useEffect(()=>{fetch("/api/notifications/unread",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(m=>{if(!m.ok)throw m.status===401?new Error("not_authenticated"):new Error(`Erreur HTTP ${m.status}`);const g=m.headers.get("content-type");if(g&&g.includes("application/json"))return m.json();throw new Error("response_not_json")}).then(m=>{if(m&&Array.isArray(m)){const g=m.map(v=>({...v,read:!1}));a(g)}}).catch(m=>{if(m.message==="not_authenticated"||m.message==="response_not_json"){console.warn(`Chargement notifications: ${m.message}`),a([]);return}console.warn("Erreur lors du chargement des notifications:",m.message||"Erreur inconnue"),a([])})},[]),{leads:{isConnected:u},demandes:{isConnected:f},paiements:{isConnected:d},emails:{isConnected:l},dashboard:{isConnected:h},performance:{isConnected:p},notifications:{isConnected:c,allNotifications:o,newNotifications:t,resetNewNotifications:y,markAsRead:S},contacts:{isConnected:w},unreadCounts:e}}function K(e){const n=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&n==="[object Date]"?new e.constructor(+e):typeof e=="number"||n==="[object Number]"||typeof e=="string"||n==="[object String]"?new Date(e):new Date(NaN)}function le(e,n){return e instanceof Date?new e.constructor(n):new Date(n)}const ln=6048e5,ra=864e5,El=6e4,Ml=36e5,Tl=43200,Nl=1440;let oa={};function Ve(){return oa}function Te(e,n){var l,u,f,d;const t=Ve(),r=(n==null?void 0:n.weekStartsOn)??((u=(l=n==null?void 0:n.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??t.weekStartsOn??((d=(f=t.locale)==null?void 0:f.options)==null?void 0:d.weekStartsOn)??0,o=K(e),a=o.getDay(),c=(a<r?7:0)+a-r;return o.setDate(o.getDate()-c),o.setHours(0,0,0,0),o}function Fe(e){return Te(e,{weekStartsOn:1})}function un(e){const n=K(e),t=n.getFullYear(),r=le(e,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const o=Fe(r),a=le(e,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const c=Fe(a);return n.getTime()>=o.getTime()?t+1:n.getTime()>=c.getTime()?t:t-1}function Lt(e){const n=K(e);return n.setHours(0,0,0,0),n}function Wt(e){const n=K(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function aa(e,n){const t=Lt(e),r=Lt(n),o=+t-Wt(t),a=+r-Wt(r);return Math.round((o-a)/ra)}function sa(e){const n=un(e),t=le(e,0);return t.setFullYear(n,0,4),t.setHours(0,0,0,0),Fe(t)}function ia(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ca(e){if(!ia(e)&&typeof e!="number")return!1;const n=K(e);return!isNaN(Number(n))}function la(e){const n=K(e),t=le(e,0);return t.setFullYear(n.getFullYear(),0,1),t.setHours(0,0,0,0),t}const ua={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},da=(e,n,t)=>{let r;const o=ua[e];return typeof o=="string"?r=o:n===1?r=o.one:r=o.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function pe(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const fa={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ma={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ha={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pa={date:pe({formats:fa,defaultWidth:"full"}),time:pe({formats:ma,defaultWidth:"full"}),dateTime:pe({formats:ha,defaultWidth:"full"})},ga={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},va=(e,n,t,r)=>ga[e];function Z(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let o;if(r==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,l=t!=null&&t.width?String(t.width):c;o=e.formattingValues[l]||e.formattingValues[c]}else{const c=e.defaultWidth,l=t!=null&&t.width?String(t.width):e.defaultWidth;o=e.values[l]||e.values[c]}const a=e.argumentCallback?e.argumentCallback(n):n;return o[a]}}const wa={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ya={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ba={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},xa={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ca={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Sa={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Pa=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Ea={ordinalNumber:Pa,era:Z({values:wa,defaultWidth:"wide"}),quarter:Z({values:ya,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Z({values:ba,defaultWidth:"wide"}),day:Z({values:xa,defaultWidth:"wide"}),dayPeriod:Z({values:Ca,defaultWidth:"wide",formattingValues:Sa,defaultFormattingWidth:"wide"})};function ee(e){return(n,t={})=>{const r=t.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=n.match(o);if(!a)return null;const c=a[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?Ta(l,h=>h.test(c)):Ma(l,h=>h.test(c));let f;f=e.valueCallback?e.valueCallback(u):u,f=t.valueCallback?t.valueCallback(f):f;const d=n.slice(c.length);return{value:f,rest:d}}}function Ma(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function Ta(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function dn(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const o=r[0],a=n.match(e.parsePattern);if(!a)return null;let c=e.valueCallback?e.valueCallback(a[0]):a[0];c=t.valueCallback?t.valueCallback(c):c;const l=n.slice(o.length);return{value:c,rest:l}}}const Na=/^(\d+)(th|st|nd|rd)?/i,ja=/\d+/i,Ra={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ka={any:[/^b/i,/^(a|c)/i]},Aa={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_a={any:[/1/i,/2/i,/3/i,/4/i]},Da={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Oa={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ia={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},La={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Wa={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$a={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Fa={ordinalNumber:dn({matchPattern:Na,parsePattern:ja,valueCallback:e=>parseInt(e,10)}),era:ee({matchPatterns:Ra,defaultMatchWidth:"wide",parsePatterns:ka,defaultParseWidth:"any"}),quarter:ee({matchPatterns:Aa,defaultMatchWidth:"wide",parsePatterns:_a,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ee({matchPatterns:Da,defaultMatchWidth:"wide",parsePatterns:Oa,defaultParseWidth:"any"}),day:ee({matchPatterns:Ia,defaultMatchWidth:"wide",parsePatterns:La,defaultParseWidth:"any"}),dayPeriod:ee({matchPatterns:Wa,defaultMatchWidth:"any",parsePatterns:$a,defaultParseWidth:"any"})},Ha={code:"en-US",formatDistance:da,formatLong:pa,formatRelative:va,localize:Ea,match:Fa,options:{weekStartsOn:0,firstWeekContainsDate:1}};function qa(e){const n=K(e);return aa(n,la(n))+1}function Ya(e){const n=K(e),t=+Fe(n)-+sa(n);return Math.round(t/ln)+1}function fn(e,n){var d,h,p,w;const t=K(e),r=t.getFullYear(),o=Ve(),a=(n==null?void 0:n.firstWeekContainsDate)??((h=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??o.firstWeekContainsDate??((w=(p=o.locale)==null?void 0:p.options)==null?void 0:w.firstWeekContainsDate)??1,c=le(e,0);c.setFullYear(r+1,0,a),c.setHours(0,0,0,0);const l=Te(c,n),u=le(e,0);u.setFullYear(r,0,a),u.setHours(0,0,0,0);const f=Te(u,n);return t.getTime()>=l.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function Ua(e,n){var l,u,f,d;const t=Ve(),r=(n==null?void 0:n.firstWeekContainsDate)??((u=(l=n==null?void 0:n.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??t.firstWeekContainsDate??((d=(f=t.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??1,o=fn(e,n),a=le(e,0);return a.setFullYear(o,0,r),a.setHours(0,0,0,0),Te(a,n)}function za(e,n){const t=K(e),r=+Te(t,n)-+Ua(t,n);return Math.round(r/ln)+1}function _(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const ae={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return _(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):_(t+1,2)},d(e,n){return _(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return _(e.getHours()%12||12,n.length)},H(e,n){return _(e.getHours(),n.length)},m(e,n){return _(e.getMinutes(),n.length)},s(e,n){return _(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),o=Math.trunc(r*Math.pow(10,t-3));return _(o,n.length)}},he={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$t={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),o=r>0?r:1-r;return t.ordinalNumber(o,{unit:"year"})}return ae.y(e,n)},Y:function(e,n,t,r){const o=fn(e,r),a=o>0?o:1-o;if(n==="YY"){const c=a%100;return _(c,2)}return n==="Yo"?t.ordinalNumber(a,{unit:"year"}):_(a,n.length)},R:function(e,n){const t=un(e);return _(t,n.length)},u:function(e,n){const t=e.getFullYear();return _(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return _(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return _(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return ae.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return _(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const o=za(e,r);return n==="wo"?t.ordinalNumber(o,{unit:"week"}):_(o,n.length)},I:function(e,n,t){const r=Ya(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):_(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):ae.d(e,n)},D:function(e,n,t){const r=qa(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):_(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const o=e.getDay(),a=(o-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(a);case"ee":return _(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(o,{width:"short",context:"formatting"});case"eeee":default:return t.day(o,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const o=e.getDay(),a=(o-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(a);case"cc":return _(a,n.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(o,{width:"narrow",context:"standalone"});case"cccccc":return t.day(o,{width:"short",context:"standalone"});case"cccc":default:return t.day(o,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),o=r===0?7:r;switch(n){case"i":return String(o);case"ii":return _(o,n.length);case"io":return t.ordinalNumber(o,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const o=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let o;switch(r===12?o=he.noon:r===0?o=he.midnight:o=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let o;switch(r>=17?o=he.evening:r>=12?o=he.afternoon:r>=4?o=he.morning:o=he.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return ae.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):ae.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):_(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):_(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):ae.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):ae.s(e,n)},S:function(e,n){return ae.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Ht(r);case"XXXX":case"XX":return ce(r);case"XXXXX":case"XXX":default:return ce(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Ht(r);case"xxxx":case"xx":return ce(r);case"xxxxx":case"xxx":default:return ce(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Ft(r,":");case"OOOO":default:return"GMT"+ce(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Ft(r,":");case"zzzz":default:return"GMT"+ce(r,":")}},t:function(e,n,t){const r=Math.trunc(e.getTime()/1e3);return _(r,n.length)},T:function(e,n,t){const r=e.getTime();return _(r,n.length)}};function Ft(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),o=Math.trunc(r/60),a=r%60;return a===0?t+String(o):t+String(o)+n+_(a,2)}function Ht(e,n){return e%60===0?(e>0?"-":"+")+_(Math.abs(e)/60,2):ce(e,n)}function ce(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),o=_(Math.trunc(r/60),2),a=_(r%60,2);return t+o+n+a}const qt=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},mn=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},Ba=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],o=t[2];if(!o)return qt(e,n);let a;switch(r){case"P":a=n.dateTime({width:"short"});break;case"PP":a=n.dateTime({width:"medium"});break;case"PPP":a=n.dateTime({width:"long"});break;case"PPPP":default:a=n.dateTime({width:"full"});break}return a.replace("{{date}}",qt(r,n)).replace("{{time}}",mn(o,n))},Ga={p:mn,P:Ba},Va=/^D+$/,Xa=/^Y+$/,Ka=["D","DD","YY","YYYY"];function Ja(e){return Va.test(e)}function Qa(e){return Xa.test(e)}function Za(e,n,t){const r=es(e,n,t);if(console.warn(r),Ka.includes(e))throw new RangeError(r)}function es(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ts=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ns=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rs=/^'([^]*?)'?$/,os=/''/g,as=/[a-zA-Z]/;function He(e,n,t){var d,h,p,w,y,S,m,g;const r=Ve(),o=(t==null?void 0:t.locale)??r.locale??Ha,a=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((w=(p=r.locale)==null?void 0:p.options)==null?void 0:w.firstWeekContainsDate)??1,c=(t==null?void 0:t.weekStartsOn)??((S=(y=t==null?void 0:t.locale)==null?void 0:y.options)==null?void 0:S.weekStartsOn)??r.weekStartsOn??((g=(m=r.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??0,l=K(e);if(!ca(l))throw new RangeError("Invalid time value");let u=n.match(ns).map(v=>{const b=v[0];if(b==="p"||b==="P"){const x=Ga[b];return x(v,o.formatLong)}return v}).join("").match(ts).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const b=v[0];if(b==="'")return{isToken:!1,value:ss(v)};if($t[b])return{isToken:!0,value:v};if(b.match(as))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:v}});o.localize.preprocessor&&(u=o.localize.preprocessor(l,u));const f={firstWeekContainsDate:a,weekStartsOn:c,locale:o};return u.map(v=>{if(!v.isToken)return v.value;const b=v.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&Qa(b)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&Ja(b))&&Za(b,n,String(e));const x=$t[b[0]];return x(l,b,o.localize,f)}).join("")}function ss(e){const n=e.match(rs);return n?n[1].replace(os,"'"):e}const is={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},cs=(e,n,t)=>{let r;const o=is[e];return typeof o=="string"?r=o:n===1?r=o.one:r=o.other.replace("{{count}}",String(n)),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"dans "+r:"il y a "+r:r},ls={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},us={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},ds={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fs={date:pe({formats:ls,defaultWidth:"full"}),time:pe({formats:us,defaultWidth:"full"}),dateTime:pe({formats:ds,defaultWidth:"full"})},ms={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},hs=(e,n,t,r)=>ms[e],ps={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},gs={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},vs={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ws={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},ys={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},bs=(e,n)=>{const t=Number(e),r=n==null?void 0:n.unit;if(t===0)return"0";const o=["year","week","hour","minute","second"];let a;return t===1?a=r&&o.includes(r)?"ère":"er":a="ème",t+a},xs=["MMM","MMMM"],Cs={preprocessor:(e,n)=>e.getDate()===1||!n.some(r=>r.isToken&&xs.includes(r.value))?n:n.map(r=>r.isToken&&r.value==="do"?{isToken:!0,value:"d"}:r),ordinalNumber:bs,era:Z({values:ps,defaultWidth:"wide"}),quarter:Z({values:gs,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Z({values:vs,defaultWidth:"wide"}),day:Z({values:ws,defaultWidth:"wide"}),dayPeriod:Z({values:ys,defaultWidth:"wide"})},Ss=/^(\d+)(ième|ère|ème|er|e)?/i,Ps=/\d+/i,Es={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},Ms={any:[/^av/i,/^ap/i]},Ts={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},Ns={any:[/1/i,/2/i,/3/i,/4/i]},js={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},Rs={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},ks={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},As={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},_s={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},Ds={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},Os={ordinalNumber:dn({matchPattern:Ss,parsePattern:Ps,valueCallback:e=>parseInt(e)}),era:ee({matchPatterns:Es,defaultMatchWidth:"wide",parsePatterns:Ms,defaultParseWidth:"any"}),quarter:ee({matchPatterns:Ts,defaultMatchWidth:"wide",parsePatterns:Ns,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ee({matchPatterns:js,defaultMatchWidth:"wide",parsePatterns:Rs,defaultParseWidth:"any"}),day:ee({matchPatterns:ks,defaultMatchWidth:"wide",parsePatterns:As,defaultParseWidth:"any"}),dayPeriod:ee({matchPatterns:_s,defaultMatchWidth:"any",parsePatterns:Ds,defaultParseWidth:"any"})},qe={code:"fr",formatDistance:cs,formatLong:fs,formatRelative:hs,localize:Cs,match:Os,options:{weekStartsOn:1,firstWeekContainsDate:4}};function Is(e,n){return i.useReducer((t,r)=>n[t][r]??t,e)}var ht="ScrollArea",[hn,jl]=Ae(ht),[Ls,V]=hn(ht),pn=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,type:r="hover",dir:o,scrollHideDelay:a=600,...c}=e,[l,u]=i.useState(null),[f,d]=i.useState(null),[h,p]=i.useState(null),[w,y]=i.useState(null),[S,m]=i.useState(null),[g,v]=i.useState(0),[b,x]=i.useState(0),[N,E]=i.useState(!1),[P,D]=i.useState(!1),j=$(n,L=>u(L)),A=tn(o);return s.jsx(Ls,{scope:t,type:r,dir:A,scrollHideDelay:a,scrollArea:l,viewport:f,onViewportChange:d,content:h,onContentChange:p,scrollbarX:w,onScrollbarXChange:y,scrollbarXEnabled:N,onScrollbarXEnabledChange:E,scrollbarY:S,onScrollbarYChange:m,scrollbarYEnabled:P,onScrollbarYEnabledChange:D,onCornerWidthChange:v,onCornerHeightChange:x,children:s.jsx(X.div,{dir:A,...c,ref:j,style:{position:"relative","--radix-scroll-area-corner-width":g+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});pn.displayName=ht;var gn="ScrollAreaViewport",vn=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,children:r,nonce:o,...a}=e,c=V(gn,t),l=i.useRef(null),u=$(n,l,c.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),s.jsx(X.div,{"data-radix-scroll-area-viewport":"",...a,ref:u,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...e.style},children:s.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});vn.displayName=gn;var te="ScrollAreaScrollbar",pt=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=V(te,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:c}=o,l=e.orientation==="horizontal";return i.useEffect(()=>(l?a(!0):c(!0),()=>{l?a(!1):c(!1)}),[l,a,c]),o.type==="hover"?s.jsx(Ws,{...r,ref:n,forceMount:t}):o.type==="scroll"?s.jsx($s,{...r,ref:n,forceMount:t}):o.type==="auto"?s.jsx(wn,{...r,ref:n,forceMount:t}):o.type==="always"?s.jsx(gt,{...r,ref:n}):null});pt.displayName=te;var Ws=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=V(te,e.__scopeScrollArea),[a,c]=i.useState(!1);return i.useEffect(()=>{const l=o.scrollArea;let u=0;if(l){const f=()=>{window.clearTimeout(u),c(!0)},d=()=>{u=window.setTimeout(()=>c(!1),o.scrollHideDelay)};return l.addEventListener("pointerenter",f),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(u),l.removeEventListener("pointerenter",f),l.removeEventListener("pointerleave",d)}}},[o.scrollArea,o.scrollHideDelay]),s.jsx(se,{present:t||a,children:s.jsx(wn,{"data-state":a?"visible":"hidden",...r,ref:n})})}),$s=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=V(te,e.__scopeScrollArea),a=e.orientation==="horizontal",c=Ke(()=>u("SCROLL_END"),100),[l,u]=Is("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(l==="idle"){const f=window.setTimeout(()=>u("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(f)}},[l,o.scrollHideDelay,u]),i.useEffect(()=>{const f=o.viewport,d=a?"scrollLeft":"scrollTop";if(f){let h=f[d];const p=()=>{const w=f[d];h!==w&&(u("SCROLL"),c()),h=w};return f.addEventListener("scroll",p),()=>f.removeEventListener("scroll",p)}},[o.viewport,a,u,c]),s.jsx(se,{present:t||l!=="hidden",children:s.jsx(gt,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:n,onPointerEnter:R(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:R(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),wn=i.forwardRef((e,n)=>{const t=V(te,e.__scopeScrollArea),{forceMount:r,...o}=e,[a,c]=i.useState(!1),l=e.orientation==="horizontal",u=Ke(()=>{if(t.viewport){const f=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;c(l?f:d)}},10);return ve(t.viewport,u),ve(t.content,u),s.jsx(se,{present:r||a,children:s.jsx(gt,{"data-state":a?"visible":"hidden",...o,ref:n})})}),gt=i.forwardRef((e,n)=>{const{orientation:t="vertical",...r}=e,o=V(te,e.__scopeScrollArea),a=i.useRef(null),c=i.useRef(0),[l,u]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=Sn(l.viewport,l.content),d={...r,sizes:l,onSizesChange:u,hasThumb:f>0&&f<1,onThumbChange:p=>a.current=p,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:p=>c.current=p};function h(p,w){return zs(p,c.current,l,w)}return t==="horizontal"?s.jsx(Fs,{...d,ref:n,onThumbPositionChange:()=>{if(o.viewport&&a.current){const p=o.viewport.scrollLeft,w=Yt(p,l,o.dir);a.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:p=>{o.viewport&&(o.viewport.scrollLeft=p)},onDragScroll:p=>{o.viewport&&(o.viewport.scrollLeft=h(p,o.dir))}}):t==="vertical"?s.jsx(Hs,{...d,ref:n,onThumbPositionChange:()=>{if(o.viewport&&a.current){const p=o.viewport.scrollTop,w=Yt(p,l);a.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:p=>{o.viewport&&(o.viewport.scrollTop=p)},onDragScroll:p=>{o.viewport&&(o.viewport.scrollTop=h(p))}}):null}),Fs=i.forwardRef((e,n)=>{const{sizes:t,onSizesChange:r,...o}=e,a=V(te,e.__scopeScrollArea),[c,l]=i.useState(),u=i.useRef(null),f=$(n,u,a.onScrollbarXChange);return i.useEffect(()=>{u.current&&l(getComputedStyle(u.current))},[u]),s.jsx(bn,{"data-orientation":"horizontal",...o,ref:f,sizes:t,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Xe(t)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(a.viewport){const p=a.viewport.scrollLeft+d.deltaX;e.onWheelScroll(p),En(p,h)&&d.preventDefault()}},onResize:()=>{u.current&&a.viewport&&c&&r({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:Ue(c.paddingLeft),paddingEnd:Ue(c.paddingRight)}})}})}),Hs=i.forwardRef((e,n)=>{const{sizes:t,onSizesChange:r,...o}=e,a=V(te,e.__scopeScrollArea),[c,l]=i.useState(),u=i.useRef(null),f=$(n,u,a.onScrollbarYChange);return i.useEffect(()=>{u.current&&l(getComputedStyle(u.current))},[u]),s.jsx(bn,{"data-orientation":"vertical",...o,ref:f,sizes:t,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Xe(t)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(a.viewport){const p=a.viewport.scrollTop+d.deltaY;e.onWheelScroll(p),En(p,h)&&d.preventDefault()}},onResize:()=>{u.current&&a.viewport&&c&&r({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:Ue(c.paddingTop),paddingEnd:Ue(c.paddingBottom)}})}})}),[qs,yn]=hn(te),bn=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,sizes:r,hasThumb:o,onThumbChange:a,onThumbPointerUp:c,onThumbPointerDown:l,onThumbPositionChange:u,onDragScroll:f,onWheelScroll:d,onResize:h,...p}=e,w=V(te,t),[y,S]=i.useState(null),m=$(n,j=>S(j)),g=i.useRef(null),v=i.useRef(""),b=w.viewport,x=r.content-r.viewport,N=z(d),E=z(u),P=Ke(h,10);function D(j){if(g.current){const A=j.clientX-g.current.left,L=j.clientY-g.current.top;f({x:A,y:L})}}return i.useEffect(()=>{const j=A=>{const L=A.target;(y==null?void 0:y.contains(L))&&N(A,x)};return document.addEventListener("wheel",j,{passive:!1}),()=>document.removeEventListener("wheel",j,{passive:!1})},[b,y,x,N]),i.useEffect(E,[r,E]),ve(y,P),ve(w.content,P),s.jsx(qs,{scope:t,scrollbar:y,hasThumb:o,onThumbChange:z(a),onThumbPointerUp:z(c),onThumbPositionChange:E,onThumbPointerDown:z(l),children:s.jsx(X.div,{...p,ref:m,style:{position:"absolute",...p.style},onPointerDown:R(e.onPointerDown,j=>{j.button===0&&(j.target.setPointerCapture(j.pointerId),g.current=y.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",w.viewport&&(w.viewport.style.scrollBehavior="auto"),D(j))}),onPointerMove:R(e.onPointerMove,D),onPointerUp:R(e.onPointerUp,j=>{const A=j.target;A.hasPointerCapture(j.pointerId)&&A.releasePointerCapture(j.pointerId),document.body.style.webkitUserSelect=v.current,w.viewport&&(w.viewport.style.scrollBehavior=""),g.current=null})})})}),Ye="ScrollAreaThumb",xn=i.forwardRef((e,n)=>{const{forceMount:t,...r}=e,o=yn(Ye,e.__scopeScrollArea);return s.jsx(se,{present:t||o.hasThumb,children:s.jsx(Ys,{ref:n,...r})})}),Ys=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,style:r,...o}=e,a=V(Ye,t),c=yn(Ye,t),{onThumbPositionChange:l}=c,u=$(n,h=>c.onThumbChange(h)),f=i.useRef(void 0),d=Ke(()=>{f.current&&(f.current(),f.current=void 0)},100);return i.useEffect(()=>{const h=a.viewport;if(h){const p=()=>{if(d(),!f.current){const w=Bs(h,l);f.current=w,l()}};return l(),h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[a.viewport,d,l]),s.jsx(X.div,{"data-state":c.hasThumb?"visible":"hidden",...o,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:R(e.onPointerDownCapture,h=>{const w=h.target.getBoundingClientRect(),y=h.clientX-w.left,S=h.clientY-w.top;c.onThumbPointerDown({x:y,y:S})}),onPointerUp:R(e.onPointerUp,c.onThumbPointerUp)})});xn.displayName=Ye;var vt="ScrollAreaCorner",Cn=i.forwardRef((e,n)=>{const t=V(vt,e.__scopeScrollArea),r=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&r?s.jsx(Us,{...e,ref:n}):null});Cn.displayName=vt;var Us=i.forwardRef((e,n)=>{const{__scopeScrollArea:t,...r}=e,o=V(vt,t),[a,c]=i.useState(0),[l,u]=i.useState(0),f=!!(a&&l);return ve(o.scrollbarX,()=>{var h;const d=((h=o.scrollbarX)==null?void 0:h.offsetHeight)||0;o.onCornerHeightChange(d),u(d)}),ve(o.scrollbarY,()=>{var h;const d=((h=o.scrollbarY)==null?void 0:h.offsetWidth)||0;o.onCornerWidthChange(d),c(d)}),f?s.jsx(X.div,{...r,ref:n,style:{width:a,height:l,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Ue(e){return e?parseInt(e,10):0}function Sn(e,n){const t=e/n;return isNaN(t)?0:t}function Xe(e){const n=Sn(e.viewport,e.content),t=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-t)*n;return Math.max(r,18)}function zs(e,n,t,r="ltr"){const o=Xe(t),a=o/2,c=n||a,l=o-c,u=t.scrollbar.paddingStart+c,f=t.scrollbar.size-t.scrollbar.paddingEnd-l,d=t.content-t.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return Pn([u,f],h)(e)}function Yt(e,n,t="ltr"){const r=Xe(n),o=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,a=n.scrollbar.size-o,c=n.content-n.viewport,l=a-r,u=t==="ltr"?[0,c]:[c*-1,0],f=Eo(e,u);return Pn([0,c],[0,l])(f)}function Pn(e,n){return t=>{if(e[0]===e[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(e[1]-e[0]);return n[0]+r*(t-e[0])}}function En(e,n){return e>0&&e<n}var Bs=(e,n=()=>{})=>{let t={left:e.scrollLeft,top:e.scrollTop},r=0;return function o(){const a={left:e.scrollLeft,top:e.scrollTop},c=t.left!==a.left,l=t.top!==a.top;(c||l)&&n(),t=a,r=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(r)};function Ke(e,n){const t=z(e),r=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(r.current),[]),i.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(t,n)},[t,n])}function ve(e,n){const t=z(n);ge(()=>{let r=0;if(e){const o=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return o.observe(e),()=>{window.cancelAnimationFrame(r),o.unobserve(e)}}},[e,t])}var Mn=pn,Gs=vn,Vs=Cn;const wt=i.forwardRef(({className:e,children:n,...t},r)=>s.jsxs(Mn,{ref:r,className:G("relative overflow-hidden",e),...t,children:[s.jsx(Gs,{className:"h-full w-full rounded-[inherit]",children:n}),s.jsx(Tn,{}),s.jsx(Vs,{})]}));wt.displayName=Mn.displayName;const Tn=i.forwardRef(({className:e,orientation:n="vertical",...t},r)=>s.jsx(pt,{ref:r,orientation:n,className:G("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...t,children:s.jsx(xn,{className:"relative flex-1 rounded-full bg-border"})}));Tn.displayName=pt.displayName;var Xs=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ue=Xs.reduce((e,n)=>{const t=Xt(`Primitive.${n}`),r=i.forwardRef((o,a)=>{const{asChild:c,...l}=o,u=c?t:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(u,{...l,ref:a})});return r.displayName=`Primitive.${n}`,{...e,[n]:r}},{});function Ks(e,n){e&&to.flushSync(()=>e.dispatchEvent(n))}var Js="DismissableLayer",st="dismissableLayer.update",Qs="dismissableLayer.pointerDownOutside",Zs="dismissableLayer.focusOutside",Ut,Nn=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),jn=i.forwardRef((e,n)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:a,onInteractOutside:c,onDismiss:l,...u}=e,f=i.useContext(Nn),[d,h]=i.useState(null),p=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,w]=i.useState({}),y=$(n,P=>h(P)),S=Array.from(f.layers),[m]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),g=S.indexOf(m),v=d?S.indexOf(d):-1,b=f.layersWithOutsidePointerEventsDisabled.size>0,x=v>=g,N=ni(P=>{const D=P.target,j=[...f.branches].some(A=>A.contains(D));!x||j||(o==null||o(P),c==null||c(P),P.defaultPrevented||l==null||l())},p),E=ri(P=>{const D=P.target;[...f.branches].some(A=>A.contains(D))||(a==null||a(P),c==null||c(P),P.defaultPrevented||l==null||l())},p);return no(P=>{v===f.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&l&&(P.preventDefault(),l()))},p),i.useEffect(()=>{if(d)return t&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(Ut=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(d)),f.layers.add(d),zt(),()=>{t&&f.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=Ut)}},[d,p,t,f]),i.useEffect(()=>()=>{d&&(f.layers.delete(d),f.layersWithOutsidePointerEventsDisabled.delete(d),zt())},[d,f]),i.useEffect(()=>{const P=()=>w({});return document.addEventListener(st,P),()=>document.removeEventListener(st,P)},[]),s.jsx(ue.div,{...u,ref:y,style:{pointerEvents:b?x?"auto":"none":void 0,...e.style},onFocusCapture:R(e.onFocusCapture,E.onFocusCapture),onBlurCapture:R(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:R(e.onPointerDownCapture,N.onPointerDownCapture)})});jn.displayName=Js;var ei="DismissableLayerBranch",ti=i.forwardRef((e,n)=>{const t=i.useContext(Nn),r=i.useRef(null),o=$(n,r);return i.useEffect(()=>{const a=r.current;if(a)return t.branches.add(a),()=>{t.branches.delete(a)}},[t.branches]),s.jsx(ue.div,{...e,ref:o})});ti.displayName=ei;function ni(e,n=globalThis==null?void 0:globalThis.document){const t=z(e),r=i.useRef(!1),o=i.useRef(()=>{});return i.useEffect(()=>{const a=l=>{if(l.target&&!r.current){let u=function(){Rn(Qs,t,f,{discrete:!0})};const f={originalEvent:l};l.pointerType==="touch"?(n.removeEventListener("click",o.current),o.current=u,n.addEventListener("click",o.current,{once:!0})):u()}else n.removeEventListener("click",o.current);r.current=!1},c=window.setTimeout(()=>{n.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(c),n.removeEventListener("pointerdown",a),n.removeEventListener("click",o.current)}},[n,t]),{onPointerDownCapture:()=>r.current=!0}}function ri(e,n=globalThis==null?void 0:globalThis.document){const t=z(e),r=i.useRef(!1);return i.useEffect(()=>{const o=a=>{a.target&&!r.current&&Rn(Zs,t,{originalEvent:a},{discrete:!1})};return n.addEventListener("focusin",o),()=>n.removeEventListener("focusin",o)},[n,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function zt(){const e=new CustomEvent(st);document.dispatchEvent(e)}function Rn(e,n,t,{discrete:r}){const o=t.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});n&&o.addEventListener(e,n,{once:!0}),r?Ks(o,a):o.dispatchEvent(a)}var oi="Arrow",kn=i.forwardRef((e,n)=>{const{children:t,width:r=10,height:o=5,...a}=e;return s.jsx(ue.svg,{...a,ref:n,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?t:s.jsx("polygon",{points:"0,0 30,0 15,10"})})});kn.displayName=oi;var ai=kn,yt="Popper",[An,_n]=Ae(yt),[si,Dn]=An(yt),On=e=>{const{__scopePopper:n,children:t}=e,[r,o]=i.useState(null);return s.jsx(si,{scope:n,anchor:r,onAnchorChange:o,children:t})};On.displayName=yt;var In="PopperAnchor",Ln=i.forwardRef((e,n)=>{const{__scopePopper:t,virtualRef:r,...o}=e,a=Dn(In,t),c=i.useRef(null),l=$(n,c);return i.useEffect(()=>{a.onAnchorChange((r==null?void 0:r.current)||c.current)}),r?null:s.jsx(ue.div,{...o,ref:l})});Ln.displayName=In;var bt="PopperContent",[ii,ci]=An(bt),Wn=i.forwardRef((e,n)=>{var re,xe,U,Ce,_t,Dt;const{__scopePopper:t,side:r="bottom",sideOffset:o=0,align:a="center",alignOffset:c=0,arrowPadding:l=0,avoidCollisions:u=!0,collisionBoundary:f=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:p=!1,updatePositionStrategy:w="optimized",onPlaced:y,...S}=e,m=Dn(bt,t),[g,v]=i.useState(null),b=$(n,Se=>v(Se)),[x,N]=i.useState(null),E=Fo(x),P=(E==null?void 0:E.width)??0,D=(E==null?void 0:E.height)??0,j=r+(a!=="center"?"-"+a:""),A=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},L=Array.isArray(f)?f:[f],ne=L.length>0,J={padding:A,boundary:L.filter(ui),altBoundary:ne},{refs:M,floatingStyles:k,placement:T,isPositioned:W,middlewareData:O}=Mo({strategy:"fixed",placement:j,whileElementsMounted:(...Se)=>To(...Se,{animationFrame:w==="always"}),elements:{reference:m.anchor},middleware:[No({mainAxis:o+D,alignmentAxis:c}),u&&jo({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?Do():void 0,...J}),u&&Ro({...J}),ko({...J,apply:({elements:Se,rects:Ot,availableWidth:Kr,availableHeight:Jr})=>{const{width:Qr,height:Zr}=Ot.reference,Ie=Se.floating.style;Ie.setProperty("--radix-popper-available-width",`${Kr}px`),Ie.setProperty("--radix-popper-available-height",`${Jr}px`),Ie.setProperty("--radix-popper-anchor-width",`${Qr}px`),Ie.setProperty("--radix-popper-anchor-height",`${Zr}px`)}}),x&&Ao({element:x,padding:l}),di({arrowWidth:P,arrowHeight:D}),p&&_o({strategy:"referenceHidden",...J})]}),[C,I]=Hn(T),F=z(y);ge(()=>{W&&(F==null||F())},[W,F]);const Q=(re=O.arrow)==null?void 0:re.x,ye=(xe=O.arrow)==null?void 0:xe.y,be=((U=O.arrow)==null?void 0:U.centerOffset)!==0,[Oe,ie]=i.useState();return ge(()=>{g&&ie(window.getComputedStyle(g).zIndex)},[g]),s.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...k,transform:W?k.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Oe,"--radix-popper-transform-origin":[(Ce=O.transformOrigin)==null?void 0:Ce.x,(_t=O.transformOrigin)==null?void 0:_t.y].join(" "),...((Dt=O.hide)==null?void 0:Dt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:s.jsx(ii,{scope:t,placedSide:C,onArrowChange:N,arrowX:Q,arrowY:ye,shouldHideArrow:be,children:s.jsx(ue.div,{"data-side":C,"data-align":I,...S,ref:b,style:{...S.style,animation:W?void 0:"none"}})})})});Wn.displayName=bt;var $n="PopperArrow",li={top:"bottom",right:"left",bottom:"top",left:"right"},Fn=i.forwardRef(function(n,t){const{__scopePopper:r,...o}=n,a=ci($n,r),c=li[a.placedSide];return s.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:s.jsx(ai,{...o,ref:t,style:{...o.style,display:"block"}})})});Fn.displayName=$n;function ui(e){return e!==null}var di=e=>({name:"transformOrigin",options:e,fn(n){var m,g,v;const{placement:t,rects:r,middlewareData:o}=n,c=((m=o.arrow)==null?void 0:m.centerOffset)!==0,l=c?0:e.arrowWidth,u=c?0:e.arrowHeight,[f,d]=Hn(t),h={start:"0%",center:"50%",end:"100%"}[d],p=(((g=o.arrow)==null?void 0:g.x)??0)+l/2,w=(((v=o.arrow)==null?void 0:v.y)??0)+u/2;let y="",S="";return f==="bottom"?(y=c?h:`${p}px`,S=`${-u}px`):f==="top"?(y=c?h:`${p}px`,S=`${r.floating.height+u}px`):f==="right"?(y=`${-u}px`,S=c?h:`${w}px`):f==="left"&&(y=`${r.floating.width+u}px`,S=c?h:`${w}px`),{data:{x:y,y:S}}}});function Hn(e){const[n,t="center"]=e.split("-");return[n,t]}var fi=On,mi=Ln,hi=Wn,pi=Fn;function gi(e,n){return i.useReducer((t,r)=>n[t][r]??t,e)}var qn=e=>{const{present:n,children:t}=e,r=vi(n),o=typeof t=="function"?t({present:r.isPresent}):i.Children.only(t),a=$(r.ref,wi(o));return typeof t=="function"||r.isPresent?i.cloneElement(o,{ref:a}):null};qn.displayName="Presence";function vi(e){const[n,t]=i.useState(),r=i.useRef(null),o=i.useRef(e),a=i.useRef("none"),c=e?"mounted":"unmounted",[l,u]=gi(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect(()=>{const f=Le(r.current);a.current=l==="mounted"?f:"none"},[l]),ge(()=>{const f=r.current,d=o.current;if(d!==e){const p=a.current,w=Le(f);e?u("MOUNT"):w==="none"||(f==null?void 0:f.display)==="none"?u("UNMOUNT"):u(d&&p!==w?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),ge(()=>{if(n){let f;const d=n.ownerDocument.defaultView??window,h=w=>{const S=Le(r.current).includes(w.animationName);if(w.target===n&&S&&(u("ANIMATION_END"),!o.current)){const m=n.style.animationFillMode;n.style.animationFillMode="forwards",f=d.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=m)})}},p=w=>{w.target===n&&(a.current=Le(r.current))};return n.addEventListener("animationstart",p),n.addEventListener("animationcancel",h),n.addEventListener("animationend",h),()=>{d.clearTimeout(f),n.removeEventListener("animationstart",p),n.removeEventListener("animationcancel",h),n.removeEventListener("animationend",h)}}else u("ANIMATION_END")},[n,u]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:i.useCallback(f=>{r.current=f?getComputedStyle(f):null,t(f)},[])}}function Le(e){return(e==null?void 0:e.animationName)||"none"}function wi(e){var r,o;let n=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,t=n&&"isReactWarning"in n&&n.isReactWarning;return t?e.ref:(n=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,t=n&&"isReactWarning"in n&&n.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var yi=ro[" useInsertionEffect ".trim().toString()]||ge;function bi({prop:e,defaultProp:n,onChange:t=()=>{},caller:r}){const[o,a,c]=xi({defaultProp:n,onChange:t}),l=e!==void 0,u=l?e:o;{const d=i.useRef(e!==void 0);i.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const f=i.useCallback(d=>{var h;if(l){const p=Ci(d)?d(e):d;p!==e&&((h=c.current)==null||h.call(c,p))}else a(d)},[l,e,a,c]);return[u,f]}function xi({defaultProp:e,onChange:n}){const[t,r]=i.useState(e),o=i.useRef(t),a=i.useRef(n);return yi(()=>{a.current=n},[n]),i.useEffect(()=>{var c;o.current!==t&&((c=a.current)==null||c.call(a,t),o.current=t)},[t,o]),[t,r,a]}function Ci(e){return typeof e=="function"}var Si=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Pi="VisuallyHidden",Yn=i.forwardRef((e,n)=>s.jsx(ue.span,{...e,ref:n,style:{...Si,...e.style}}));Yn.displayName=Pi;var Ei=Yn,[Je,Rl]=Ae("Tooltip",[_n]),Qe=_n(),Un="TooltipProvider",Mi=700,it="tooltip.open",[Ti,xt]=Je(Un),zn=e=>{const{__scopeTooltip:n,delayDuration:t=Mi,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:a}=e,c=i.useRef(!0),l=i.useRef(!1),u=i.useRef(0);return i.useEffect(()=>{const f=u.current;return()=>window.clearTimeout(f)},[]),s.jsx(Ti,{scope:n,isOpenDelayedRef:c,delayDuration:t,onOpen:i.useCallback(()=>{window.clearTimeout(u.current),c.current=!1},[]),onClose:i.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>c.current=!0,r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:i.useCallback(f=>{l.current=f},[]),disableHoverableContent:o,children:a})};zn.displayName=Un;var Ne="Tooltip",[Ni,Ze]=Je(Ne),Bn=e=>{const{__scopeTooltip:n,children:t,open:r,defaultOpen:o,onOpenChange:a,disableHoverableContent:c,delayDuration:l}=e,u=xt(Ne,e.__scopeTooltip),f=Qe(n),[d,h]=i.useState(null),p=ot(),w=i.useRef(0),y=c??u.disableHoverableContent,S=l??u.delayDuration,m=i.useRef(!1),[g,v]=bi({prop:r,defaultProp:o??!1,onChange:P=>{P?(u.onOpen(),document.dispatchEvent(new CustomEvent(it))):u.onClose(),a==null||a(P)},caller:Ne}),b=i.useMemo(()=>g?m.current?"delayed-open":"instant-open":"closed",[g]),x=i.useCallback(()=>{window.clearTimeout(w.current),w.current=0,m.current=!1,v(!0)},[v]),N=i.useCallback(()=>{window.clearTimeout(w.current),w.current=0,v(!1)},[v]),E=i.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>{m.current=!0,v(!0),w.current=0},S)},[S,v]);return i.useEffect(()=>()=>{w.current&&(window.clearTimeout(w.current),w.current=0)},[]),s.jsx(fi,{...f,children:s.jsx(Ni,{scope:n,contentId:p,open:g,stateAttribute:b,trigger:d,onTriggerChange:h,onTriggerEnter:i.useCallback(()=>{u.isOpenDelayedRef.current?E():x()},[u.isOpenDelayedRef,E,x]),onTriggerLeave:i.useCallback(()=>{y?N():(window.clearTimeout(w.current),w.current=0)},[N,y]),onOpen:x,onClose:N,disableHoverableContent:y,children:t})})};Bn.displayName=Ne;var ct="TooltipTrigger",Gn=i.forwardRef((e,n)=>{const{__scopeTooltip:t,...r}=e,o=Ze(ct,t),a=xt(ct,t),c=Qe(t),l=i.useRef(null),u=$(n,l,o.onTriggerChange),f=i.useRef(!1),d=i.useRef(!1),h=i.useCallback(()=>f.current=!1,[]);return i.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),s.jsx(mi,{asChild:!0,...c,children:s.jsx(ue.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:R(e.onPointerMove,p=>{p.pointerType!=="touch"&&!d.current&&!a.isPointerInTransitRef.current&&(o.onTriggerEnter(),d.current=!0)}),onPointerLeave:R(e.onPointerLeave,()=>{o.onTriggerLeave(),d.current=!1}),onPointerDown:R(e.onPointerDown,()=>{o.open&&o.onClose(),f.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:R(e.onFocus,()=>{f.current||o.onOpen()}),onBlur:R(e.onBlur,o.onClose),onClick:R(e.onClick,o.onClose)})})});Gn.displayName=ct;var ji="TooltipPortal",[kl,Ri]=Je(ji,{forceMount:void 0}),we="TooltipContent",Vn=i.forwardRef((e,n)=>{const t=Ri(we,e.__scopeTooltip),{forceMount:r=t.forceMount,side:o="top",...a}=e,c=Ze(we,e.__scopeTooltip);return s.jsx(qn,{present:r||c.open,children:c.disableHoverableContent?s.jsx(Xn,{side:o,...a,ref:n}):s.jsx(ki,{side:o,...a,ref:n})})}),ki=i.forwardRef((e,n)=>{const t=Ze(we,e.__scopeTooltip),r=xt(we,e.__scopeTooltip),o=i.useRef(null),a=$(n,o),[c,l]=i.useState(null),{trigger:u,onClose:f}=t,d=o.current,{onPointerInTransitChange:h}=r,p=i.useCallback(()=>{l(null),h(!1)},[h]),w=i.useCallback((y,S)=>{const m=y.currentTarget,g={x:y.clientX,y:y.clientY},v=Ii(g,m.getBoundingClientRect()),b=Li(g,v),x=Wi(S.getBoundingClientRect()),N=Fi([...b,...x]);l(N),h(!0)},[h]);return i.useEffect(()=>()=>p(),[p]),i.useEffect(()=>{if(u&&d){const y=m=>w(m,d),S=m=>w(m,u);return u.addEventListener("pointerleave",y),d.addEventListener("pointerleave",S),()=>{u.removeEventListener("pointerleave",y),d.removeEventListener("pointerleave",S)}}},[u,d,w,p]),i.useEffect(()=>{if(c){const y=S=>{const m=S.target,g={x:S.clientX,y:S.clientY},v=(u==null?void 0:u.contains(m))||(d==null?void 0:d.contains(m)),b=!$i(g,c);v?p():b&&(p(),f())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[u,d,c,f,p]),s.jsx(Xn,{...e,ref:a})}),[Ai,_i]=Je(Ne,{isInside:!1}),Di=oo("TooltipContent"),Xn=i.forwardRef((e,n)=>{const{__scopeTooltip:t,children:r,"aria-label":o,onEscapeKeyDown:a,onPointerDownOutside:c,...l}=e,u=Ze(we,t),f=Qe(t),{onClose:d}=u;return i.useEffect(()=>(document.addEventListener(it,d),()=>document.removeEventListener(it,d)),[d]),i.useEffect(()=>{if(u.trigger){const h=p=>{const w=p.target;w!=null&&w.contains(u.trigger)&&d()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[u.trigger,d]),s.jsx(jn,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:c,onFocusOutside:h=>h.preventDefault(),onDismiss:d,children:s.jsxs(hi,{"data-state":u.stateAttribute,...f,...l,ref:n,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(Di,{children:r}),s.jsx(Ai,{scope:t,isInside:!0,children:s.jsx(Ei,{id:u.contentId,role:"tooltip",children:o||r})})]})})});Vn.displayName=we;var Kn="TooltipArrow",Oi=i.forwardRef((e,n)=>{const{__scopeTooltip:t,...r}=e,o=Qe(t);return _i(Kn,t).isInside?null:s.jsx(pi,{...o,...r,ref:n})});Oi.displayName=Kn;function Ii(e,n){const t=Math.abs(n.top-e.y),r=Math.abs(n.bottom-e.y),o=Math.abs(n.right-e.x),a=Math.abs(n.left-e.x);switch(Math.min(t,r,o,a)){case a:return"left";case o:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Li(e,n,t=5){const r=[];switch(n){case"top":r.push({x:e.x-t,y:e.y+t},{x:e.x+t,y:e.y+t});break;case"bottom":r.push({x:e.x-t,y:e.y-t},{x:e.x+t,y:e.y-t});break;case"left":r.push({x:e.x+t,y:e.y-t},{x:e.x+t,y:e.y+t});break;case"right":r.push({x:e.x-t,y:e.y-t},{x:e.x-t,y:e.y+t});break}return r}function Wi(e){const{top:n,right:t,bottom:r,left:o}=e;return[{x:o,y:n},{x:t,y:n},{x:t,y:r},{x:o,y:r}]}function $i(e,n){const{x:t,y:r}=e;let o=!1;for(let a=0,c=n.length-1;a<n.length;c=a++){const l=n[a],u=n[c],f=l.x,d=l.y,h=u.x,p=u.y;d>r!=p>r&&t<(h-f)*(r-d)/(p-d)+f&&(o=!o)}return o}function Fi(e){const n=e.slice();return n.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),Hi(n)}function Hi(e){if(e.length<=1)return e.slice();const n=[];for(let r=0;r<e.length;r++){const o=e[r];for(;n.length>=2;){const a=n[n.length-1],c=n[n.length-2];if((a.x-c.x)*(o.y-c.y)>=(a.y-c.y)*(o.x-c.x))n.pop();else break}n.push(o)}n.pop();const t=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;t.length>=2;){const a=t[t.length-1],c=t[t.length-2];if((a.x-c.x)*(o.y-c.y)>=(a.y-c.y)*(o.x-c.x))t.pop();else break}t.push(o)}return t.pop(),n.length===1&&t.length===1&&n[0].x===t[0].x&&n[0].y===t[0].y?n:n.concat(t)}var qi=zn,Yi=Bn,Ui=Gn,Jn=Vn;const Qn=qi,zi=Yi,We=Ui,Ee=i.forwardRef(({className:e,sideOffset:n=4,...t},r)=>s.jsx(Jn,{ref:r,sideOffset:n,className:G("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Ee.displayName=Jn.displayName;const nt=({children:e,content:n,position:t="top"})=>{const r=t==="top"?"top":t==="bottom"?"bottom":t==="left"?"left":"right";return s.jsx(Qn,{children:s.jsxs(zi,{children:[s.jsx(We,{asChild:!0,children:s.jsx("span",{className:"cursor-help",children:e})}),s.jsx(Ee,{side:r,children:n})]})})};var lt=["Enter"," "],Bi=["ArrowDown","PageUp","Home"],Zn=["ArrowUp","PageDown","End"],Gi=[...Bi,...Zn],Vi={ltr:[...lt,"ArrowRight"],rtl:[...lt,"ArrowLeft"]},Xi={ltr:["ArrowLeft"],rtl:["ArrowRight"]},_e="Menu",[je,Ki,Ji]=ao(_e),[de,er]=Ae(_e,[Ji,nn,en]),et=nn(),tr=en(),[Qi,fe]=de(_e),[Zi,De]=de(_e),nr=e=>{const{__scopeMenu:n,open:t=!1,children:r,dir:o,onOpenChange:a,modal:c=!0}=e,l=et(n),[u,f]=i.useState(null),d=i.useRef(!1),h=z(a),p=tn(o);return i.useEffect(()=>{const w=()=>{d.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>d.current=!1;return document.addEventListener("keydown",w,{capture:!0}),()=>{document.removeEventListener("keydown",w,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),s.jsx(Wo,{...l,children:s.jsx(Qi,{scope:n,open:t,onOpenChange:h,content:u,onContentChange:f,children:s.jsx(Zi,{scope:n,onClose:i.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:p,modal:c,children:r})})})};nr.displayName=_e;var ec="MenuAnchor",Ct=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e,o=et(t);return s.jsx(Oo,{...o,...r,ref:n})});Ct.displayName=ec;var St="MenuPortal",[tc,rr]=de(St,{forceMount:void 0}),or=e=>{const{__scopeMenu:n,forceMount:t,children:r,container:o}=e,a=fe(St,n);return s.jsx(tc,{scope:n,forceMount:t,children:s.jsx(se,{present:t||a.open,children:s.jsx(mo,{asChild:!0,container:o,children:r})})})};or.displayName=St;var B="MenuContent",[nc,Pt]=de(B),ar=i.forwardRef((e,n)=>{const t=rr(B,e.__scopeMenu),{forceMount:r=t.forceMount,...o}=e,a=fe(B,e.__scopeMenu),c=De(B,e.__scopeMenu);return s.jsx(je.Provider,{scope:e.__scopeMenu,children:s.jsx(se,{present:r||a.open,children:s.jsx(je.Slot,{scope:e.__scopeMenu,children:c.modal?s.jsx(rc,{...o,ref:n}):s.jsx(oc,{...o,ref:n})})})})}),rc=i.forwardRef((e,n)=>{const t=fe(B,e.__scopeMenu),r=i.useRef(null),o=$(n,r);return i.useEffect(()=>{const a=r.current;if(a)return so(a)},[]),s.jsx(Et,{...e,ref:o,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:R(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),oc=i.forwardRef((e,n)=>{const t=fe(B,e.__scopeMenu);return s.jsx(Et,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),ac=Xt("MenuContent.ScrollLock"),Et=i.forwardRef((e,n)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:o,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:l,onEntryFocus:u,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,onDismiss:w,disableOutsideScroll:y,...S}=e,m=fe(B,t),g=De(B,t),v=et(t),b=tr(t),x=Ki(t),[N,E]=i.useState(null),P=i.useRef(null),D=$(n,P,m.onContentChange),j=i.useRef(0),A=i.useRef(""),L=i.useRef(0),ne=i.useRef(null),J=i.useRef("right"),M=i.useRef(0),k=y?uo:i.Fragment,T=y?{as:ac,allowPinchZoom:!0}:void 0,W=C=>{var re,xe;const I=A.current+C,F=x().filter(U=>!U.disabled),Q=document.activeElement,ye=(re=F.find(U=>U.ref.current===Q))==null?void 0:re.textValue,be=F.map(U=>U.textValue),Oe=vc(be,I,ye),ie=(xe=F.find(U=>U.textValue===Oe))==null?void 0:xe.ref.current;(function U(Ce){A.current=Ce,window.clearTimeout(j.current),Ce!==""&&(j.current=window.setTimeout(()=>U(""),1e3))})(I),ie&&setTimeout(()=>ie.focus())};i.useEffect(()=>()=>window.clearTimeout(j.current),[]),io();const O=i.useCallback(C=>{var F,Q;return J.current===((F=ne.current)==null?void 0:F.side)&&yc(C,(Q=ne.current)==null?void 0:Q.area)},[]);return s.jsx(nc,{scope:t,searchRef:A,onItemEnter:i.useCallback(C=>{O(C)&&C.preventDefault()},[O]),onItemLeave:i.useCallback(C=>{var I;O(C)||((I=P.current)==null||I.focus(),E(null))},[O]),onTriggerLeave:i.useCallback(C=>{O(C)&&C.preventDefault()},[O]),pointerGraceTimerRef:L,onPointerGraceIntentChange:i.useCallback(C=>{ne.current=C},[]),children:s.jsx(k,{...T,children:s.jsx(co,{asChild:!0,trapped:o,onMountAutoFocus:R(a,C=>{var I;C.preventDefault(),(I=P.current)==null||I.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:s.jsx(lo,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,onDismiss:w,children:s.jsx(yo,{asChild:!0,...b,dir:g.dir,orientation:"vertical",loop:r,currentTabStopId:N,onCurrentTabStopIdChange:E,onEntryFocus:R(u,C=>{g.isUsingKeyboardRef.current||C.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(Io,{role:"menu","aria-orientation":"vertical","data-state":xr(m.open),"data-radix-menu-content":"",dir:g.dir,...v,...S,ref:D,style:{outline:"none",...S.style},onKeyDown:R(S.onKeyDown,C=>{const F=C.target.closest("[data-radix-menu-content]")===C.currentTarget,Q=C.ctrlKey||C.altKey||C.metaKey,ye=C.key.length===1;F&&(C.key==="Tab"&&C.preventDefault(),!Q&&ye&&W(C.key));const be=P.current;if(C.target!==be||!Gi.includes(C.key))return;C.preventDefault();const ie=x().filter(re=>!re.disabled).map(re=>re.ref.current);Zn.includes(C.key)&&ie.reverse(),pc(ie)}),onBlur:R(e.onBlur,C=>{C.currentTarget.contains(C.target)||(window.clearTimeout(j.current),A.current="")}),onPointerMove:R(e.onPointerMove,Re(C=>{const I=C.target,F=M.current!==C.clientX;if(C.currentTarget.contains(I)&&F){const Q=C.clientX>M.current?"right":"left";J.current=Q,M.current=C.clientX}}))})})})})})})});ar.displayName=B;var sc="MenuGroup",Mt=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return s.jsx(X.div,{role:"group",...r,ref:n})});Mt.displayName=sc;var ic="MenuLabel",sr=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return s.jsx(X.div,{...r,ref:n})});sr.displayName=ic;var ze="MenuItem",Bt="menu.itemSelect",tt=i.forwardRef((e,n)=>{const{disabled:t=!1,onSelect:r,...o}=e,a=i.useRef(null),c=De(ze,e.__scopeMenu),l=Pt(ze,e.__scopeMenu),u=$(n,a),f=i.useRef(!1),d=()=>{const h=a.current;if(!t&&h){const p=new CustomEvent(Bt,{bubbles:!0,cancelable:!0});h.addEventListener(Bt,w=>r==null?void 0:r(w),{once:!0}),fo(h,p),p.defaultPrevented?f.current=!1:c.onClose()}};return s.jsx(ir,{...o,ref:u,disabled:t,onClick:R(e.onClick,d),onPointerDown:h=>{var p;(p=e.onPointerDown)==null||p.call(e,h),f.current=!0},onPointerUp:R(e.onPointerUp,h=>{var p;f.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:R(e.onKeyDown,h=>{const p=l.searchRef.current!=="";t||p&&h.key===" "||lt.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});tt.displayName=ze;var ir=i.forwardRef((e,n)=>{const{__scopeMenu:t,disabled:r=!1,textValue:o,...a}=e,c=Pt(ze,t),l=tr(t),u=i.useRef(null),f=$(n,u),[d,h]=i.useState(!1),[p,w]=i.useState("");return i.useEffect(()=>{const y=u.current;y&&w((y.textContent??"").trim())},[a.children]),s.jsx(je.ItemSlot,{scope:t,disabled:r,textValue:o??p,children:s.jsx(bo,{asChild:!0,...l,focusable:!r,children:s.jsx(X.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...a,ref:f,onPointerMove:R(e.onPointerMove,Re(y=>{r?c.onItemLeave(y):(c.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:R(e.onPointerLeave,Re(y=>c.onItemLeave(y))),onFocus:R(e.onFocus,()=>h(!0)),onBlur:R(e.onBlur,()=>h(!1))})})})}),cc="MenuCheckboxItem",cr=i.forwardRef((e,n)=>{const{checked:t=!1,onCheckedChange:r,...o}=e;return s.jsx(mr,{scope:e.__scopeMenu,checked:t,children:s.jsx(tt,{role:"menuitemcheckbox","aria-checked":Be(t)?"mixed":t,...o,ref:n,"data-state":Nt(t),onSelect:R(o.onSelect,()=>r==null?void 0:r(Be(t)?!0:!t),{checkForDefaultPrevented:!1})})})});cr.displayName=cc;var lr="MenuRadioGroup",[lc,uc]=de(lr,{value:void 0,onValueChange:()=>{}}),ur=i.forwardRef((e,n)=>{const{value:t,onValueChange:r,...o}=e,a=z(r);return s.jsx(lc,{scope:e.__scopeMenu,value:t,onValueChange:a,children:s.jsx(Mt,{...o,ref:n})})});ur.displayName=lr;var dr="MenuRadioItem",fr=i.forwardRef((e,n)=>{const{value:t,...r}=e,o=uc(dr,e.__scopeMenu),a=t===o.value;return s.jsx(mr,{scope:e.__scopeMenu,checked:a,children:s.jsx(tt,{role:"menuitemradio","aria-checked":a,...r,ref:n,"data-state":Nt(a),onSelect:R(r.onSelect,()=>{var c;return(c=o.onValueChange)==null?void 0:c.call(o,t)},{checkForDefaultPrevented:!1})})})});fr.displayName=dr;var Tt="MenuItemIndicator",[mr,dc]=de(Tt,{checked:!1}),hr=i.forwardRef((e,n)=>{const{__scopeMenu:t,forceMount:r,...o}=e,a=dc(Tt,t);return s.jsx(se,{present:r||Be(a.checked)||a.checked===!0,children:s.jsx(X.span,{...o,ref:n,"data-state":Nt(a.checked)})})});hr.displayName=Tt;var fc="MenuSeparator",pr=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e;return s.jsx(X.div,{role:"separator","aria-orientation":"horizontal",...r,ref:n})});pr.displayName=fc;var mc="MenuArrow",gr=i.forwardRef((e,n)=>{const{__scopeMenu:t,...r}=e,o=et(t);return s.jsx(Lo,{...o,...r,ref:n})});gr.displayName=mc;var hc="MenuSub",[Al,vr]=de(hc),Pe="MenuSubTrigger",wr=i.forwardRef((e,n)=>{const t=fe(Pe,e.__scopeMenu),r=De(Pe,e.__scopeMenu),o=vr(Pe,e.__scopeMenu),a=Pt(Pe,e.__scopeMenu),c=i.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:u}=a,f={__scopeMenu:e.__scopeMenu},d=i.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return i.useEffect(()=>d,[d]),i.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),u(null)}},[l,u]),s.jsx(Ct,{asChild:!0,...f,children:s.jsx(ir,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":o.contentId,"data-state":xr(t.open),...e,ref:Kt(n,o.onTriggerChange),onClick:h=>{var p;(p=e.onClick)==null||p.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:R(e.onPointerMove,Re(h=>{a.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!t.open&&!c.current&&(a.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),d()},100))})),onPointerLeave:R(e.onPointerLeave,Re(h=>{var w,y;d();const p=(w=t.content)==null?void 0:w.getBoundingClientRect();if(p){const S=(y=t.content)==null?void 0:y.dataset.side,m=S==="right",g=m?-5:5,v=p[m?"left":"right"],b=p[m?"right":"left"];a.onPointerGraceIntentChange({area:[{x:h.clientX+g,y:h.clientY},{x:v,y:p.top},{x:b,y:p.top},{x:b,y:p.bottom},{x:v,y:p.bottom}],side:S}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(h),h.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:R(e.onKeyDown,h=>{var w;const p=a.searchRef.current!=="";e.disabled||p&&h.key===" "||Vi[r.dir].includes(h.key)&&(t.onOpenChange(!0),(w=t.content)==null||w.focus(),h.preventDefault())})})})});wr.displayName=Pe;var yr="MenuSubContent",br=i.forwardRef((e,n)=>{const t=rr(B,e.__scopeMenu),{forceMount:r=t.forceMount,...o}=e,a=fe(B,e.__scopeMenu),c=De(B,e.__scopeMenu),l=vr(yr,e.__scopeMenu),u=i.useRef(null),f=$(n,u);return s.jsx(je.Provider,{scope:e.__scopeMenu,children:s.jsx(se,{present:r||a.open,children:s.jsx(je.Slot,{scope:e.__scopeMenu,children:s.jsx(Et,{id:l.contentId,"aria-labelledby":l.triggerId,...o,ref:f,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;c.isUsingKeyboardRef.current&&((h=u.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:R(e.onFocusOutside,d=>{d.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:R(e.onEscapeKeyDown,d=>{c.onClose(),d.preventDefault()}),onKeyDown:R(e.onKeyDown,d=>{var w;const h=d.currentTarget.contains(d.target),p=Xi[c.dir].includes(d.key);h&&p&&(a.onOpenChange(!1),(w=l.trigger)==null||w.focus(),d.preventDefault())})})})})})});br.displayName=yr;function xr(e){return e?"open":"closed"}function Be(e){return e==="indeterminate"}function Nt(e){return Be(e)?"indeterminate":e?"checked":"unchecked"}function pc(e){const n=document.activeElement;for(const t of e)if(t===n||(t.focus(),document.activeElement!==n))return}function gc(e,n){return e.map((t,r)=>e[(n+r)%e.length])}function vc(e,n,t){const o=n.length>1&&Array.from(n).every(f=>f===n[0])?n[0]:n,a=t?e.indexOf(t):-1;let c=gc(e,Math.max(a,0));o.length===1&&(c=c.filter(f=>f!==t));const u=c.find(f=>f.toLowerCase().startsWith(o.toLowerCase()));return u!==t?u:void 0}function wc(e,n){const{x:t,y:r}=e;let o=!1;for(let a=0,c=n.length-1;a<n.length;c=a++){const l=n[a].x,u=n[a].y,f=n[c].x,d=n[c].y;u>r!=d>r&&t<(f-l)*(r-u)/(d-u)+l&&(o=!o)}return o}function yc(e,n){if(!n)return!1;const t={x:e.clientX,y:e.clientY};return wc(t,n)}function Re(e){return n=>n.pointerType==="mouse"?e(n):void 0}var bc=nr,xc=Ct,Cc=or,Sc=ar,Pc=Mt,Ec=sr,Mc=tt,Tc=cr,Nc=ur,jc=fr,Rc=hr,kc=pr,Ac=gr,_c=wr,Dc=br,jt="DropdownMenu",[Oc,_l]=Ae(jt,[er]),H=er(),[Ic,Cr]=Oc(jt),Sr=e=>{const{__scopeDropdownMenu:n,children:t,dir:r,open:o,defaultOpen:a,onOpenChange:c,modal:l=!0}=e,u=H(n),f=i.useRef(null),[d=!1,h]=ho({prop:o,defaultProp:a,onChange:c});return s.jsx(Ic,{scope:n,triggerId:ot(),triggerRef:f,contentId:ot(),open:d,onOpenChange:h,onOpenToggle:i.useCallback(()=>h(p=>!p),[h]),modal:l,children:s.jsx(bc,{...u,open:d,onOpenChange:h,dir:r,modal:l,children:t})})};Sr.displayName=jt;var Pr="DropdownMenuTrigger",Er=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...o}=e,a=Cr(Pr,t),c=H(t);return s.jsx(xc,{asChild:!0,...c,children:s.jsx(X.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:Kt(n,a.triggerRef),onPointerDown:R(e.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:R(e.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Er.displayName=Pr;var Lc="DropdownMenuPortal",Mr=e=>{const{__scopeDropdownMenu:n,...t}=e,r=H(n);return s.jsx(Cc,{...r,...t})};Mr.displayName=Lc;var Tr="DropdownMenuContent",Nr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=Cr(Tr,t),a=H(t),c=i.useRef(!1);return s.jsx(Sc,{id:o.contentId,"aria-labelledby":o.triggerId,...a,...r,ref:n,onCloseAutoFocus:R(e.onCloseAutoFocus,l=>{var u;c.current||(u=o.triggerRef.current)==null||u.focus(),c.current=!1,l.preventDefault()}),onInteractOutside:R(e.onInteractOutside,l=>{const u=l.detail.originalEvent,f=u.button===0&&u.ctrlKey===!0,d=u.button===2||f;(!o.modal||d)&&(c.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Nr.displayName=Tr;var Wc="DropdownMenuGroup",jr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Pc,{...o,...r,ref:n})});jr.displayName=Wc;var $c="DropdownMenuLabel",Rr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Ec,{...o,...r,ref:n})});Rr.displayName=$c;var Fc="DropdownMenuItem",kr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Mc,{...o,...r,ref:n})});kr.displayName=Fc;var Hc="DropdownMenuCheckboxItem",Ar=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Tc,{...o,...r,ref:n})});Ar.displayName=Hc;var qc="DropdownMenuRadioGroup",Yc=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Nc,{...o,...r,ref:n})});Yc.displayName=qc;var Uc="DropdownMenuRadioItem",_r=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(jc,{...o,...r,ref:n})});_r.displayName=Uc;var zc="DropdownMenuItemIndicator",Dr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Rc,{...o,...r,ref:n})});Dr.displayName=zc;var Bc="DropdownMenuSeparator",Or=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(kc,{...o,...r,ref:n})});Or.displayName=Bc;var Gc="DropdownMenuArrow",Vc=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Ac,{...o,...r,ref:n})});Vc.displayName=Gc;var Xc="DropdownMenuSubTrigger",Ir=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(_c,{...o,...r,ref:n})});Ir.displayName=Xc;var Kc="DropdownMenuSubContent",Lr=i.forwardRef((e,n)=>{const{__scopeDropdownMenu:t,...r}=e,o=H(t);return s.jsx(Dc,{...o,...r,ref:n,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Lr.displayName=Kc;var Jc=Sr,Qc=Er,Zc=Mr,Wr=Nr,el=jr,$r=Rr,Fr=kr,Hr=Ar,qr=_r,Yr=Dr,Ur=Or,zr=Ir,Br=Lr;const Gr=Jc,Vr=Qc,Xr=el,tl=i.forwardRef(({className:e,inset:n,children:t,...r},o)=>s.jsxs(zr,{ref:o,className:G("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",e),...r,children:[t,s.jsx(po,{className:"ml-auto"})]}));tl.displayName=zr.displayName;const nl=i.forwardRef(({className:e,...n},t)=>s.jsx(Br,{ref:t,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...n}));nl.displayName=Br.displayName;const Rt=i.forwardRef(({className:e,sideOffset:n=4,...t},r)=>s.jsx(Zc,{children:s.jsx(Wr,{ref:r,sideOffset:n,className:G("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...t})}));Rt.displayName=Wr.displayName;const ke=i.forwardRef(({className:e,inset:n,...t},r)=>s.jsx(Fr,{ref:r,className:G("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",e),...t}));ke.displayName=Fr.displayName;const rl=i.forwardRef(({className:e,children:n,checked:t,...r},o)=>s.jsxs(Hr,{ref:o,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Yr,{children:s.jsx(ft,{className:"h-4 w-4"})})}),n]}));rl.displayName=Hr.displayName;const ol=i.forwardRef(({className:e,children:n,...t},r)=>s.jsxs(qr,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Yr,{children:s.jsx(Uo,{className:"h-2 w-2 fill-current"})})}),n]}));ol.displayName=qr.displayName;const kt=i.forwardRef(({className:e,inset:n,...t},r)=>s.jsx($r,{ref:r,className:G("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",e),...t}));kt.displayName=$r.displayName;const At=i.forwardRef(({className:e,...n},t)=>s.jsx(Ur,{ref:t,className:G("-mx-1 my-1 h-px bg-muted",e),...n}));At.displayName=Ur.displayName;const ut="INBOX",Dl="Sent",Ol="Spam",al="Trash";function sl(e){const n=e||1,[t,r]=i.useState(()=>{try{const f=sessionStorage.getItem(`email_unread_${n}`);return f?parseInt(f,10):0}catch{return 0}}),o=i.useCallback(f=>{try{sessionStorage.setItem(`email_unread_${n}`,f.toString()),sessionStorage.setItem(`email_last_check_${n}`,new Date().getTime().toString())}catch{}},[n]),a=i.useCallback(()=>{try{const f=sessionStorage.getItem(`email_last_check_${n}`);if(!f)return!0;const d=new Date().getTime(),h=parseInt(f,10);return d-h>12e4}catch{return!0}},[n]),{data:c,isLoading:l,error:u}=Ge({queryKey:["/api/user-emails",n,ut],queryFn:dt({on401:"returnNull"}),refetchInterval:5*60*1e3,staleTime:3*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,enabled:a()});return i.useEffect(()=>{if(c&&typeof c=="object"&&"emails"in c&&Array.isArray(c.emails)){const f=c.emails.filter(d=>!d.isRead).length;r(f),o(f)}},[c,o]),i.useEffect(()=>{if(!window.__WS_ACTIVE){const d=setInterval(()=>{a()&&document.visibilityState==="visible"&&fetch(`/api/email-unread-count?userId=${n}&_t=${new Date().getTime()}`,{credentials:"include",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Cache-Control":"no-cache"}}).then(h=>h.json()).then(h=>{h&&typeof h.count=="number"&&(r(h.count),o(h.count))}).catch(h=>{console.error("Erreur lors du rafraîchissement du compteur d'emails:",{})})},3e5);return()=>clearInterval(d)}},[n,a,o]),{unreadCount:t,isLoading:l,error:u}}function il(){var ne,J;const e=cn(),{toast:n}=Vt(),t=Gt(),[r,o]=Jt(),a=((ne=e.unreadCounts)==null?void 0:ne.emails)||0,c=((J=e.emails)==null?void 0:J.isConnected)||!1,{unreadCount:l,isLoading:u}=sl(),[f,d]=i.useState(()=>{try{const M=sessionStorage.getItem("email_unread_count");return M?parseInt(M,10):0}catch{return 0}}),[h,p]=i.useState(!1),[w,y]=i.useState(!1),[S,m]=i.useState([]),g=a>0?a:l||f,{data:v,isLoading:b,refetch:x}=Ge({queryKey:["/api/user-emails/recent",1,ut],queryFn:async({queryKey:M})=>{const[k,T,W]=M;try{const O=await fetch(`/api/user-emails/recent?userId=${T}&mailbox=${W}&limit=10`);if(!O.ok){const I=sessionStorage.getItem("recent_emails");return I?JSON.parse(I):{emails:[]}}const C=await O.json();try{if(sessionStorage.setItem("recent_emails",JSON.stringify(C)),C.emails){const I=C.emails.filter(F=>!F.isRead).length;sessionStorage.setItem("email_unread_count",I.toString()),d(I)}}catch{}return C}catch(O){console.error("Erreur lors du chargement des emails récents:",O);const C=sessionStorage.getItem("recent_emails");return C?JSON.parse(C):{emails:[]}}},refetchInterval:0,staleTime:2e4,gcTime:1e3*60*5,refetchOnWindowFocus:!1,enabled:w});i.useEffect(()=>{w&&(p(!0),x().then(()=>{p(!1)}))},[w,x]),i.useEffect(()=>{if(v&&typeof v=="object"&&"emails"in v&&Array.isArray(v.emails)){const M=v.emails.slice(0,10).map(T=>{var O;let W="Expéditeur inconnu";if(typeof T.from=="string")W=T.from;else if((O=T.from)!=null&&O.text)W=T.from.text;else if(Array.isArray(T.from)&&T.from.length>0){const C=T.from[0];C.name&&C.address?W=`${C.name} <${C.address}>`:C.address?W=C.address:C.name&&(W=C.name)}else typeof T.from=="object"&&T.from!==null&&(T.from.name&&T.from.address?W=`${T.from.name} <${T.from.address}>`:T.from.address?W=T.from.address:T.from.name&&(W=T.from.name));return{id:T.id||T.messageId,from:W,subject:T.subject||"Sans objet",preview:T.preview||(typeof T.text=="string"?T.text.substring(0,100):""),receivedAt:T.receivedAt||T.date,isRead:T.isRead||!1,hasAttachments:T.hasAttachments||!1,original:T}});m(M);const k=v.emails.filter(T=>!T.isRead).length;try{sessionStorage.setItem("email_unread_count",k.toString())}catch{}}},[v]);const N=async M=>{try{await fetch(`/api/emails/${M}/mark-read`,{method:"POST"}),m(k=>k.map(T=>T.id===M?{...T,isRead:!0}:T)),x(),t.invalidateQueries({queryKey:["/api/email-unread-count"]})}catch(k){console.error("Erreur lors du marquage de l'email comme lu:",k)}},E=async()=>{try{await fetch("/api/emails/mark-all-read",{method:"POST"}),m(M=>M.map(k=>({...k,isRead:!0}))),x(),t.invalidateQueries({queryKey:["/api/email-unread-count"]})}catch(M){console.error("Erreur lors du marquage des emails comme lus:",M)}},P=async M=>{try{await go("POST",`/api/emails/${M}/move`,{userId:1,messageId:M,destinationMailbox:al,sourceMailbox:ut}),m(k=>k.filter(T=>T.id!==M)),x(),t.invalidateQueries({queryKey:["/api/email-unread-count"]}),n({title:"Email déplacé",description:"L'email a été déplacé vers la corbeille",variant:"default"})}catch(k){console.error("Erreur lors du déplacement de l'email:",k),n({title:"Erreur",description:"Impossible de déplacer l'email vers la corbeille",variant:"destructive"})}},D=M=>{if(!M.original){n({title:"Erreur",description:"Impossible de répondre à cet email, données manquantes",variant:"destructive"});return}try{sessionStorage.setItem("reply_to_email",JSON.stringify(M.original)),y(!1),o("/admin/emails")}catch(k){console.error("Erreur lors de la préparation de la réponse:",k),n({title:"Erreur",description:"Impossible de préparer la réponse à cet email",variant:"destructive"})}},j=M=>{try{const k=new Date(M),T=new Date;return k.getDate()===T.getDate()&&k.getMonth()===T.getMonth()&&k.getFullYear()===T.getFullYear()?He(k,"HH'h'mm",{locale:qe}):He(k,"d MMM, HH'h'mm",{locale:qe})}catch{return M}},A=M=>{try{const k=M.match(/(.*)<(.*)>/);return k&&k[1].trim()?k[1].trim():M}catch{return M}},L=!c&&u&&b;return s.jsxs(Gr,{open:w,onOpenChange:y,children:[s.jsx(Vr,{asChild:!0,children:s.jsxs(Y,{variant:"ghost",size:"icon",className:"relative",onClick:()=>y(!w),children:[s.jsx(rt,{className:`h-5 w-5 ${g>0?"text-green-500 animate-pulse":L?"text-gray-400":""}`}),g>0&&s.jsx(Me,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center",children:g})]})}),s.jsxs(Rt,{className:"w-80",align:"end",children:[s.jsxs(kt,{className:"flex justify-between items-center",children:[s.jsxs("div",{children:["Emails ",g>0&&`(${g})`]}),g>0&&s.jsxs(Y,{variant:"ghost",size:"sm",className:"h-8 text-xs py-1 px-2",onClick:()=>E(),children:[s.jsx(an,{className:"h-3 w-3 mr-1"})," Tout marquer comme lu"]})]}),s.jsx(At,{}),s.jsx(wt,{className:"h-[400px] overflow-auto",children:h?s.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Chargement des emails..."}):S.length===0?s.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Pas d'emails récents"}):s.jsxs(Xr,{children:[S.map(M=>s.jsxs("div",{children:[s.jsxs(ke,{className:`relative flex gap-3 p-3 ${M.isRead?"":"bg-blue-50"}`,children:[s.jsx("div",{className:"bg-blue-100 rounded-full p-2 h-10 w-10 flex items-center justify-center text-xl",children:"📨"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start w-full",children:[s.jsx("div",{className:`text-sm ${M.isRead?"":"font-medium"}`,children:A(M.from)}),s.jsx("div",{className:"text-xs text-muted-foreground",children:j(M.receivedAt)})]}),s.jsx("p",{className:`text-sm ${M.isRead?"":"font-semibold"}`,children:M.subject}),s.jsx("p",{className:"text-xs text-muted-foreground pt-1 line-clamp-2",children:M.preview}),M.hasAttachments&&s.jsxs("div",{className:"mt-1 flex items-center",children:[s.jsx(Bo,{className:"h-3 w-3 text-blue-500 mr-1"}),s.jsx("span",{className:"text-xs text-blue-500",children:"Pièces jointes"})]})]}),s.jsx("div",{className:"absolute right-2 bottom-2 flex items-center space-x-1 opacity-0 group-hover:opacity-100 hover:opacity-100",children:s.jsxs(Qn,{children:[!M.isRead&&s.jsxs(nt,{children:[s.jsx(We,{asChild:!0,children:s.jsx(Y,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:k=>{k.stopPropagation(),N(M.id)},children:s.jsx(ft,{className:"h-3 w-3"})})}),s.jsx(Ee,{side:"bottom",children:s.jsx("p",{children:"Marquer comme lu"})})]}),s.jsxs(nt,{children:[s.jsx(We,{asChild:!0,children:s.jsx(Y,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:k=>{k.stopPropagation(),D(M)},children:s.jsx(Xo,{className:"h-3 w-3"})})}),s.jsx(Ee,{side:"bottom",children:s.jsx("p",{children:"Répondre"})})]}),s.jsxs(nt,{children:[s.jsx(We,{asChild:!0,children:s.jsx(Y,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:k=>{k.stopPropagation(),P(M.id)},children:s.jsx(Jo,{className:"h-3 w-3"})})}),s.jsx(Ee,{side:"bottom",children:s.jsx("p",{children:"Supprimer"})})]})]})}),s.jsx(Y,{variant:"ghost",size:"sm",className:"absolute inset-0 opacity-0 cursor-pointer",onClick:k=>{k.stopPropagation(),o(`/admin/emails?view=${M.id}`),y(!1)},children:s.jsx("span",{className:"sr-only",children:"Ouvrir l'email"})})]}),s.jsx(rn,{})]},M.id)),s.jsx(ke,{asChild:!0,className:"mt-2 text-center py-3 bg-gray-50 hover:bg-gray-100 flex justify-center items-center text-blue-600 gap-1 rounded-md mx-2",onClick:()=>y(!1),children:s.jsxs($e,{to:"/admin/emails",className:"flex items-center gap-1",children:[s.jsx("span",{children:"Voir tous les emails"}),s.jsx(on,{className:"h-3 w-3"})]})})]})})]})]})}function cl(){var S;const e=cn(),t=e.notifications||{},r=t.allNotifications||[],[o,a]=i.useState([]),[c,l]=i.useState(!1);i.useEffect(()=>{l(!0);const m=setTimeout(()=>{l(!1)},3e3);return(r.length>0||t.isConnected===!1)&&(l(!1),clearTimeout(m)),()=>clearTimeout(m)},[r.length,t.isConnected]),i.useEffect(()=>{r.length>0?(a(r),l(!1)):fetch("/api/notifications").then(m=>{if(!m.ok)throw m.status===401?new Error("Utilisateur non authentifié"):new Error(`Erreur HTTP: ${m.status}`);const g=m.headers.get("content-type");if(g&&g.includes("application/json"))return m.json();throw new Error("Réponse non-JSON reçue")}).then(m=>{Array.isArray(m)?a(m):m&&m.success===!1?(console.warn("Erreur API lors du chargement des notifications:",m.message||"Erreur inconnue"),a([])):(console.warn("Format de données incorrect pour les notifications"),a([]))}).catch(m=>{console.warn("Erreur lors du chargement des notifications:",m.message),a([])}).finally(()=>{l(!1)})},[r]);const u=m=>{t.markAsRead&&(t.markAsRead(m),a(g=>g.map(v=>v.id===m?{...v,read:!0}:v)))},f=()=>{console.log("Marquage de toutes les notifications comme lues - début de l'opération"),t.resetNewNotifications?(t.resetNewNotifications(),a(m=>m.map(g=>({...g,read:!0}))),console.log("Envoi de la requête API pour marquer toutes les notifications comme lues"),fetch("/api/notifications/mark-all-read",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin"}).then(m=>{console.log(`Réponse de l'API pour marquer toutes les notifications comme lues: status=${m.status}`),!m.ok&&m.status!==401?console.warn(`Erreur HTTP ${m.status} lors du marquage des notifications comme lues`):m.ok&&console.log("Toutes les notifications marquées comme lues avec succès")}).catch(m=>{console.error("Erreur lors du marquage des notifications:",m.message)})):console.warn("Impossible de marquer toutes les notifications comme lues - resetNewNotifications n'est pas disponible")},d=((S=e.unreadCounts)==null?void 0:S.notifications)||0,[h,p]=i.useState(!1),w=m=>{try{const g=new Date(m),v=new Date;return g.getDate()===v.getDate()&&g.getMonth()===v.getMonth()&&g.getFullYear()===v.getFullYear()?He(g,"HH'h'mm",{locale:qe}):He(g,"d MMM, HH'h'mm",{locale:qe})}catch{return m}},y=m=>{switch(m){case"payment":return{bg:"bg-green-50",icon:"💶"};case"lead":return{bg:"bg-blue-50",icon:"📊"};default:return{bg:"bg-gray-50",icon:"🔔"}}};return s.jsxs(Gr,{open:h,onOpenChange:p,children:[s.jsx(Vr,{asChild:!0,children:s.jsxs(Y,{variant:"ghost",size:"icon",className:"relative",onClick:()=>p(!h),children:[s.jsx(at,{className:`h-5 w-5 ${d>0?"text-blue-500 animate-pulse":""}`}),d>0&&s.jsx(Me,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center",children:d})]})}),s.jsxs(Rt,{className:"w-80",align:"end",children:[s.jsxs(kt,{className:"flex justify-between items-center",children:[s.jsxs("div",{children:["Notifications ",d>0&&`(${d})`]}),d>0&&s.jsxs(Y,{variant:"ghost",size:"sm",className:"h-8 text-xs py-1 px-2",onClick:()=>f(),children:[s.jsx(an,{className:"h-3 w-3 mr-1"})," Tout marquer comme lu"]})]}),s.jsx(At,{}),s.jsx(wt,{className:"h-[400px] overflow-auto",children:c?s.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Chargement des notifications..."}):o.length===0?s.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"Pas de notification pour le moment"}):s.jsxs(Xr,{children:[o.map(m=>{const{bg:g,icon:v}=y(m.type);return s.jsxs("div",{children:[s.jsxs(ke,{className:`flex gap-3 p-3 ${m.read?"":"bg-blue-50"}`,children:[s.jsx("div",{className:`${g} rounded-full p-2 h-10 w-10 flex items-center justify-center text-xl`,children:v}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start w-full",children:[s.jsx("div",{className:"font-medium text-sm",children:m.title}),s.jsx("div",{className:"text-xs text-muted-foreground",children:w(m.time)})]}),s.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:m.message})]}),!m.read&&s.jsx(Y,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-auto flex-shrink-0",onClick:b=>{b.stopPropagation(),u(m.id)},children:s.jsx(ft,{className:"h-3 w-3"})})]}),s.jsx(rn,{})]},m.id)}),s.jsx(ke,{asChild:!0,className:"mt-2 text-center py-3 bg-gray-50 hover:bg-gray-100 flex justify-center items-center text-blue-600 gap-1 rounded-md mx-2",onClick:()=>p(!1),children:s.jsxs($e,{to:"/admin/notifications",className:"flex items-center gap-1",children:[s.jsx("span",{children:"Voir toutes les notifications"}),s.jsx(on,{className:"h-3 w-3"})]})})]})})]})]})}function ll(){const{isConnected:e}=mt();return e?s.jsxs(Me,{variant:"outline",className:"bg-green-50 text-green-700 hover:bg-green-100 border-green-200 gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsx("span",{className:"whitespace-nowrap",children:"Mises à jour en temps réel actives"})]}):s.jsxs(Me,{variant:"outline",className:"bg-amber-50 text-amber-700 hover:bg-amber-100 border-amber-200 gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 animate-pulse"}),s.jsx("span",{className:"whitespace-nowrap",children:"Connexion en cours..."})]})}function ul(){const{user:e}=Qt(),[n,t]=i.useState(null);i.useEffect(()=>{const o=localStorage.getItem("adminUser");if(o)try{const c=JSON.parse(o);if(c&&(c.fullName||c.username)){const l=c.fullName||c.username||c.email||"Utilisateur";t(l)}}catch(c){console.error("Erreur lors de la lecture des données utilisateur du cache:",c)}async function a(){try{const c=localStorage.getItem("adminToken");if(!c)return;const l=await fetch("/api/user",{method:"GET",headers:{Authorization:`Bearer ${c}`},credentials:"include"});if(!l.ok)return;const u=await l.json();if(!u||!u.id)return;const f=u.fullName||u.username||u.email||"Utilisateur";t(f),localStorage.setItem("adminUser",JSON.stringify(u)),localStorage.setItem("lastUserCheck",new Date().getTime().toString())}catch(c){console.error("Erreur lors de la récupération de l'utilisateur:",c)}}a()},[]);const r=n||e&&(e.fullName||e.username||e.email)||"Utilisateur";return s.jsxs("span",{className:"text-sm text-gray-600 font-normal ml-2",children:["Bonjour ",s.jsx("span",{className:"text-blue-600 font-medium",children:r})]})}function Il({children:e,title:n="Tableau de bord",description:t}){const[r]=Jt(),o=Zt(),[a,c]=i.useState(!o);return i.useEffect(()=>{c(!o)},[o]),i.useEffect(()=>{function l(){window.innerWidth<768?c(!1):c(!0)}return window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}},[]),s.jsx(na,{children:s.jsxs("div",{className:"flex h-screen bg-gray-50",children:[s.jsxs("div",{className:`fixed inset-y-0 z-50 flex w-72 flex-col bg-white transition-transform duration-300 ease-in-out md:relative md:translate-x-0 ${a?"translate-x-0":"-translate-x-full"}`,style:{height:"100vh"},children:[s.jsx(ta,{activePath:r}),o&&s.jsx(Y,{variant:"ghost",size:"icon",className:"absolute right-2 top-2 h-8 w-8 rounded-full",onClick:()=>c(!1),children:s.jsx($o,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[s.jsxs("header",{className:"sticky top-0 z-10 flex h-16 items-center gap-2 md:gap-4 border-b bg-white px-3 md:px-6",children:[s.jsxs(Y,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>c(!0),children:[s.jsx(vo,{className:"h-6 w-6"}),s.jsx("span",{className:"sr-only",children:"Toggle Menu"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[" ",s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"text-lg font-semibold truncate",children:n}),s.jsx(ul,{}),s.jsx("div",{className:"ml-2",children:s.jsx(ll,{})})]}),t&&s.jsx("p",{className:"text-sm text-gray-500 truncate hidden sm:block",children:t})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(cl,{}),s.jsx(il,{})]})]}),s.jsx("main",{className:"flex-1 overflow-y-auto px-3 py-4 md:px-6 md:py-6",children:e})]}),a&&o&&s.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:()=>c(!1)})]})})}export{Il as A,qe as B,Uo as C,Gr as D,Qn as E,We as F,Ee as G,Nl as H,ut as I,Tl as J,qo as K,Ml as L,Vo as M,El as N,mt as O,Yo as P,zo as Q,Xo as R,Dl as S,al as T,Qo as U,Te as a,Ve as b,le as c,aa as d,Ha as e,la as f,Wt as g,Fe as h,Ya as i,za as j,He as k,ia as l,ln as m,Ol as n,Jo as o,Vr as p,Rt as q,ke as r,Lt as s,K as t,sl as u,At as v,wt as w,kt as x,Xr as y,nt as z};
