import{b as f,j as e,L as j,H as u,o as p,U as y,M as g,P as b,w as N}from"./index-CuwRrq_3.js";import{u as w}from"./useQuery-C0R__yAc.js";import{F as c}from"./file-text-CPn689bc.js";import{M as v}from"./map-pin-Dr6RwnNq.js";function P(){const[,a]=f("/recu/:reference"),r=(a==null?void 0:a.reference)||"",{data:n,isLoading:l,error:d}=w({queryKey:["/api/service-requests",r],queryFn:async()=>{const t=await fetch(`/api/service-requests/${r}`);if(!t.ok)throw new Error("Demande non trouvée");return t.json()},enabled:!!r}),s=(n==null?void 0:n.serviceRequest)||null,m=t=>t?new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(t):"—",x=t=>t?new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(t)):"—",o=()=>s!=null&&s.prenom&&(s!=null&&s.nom)?`${s.prenom} ${s.nom}`:(s==null?void 0:s.name)||"—",i=()=>{const t=[s==null?void 0:s.address,s==null?void 0:s.postalCode,s==null?void 0:s.city].filter(Boolean);return t.length>0?t.join(", "):null},h=t=>t?{neuf:"Raccordement Maison Neuve",definitif:"Raccordement Définitif",provisoire:"Raccordement Provisoire",modification:"Modification de Branchement",collectif:"Raccordement Collectif",viabilisation:"Viabilisation de Terrain"}[t]||t:"Raccordement Électrique";return l?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(j,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Chargement du reçu..."})]})}):d||!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(c,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Reçu introuvable"}),e.jsxs("p",{className:"text-gray-600",children:["La référence ",e.jsx("span",{className:"font-mono font-medium",children:r})," n'a pas été trouvée."]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsxs("title",{children:["Reçu de paiement - ",r]}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4","data-testid":"recu-page",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-green-500 px-6 py-8 text-white text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(p,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold mb-1","data-testid":"recu-title",children:"Paiement confirmé"}),e.jsx("p",{className:"text-green-100 text-sm",children:"Votre transaction a été effectuée avec succès"})]}),e.jsxs("div",{className:"px-6 py-6 border-b border-gray-100 text-center bg-gray-50",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Montant payé"}),e.jsx("p",{className:"text-4xl font-bold text-gray-900","data-testid":"recu-amount",children:m(s.paymentAmount)})]}),e.jsxs("div",{className:"px-6 py-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(c,{className:"w-5 h-5"}),e.jsx("span",{children:"Référence"})]}),e.jsx("span",{className:"font-mono font-semibold text-gray-900","data-testid":"recu-reference",children:s.referenceNumber})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{children:"Client"})]}),e.jsx("span",{className:"font-medium text-gray-900","data-testid":"recu-client-name",children:o()})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(g,{className:"w-5 h-5"}),e.jsx("span",{children:"Email"})]}),e.jsx("span",{className:"text-gray-900","data-testid":"recu-email",children:s.email})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{children:"Téléphone"})]}),e.jsx("span",{className:"text-gray-900","data-testid":"recu-phone",children:s.phone})]}),i()&&e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(v,{className:"w-5 h-5"}),e.jsx("span",{children:"Adresse"})]}),e.jsx("span",{className:"text-gray-900 text-right text-sm max-w-[200px]","data-testid":"recu-address",children:i()})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(N,{className:"w-5 h-5"}),e.jsx("span",{children:"Date"})]}),e.jsx("span",{className:"text-gray-900","data-testid":"recu-date",children:x(s.paymentDate||s.createdAt)})]})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Service"}),e.jsx("span",{className:"font-medium text-gray-900","data-testid":"recu-service-type",children:h(s.serviceType)})]})}),e.jsx("div",{className:"px-6 py-4 bg-blue-50 border-t border-blue-100 text-center",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["Un email de confirmation a été envoyé à ",e.jsx("strong",{children:s.email})]})})]}),e.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Service de raccordement électrique Enedis"})]})})]})}export{P as default};
